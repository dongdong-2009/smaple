<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=gb2312'>
<meta name='generator' content='oblog 2.52 with www.oioj.net'>
<meta name='keywords' content='书籍,下载,MP3,book,博客,免费博客申请,部落,blog'>
<link rel='alternate' href='rss2.asp?name=晴天' type='application/rss+xml' title='RSS' >
<script language=javascript>
	function CheckForm()
	{
		if(document.UserLogin.UserName.value=="")
		{
			alert("请输入用户名！");
			document.UserLogin.UserName.focus();
			return false;
		}
		if(document.UserLogin.Password.value == "")
		{
			alert("请输入密码！");
			document.UserLogin.Password.focus();
			return false;
		}
	}
	
</script>
<script language="javascript">quote='<div style=\'margin:5px 20px;border:1px solid #CCCCCC;padding:5px; background:#F3F3F3\'><strong>以下引用晴天在2004-10-26 11:19:00的评论:</strong><br><br>SQL语法参考手册 <BR>2001年3月22日 <BR>DB2 提供了关连式资料库的查询语言 ＳＱＬ (Structured Query Language)，是一种非常口语化、既易学又易懂的语法。此一语言几乎是每个资料库系统都必须提供的，用以表示关连式的操作，包含了资料的定义（ＤＤＬ）以及资料的处理（ＤＭＬ）。SQL原来拼成SEQUEL，这语言的原型以"系统 R"的名字在 IBM 圣荷西实验室完成，经过IBM内部及其他的许多使用性及效率测试，其结果相当令人满意，并决定在系统R 的技术基础发展出来 IBM 的产品。而且美国国家标准学会（ANSI）及国际标准化组织（ISO）在1987遵循一个几乎是以 IBM SQL 为基础的标准关连式资料语言定义。<BR>一、资料定义 ＤＤＬ（Data Definition Language) <BR>资料定语言是指对资料的格式和形态下定义的语言，他是每个资料库要建立时候时首先要面对的，举凡资料分哪些表格关系、表格内的有什麽栏位主键、表格和表格之间互相参考的关系等等，都是在开始的时候所必须规划好的。<BR>１、建表格：<BR>CREATE TABLE table_name( <BR>column1 DATATYPE [NOT NULL] [NOT NULL PRIMARY KEY], <BR>column2 DATATYPE [NOT NULL],<BR>...）<BR>说明：　<BR>DATATYPE --是资料的格式，详见表。<BR>NUT NULL --可不可以允许资料有空的（尚未有资料填入）。<BR>PRIMARY KEY --是本表的主键。<BR>２、更改表格　<BR>ALTER TABLE table_name <BR>ADD COLUMN column_name DATATYPE <BR>说明：增加一个栏位（没有删除某个栏位的语法。<BR>ALTER TABLE table_name<BR>ADD PRIMARY KEY (column_name)<BR>说明：更改表得的定义把某个栏位设为主键。<BR>ALTER TABLE table_name<BR>DROP PRIMARY KEY (column_name)<BR>说明：把主键的定义删除。<BR>３、建立索引　<BR>CREATE INDEX index_name ON table_name (column_name)<BR>说明：对某个表格的栏位建立索引以增加查询时的速度。<BR>４、删除　<BR>DROP table_name<BR>DROP index_name<BR>二、的资料形态 DATATYPEs<BR>smallint<BR>16 位元的整数。<BR>interger<BR>32 位元的整数。<BR>decimal(p,s)<BR>p 精确值和 s 大小的十进位整数，精确值p是指全部有几个数(digits)大小值，s是指小数<BR>点後有几位数。如果没有特别指定，则系统会设为 p=5; s=0 。 <BR>float<BR>32位元的实数。<BR>double<BR>64位元的实数。<BR>char(n)<BR>n 长度的字串，n不能超过 254。<BR>varchar(n)<BR>长度不固定且其最大长度为 n 的字串，n不能超过 4000。<BR>graphic(n)<BR>和 char(n) 一样，不过其单位是两个字元 double-bytes， n不能超过127。这个形态是为<BR>了支援两个字元长度的字体，例如中文字。<BR>vargraphic(n)<BR>可变长度且其最大长度为 n 的双字元字串，n不能超过 2000。<BR>date<BR>包含了 年份、月份、日期。<BR>time<BR>包含了 小时、分钟、秒。<BR>timestamp<BR>包含了 年、月、日、时、分、秒、千分之一秒。<BR>三、资料操作 ＤＭＬ （Data Manipulation Language)<BR>资料定义好之後接下来的就是资料的操作。资料的操作不外乎增加资料（insert)、查询资料（query）、更改资料（update) 、删除资料（delete）四种模式，以下分 别介绍他们的语法：<BR>１、增加资料：<BR>INSERT INTO table_name (column1,column2,...)<BR>VALUES ( value1,value2, ...)<BR>说明：<BR>1.若没有指定column 系统则会按表格内的栏位顺序填入资料。<BR>2.栏位的资料形态和所填入的资料必须吻合。<BR>3.table_name 也可以是景观 view_name。<BR>INSERT INTO table_name (column1,column2,...)<BR>SELECT columnx,columny,... FROM another_table<BR>说明：也可以经过一个子查询（subquery）把别的表格的资料填入。<BR>２、查询资料：<BR>基本查询<BR>SELECT column1,columns2,...<BR>FROM table_name<BR>说明：把table_name 的特定栏位资料全部列出来<BR>SELECT *<BR>FROM table_name<BR>WHERE column1 = xxx <BR>[AND column2 &gt; yyy] [OR column3 &lt;&gt; zzz]<BR>说明：<BR>1.\'*\'表示全部的栏位都列出来。<BR>2.WHERE 之後是接条件式，把符合条件的资料列出来。<BR>SELECT column1,column2<BR>FROM table_name<BR>ORDER BY column2 [DESC]<BR>说明：ORDER BY 是指定以某个栏位做排序，[DESC]是指从大到小排列，若没有指明，则是从小到大<BR>排列<BR>组合查询<BR>组合查询是指所查询得资料来源并不只有单一的表格，而是联合一个以上的<BR>表格才能够得到结果的。<BR>SELECT *<BR>FROM table1,table2<BR>WHERE table1.colum1=table2.column1<BR>说明：<BR>1.查询两个表格中其中 column1 值相同的资料。<BR>2.当然两个表格相互比较的栏位，其资料形态必须相同。<BR>3.一个复杂的查询其动用到的表格可能会很多个。<BR>整合性的查询：<BR>SELECT COUNT (*) <BR>FROM table_name<BR>WHERE column_name = xxx<BR>说明：<BR>查询符合条件的资料共有几笔。<BR>SELECT SUM(column1)<BR>FROM table_name<BR>说明：<BR>1.计算出总和，所选的栏位必须是可数的数字形态。<BR>2.除此以外还有 AVG() 是计算平均、MAX()、MIN()计算最大最小值的整合性查询。<BR>SELECT column1,AVG(column2)<BR>FROM table_name<BR>GROUP BY column1<BR>HAVING AVG(column2) &gt; xxx<BR>说明：<BR>1.GROUP BY: 以column1 为一组计算 column2 的平均值必须和 AVG、SUM等整合性查询的关键字<BR>一起使用。 <BR>2.HAVING : 必须和 GROUP BY 一起使用作为整合性的限制。<BR>复合性的查询<BR>SELECT *<BR>FROM table_name1<BR>WHERE EXISTS (<BR>SELECT *<BR>FROM table_name2<BR>WHERE conditions )<BR>说明：<BR>1.WHERE 的 conditions 可以是另外一个的 query。<BR>2.EXISTS 在此是指存在与否。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 IN (<BR>SELECT column1 <BR>FROM table_name2<BR>WHERE conditions )<BR>说明：　<BR>1. IN 後面接的是一个集合，表示column1 存在集合里面。<BR>2. SELECT 出来的资料形态必须符合 column1。 <BR>其他查询<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 LIKE \'x%\' <BR>说明：LIKE 必须和後面的\'x%\' 相呼应表示以 x为开头的字串。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 IN (\'xxx\',\'yyy\',..)<BR>说明：IN 後面接的是一个集合，表示column1 存在集合里面。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 BETWEEN xx AND yy<BR>说明：BETWEEN 表示 column1 的值介於 xx 和 yy 之间。 <BR>３、更改资料：<BR>UPDATE table_name<BR>SET column1=\'xxx\'<BR>WHERE conditoins<BR>说明：<BR>1.更改某个栏位设定其值为\'xxx\'。<BR>2.conditions 是所要符合的条件、若没有 WHERE 则整个 table 的那个栏位都会全部被更改。<BR>４、删除资料：<BR>DELETE FROM table_name<BR>WHERE conditions<BR>说明：删除符合条件的资料。<BR>说明：关于WHERE条件后面如果包含有日期的比较，不同数据库有不同的表达式。具体如下：<BR>(1)如果是ACCESS数据库，则为：WHERE mydate&gt;#2000-01-01# <BR>(2)如果是ORACLE数据库，则为：WHERE mydate&gt;cast(\'2000-01-01\' as date)<BR>或：WHERE mydate&gt;to_date(\'2000-01-01\',\'yyyy-mm-dd\')<BR>在Delphi中写成：<BR>thedate=\'2000-01-01\';<BR>query1.SQL.add(\'select * from abc where mydate&gt;cast(\'+\'\'\'\'+thedate+\'\'\'\'+\' as date)\'); <BR>如果比较日期时间型，则为：<BR>WHERE mydatetime&gt;to_date(\'2000-01-01 10:00:01\',\'yyyy-mm-dd hh24:mi:ss\')<BR><BR>Top<BR>回复人： qxm(qxm) ( ) 信誉：100 2003-4-15 15:09:04 得分:0<BR><BR>不错<BR><BR>Top<BR>回复人： dj0430() ( ) 信誉：100 2003-4-15 15:22:27 得分:0<BR><BR>表达式求值:<BR>&nbsp;&nbsp; 直接发送 Select（1+2)*3 <BR>&nbsp;&nbsp; 或者&nbsp;&nbsp;&nbsp;&nbsp; Select top 1 (1+2)*3 from TableName<BR>欢迎前去讨论“各种语言的表达式求值问题”<BR>http://expert.csdn.net/Expert/topic/1661/1661139.xml?temp=.6748773<BR><BR>Top<BR>回复人： sanzfm(珊珊来迟) ( ) 信誉：100 2003-4-15 15:28:52 得分:0<BR><BR>收藏收藏<BR><BR>Top<BR>回复人： baiyunfei(埋头苦学) ( ) 信誉：97 2003-4-15 17:03:36 得分:0<BR><BR>恩，埋头学习中！<BR><BR>Top<BR>回复人： weijiajia11() ( ) 信誉：97 2003-4-15 17:11:17 得分:0<BR><BR>太多了<BR><BR>Top<BR>回复人： imports(小鸡快跑!Q_Q) ( ) 信誉：99 2003-4-15 17:20:34 得分:0<BR><BR>不懂! <BR>Mark!<BR><BR>Top<BR>回复人： xboy(一剑如故) ( ) 信誉：100 2003-4-15 18:57:09 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： wlhtake(正在调试) ( ) 信誉：99 2003-4-15 21:40:19 得分:0<BR><BR>我考~！ 这些人贴sql又不说明适用数据库，容易搞晕的哈<BR>再说了，这些sql太常用了，何来精妙之言？<BR>最精妙的语句莫过于 SELECT * FROM&nbsp;&nbsp;<BR><BR>Top<BR>回复人： reddg(reddg) ( ) 信誉：100 2003-4-15 23:21:48 得分:0<BR><BR>浪费时间<BR><BR>Top<BR>回复人： Tomcat4(Tom) ( ) 信誉：105 2003-4-16 9:47:15 得分:0<BR><BR>up!<BR><BR>Top<BR>回复人： junyh(阿俊) ( ) 信誉：100 2003-4-16 10:03:03 得分:0<BR><BR>学习先<BR><BR>Top<BR>回复人： lizongqi(英雄啊) ( ) 信誉：100 2003-4-16 10:36:57 得分:0<BR><BR>收<BR><BR>Top<BR>回复人： Swanzy(志远) ( ) 信誉：100 2003-4-16 13:19:58 得分:0<BR><BR>常用的就不贴了吧？<BR>我绝对支持&nbsp;&nbsp;wlhtake(正在调试) ！<BR>“最精妙的语句莫过于 SELECT * FROM&nbsp;&nbsp;”！！！！<BR><BR>Top<BR>回复人： chenquan(嘉威王子) ( ) 信誉：100 2003-4-16 13:25:20 得分:5<BR><BR>我也来，以前给一个网友的贴<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt <BR>group by a,b,c) --c小计<BR>union<BR>(select a,\'小计\' b,\'\' c,sum(Mavg) Mavg,sum(Mcount) Mcount from<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt group by a,b,c) <BR>as chen<BR>group by a) --A小计<BR>union<BR>(select a,b,\'小计\' c,sum(Mavg) Mavg,sum(Mcount) Mcount from<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt group by a,b,c) <BR>as chen<BR>group by a,b) --B小计<BR><BR>Top<BR>回复人： kjijian(!魔法师) ( ) 信誉：100 2003-4-16 15:18:51 得分:0<BR><BR>mark.<BR><BR>Top<BR>回复人： tangyong_delphi() ( ) 信誉：99 2003-4-16 21:42:34 得分:0<BR><BR>经典收藏。<BR><BR>Top<BR>回复人： donglw(天行) ( ) 信誉：100 2003-4-17 1:28:45 得分:0<BR><BR>值得收藏!<BR><BR>Top<BR>回复人： williy(肩扛干粮找组织) ( ) 信誉：100 2003-4-17 9:07:31 得分:0<BR><BR>嗯！好！！！<BR><BR>Top<BR>回复人： brat365(我就是五亿探长--雷洛) ( ) 信誉：97 2003-4-17 10:21:09 得分:0<BR><BR>学习了不少，感谢大家做出的贡献<BR><BR>Top<BR>回复人： lilyfirstone(永恒......) ( ) 信誉：100 2003-4-17 10:45:29 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： pengdali(大力 V2.0) ( ) 信誉：100 2003-4-17 12:06:07 得分:0<BR><BR>哈哈。。太简单了！哈哈。。<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-4-17 12:34:25 得分:0<BR><BR>to&nbsp;&nbsp;pengdali(大力) <BR>怎么有空到这儿瞧..<BR>WEB这东东可是没什么好玩的耶.偶都要改行了<BR><BR>Top<BR>回复人： rena0504(丽娜) ( ) 信誉：100 2003-4-17 12:48:34 得分:0<BR><BR>select a,b,c <BR>from a <BR>where a IN <BR>&nbsp;&nbsp;&nbsp;&nbsp; (select d from b )<BR><BR>Top<BR>回复人： readersm68(地主) ( ) 信誉：100 2003-4-17 15:31:09 得分:0<BR><BR>结束。<BR><BR>Top<BR>回复人： hcgui(浪子) ( ) 信誉：100 2003-4-17 16:15:19 得分:0<BR><BR>good<BR><BR>Top<BR>回复人： javafish(小鱼儿) ( ) 信誉：101 2003-4-18 11:46:50 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： rengs(冷雨) ( ) 信誉：100 2003-4-18 13:58:18 得分:0<BR><BR>oracle:<BR>select \'sql的精妙不在于写的简短，而在于能使得查询效率提高\' from dual<BR><BR>Top<BR>回复人： rengs(冷雨) ( ) 信誉：100 2003-4-18 14:27:44 得分:5<BR></div><br>';</script><meta name='DEscriptions' contect='晴天--[分享]SQl语句学习专题'>
<title>晴天--[分享]SQl语句学习专题</title>
</head>
<body>
<a name='top'></a><script language='JavaScript' type='text/javascript'>
<!-- Hide
function killErrors() {
return true;}
window.onerror = killErrors;
// --></script>
<script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script><script src="inc/main.js" type="text/javascript"></script>
<STYLE>   
a {    
 color: #003366;    
 text-decoration: none;   
}   
a:visited {    
 color: #003366;   
}   
a:hover {    
 color: #CC0000;   
 text-decoration: underline;   
}   
Div,P,body,td{FONT-SIZE: 11px; font-family: Verdana,tahoma, Arial, Helvetica, sans-serif; color:#000000}   

SELECT    {BACKGROUND-COLOR: f3f3f3; height: 20px; COLOR: #000000; FONT-FAMILY: Verdana,Tahoma, sans-serif; FONT-SIZE: 11px ; border: 0px #CCCCCC double}   
INPUT     {color: #333333; height: 21px; FONT-FAMILY: Verdana,MS Shell Dlg,Tahoma, sans-serif; FONT-SIZE: 11px}   
FONT.code{FONT-FAMILY: Monaco, Courier, Courier New;}   

code {font-family: "Courier" ; font-size: 11px}   
textarea {font:12px,Courier New;border: 1px double #999999;background:#FFFFFF}   

body, textarea {   
  FONT-FAMILY: Verdana,Tahoma;margin:0px   
}   
.arrow { font-family:webdings}   
</STYLE>

<TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#003399 border=0>
<TBODY>
<TR>
<TD bgColor=#b86c59 height=50><FONT color=#ffffff><STRONG>&nbsp;</STRONG><FONT size=6>&nbsp;&nbsp;&nbsp;<FONT color=#eeeeee>&nbsp;欢迎光临</FONT></FONT></FONT><FONT color=#eeeeee size=7>晴天<FONT size=6>的</FONT></FONT><FONT color=#ffffff size=6>blog</FONT></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=1 cellPadding=4 width="100%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#ffffff>
<TD vAlign=top align=middle width=200>
<TABLE borderColor=#ece4df cellSpacing=2 cellPadding=3 width="100%" bgColor=#ece4df border=0 heihgt="">
<TBODY>
<TR>
<TD><STRONG><U>公告</U></STRONG></TD></TR>
<TR>
<TD>&nbsp;暂无公告...</TD></TR>
<TR>
<TD>&nbsp; 
<TABLE style="BORDER-RIGHT: #cccccc 1px dotted; TABLE-LAYOUT: fixed; BORDER-TOP: #cccccc 1px dotted; BORDER-LEFT: #cccccc 1px dotted; WIDTH: 186px; BORDER-BOTTOM: #cccccc 1px dotted; HEIGHT: 40px" cellSpacing=0 cellPadding=6 width=186 align=center border=0>
<TBODY>
<TR>
<TD style="WORD-WRAP: break-word" bgColor=#cfc1b8><STRONG><FONT style="BACKGROUND-COLOR: #ffffff" color=#990000></FONT></STRONG>
<P align=center><FONT color=#c4573c><STRONG><table border='0' width='100%' align='center' cellspacing='1' cellpadding='1' bgcolor=''><tr><td colspan='1'  bgcolor='' style='font-size:16px; font-family:;text-align :right'><a href='blog.asp?name=晴天&month=2005-9'>&laquo;</a></td><td colspan='5' style='color:;font-size:14px;font-family:;text-align :center'><b>October 2005</b></td><td colspan='1' bgcolor='' style='font-size:16px; font-family:;text-align :left';><a href='blog.asp?name=晴天&month=2005-11'>&raquo;</a></td></tr><tr><td align='center' bgcolor=''>日</td><td align='center' bgcolor=''>一</td><td align='center' bgcolor=''>二</td><td align='center' bgcolor=''>三</td><td align='center' bgcolor=''>四</td><td align='center' bgcolor=''>五</td><td align='center' bgcolor=''>六</td></tr><tr><td bgcolor=''></td><td bgcolor=''></td><td bgcolor=''></td><td bgcolor=''></td><td bgcolor=''></td><td bgcolor=''></td><td align='center' bgcolor='' style='font-size:10px;font-family:'>1</td></tr><td align='center' bgcolor='' style='font-size:10px;font-family:'>2</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>3</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>4</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>5</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>6</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>7</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>8</td></tr><td align='center' bgcolor='' style='font-size:10px;font-family:'>9</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>10</td><td align='center' bgcolor='' style='font-size:10px;font-family:'><a href='blog.asp?name=晴天&date=2005-10-11'>11</a></td><td align='center' bgcolor='' style='font-size:10px;font-family:'>12</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>13</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>14</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>15</td></tr><td align='center' bgcolor='' style='font-size:10px;font-family:'>16</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>17</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>18</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>19</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>20</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>21</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>22</td></tr><td align='center' bgcolor='' style='font-size:10px;font-family:'>23</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>24</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>25</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>26</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>27</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>28</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>29</td></tr><td align='center' bgcolor='' style='font-size:10px;font-family:'>30</td><td align='center' bgcolor='' style='font-size:10px;font-family:'>31</td><td align='center' bgcolor='' style='font-size:10px;font-family:'></td><td align='center' bgcolor='' style='font-size:10px;font-family:'></td><td align='center' bgcolor='' style='font-size:10px;font-family:'></td><td align='center' bgcolor='' style='font-size:10px;font-family:'></td><td align='center' bgcolor='' style='font-size:10px;font-family:'></td></tr><tr><td colspan='7' bgcolor='' align='center'></tr></table></STRONG></FONT></P></TD></TR></TBODY></TABLE></TD></TR>
<TR>
<TD>&nbsp;&gt;&gt;&gt;<STRONG><U>我的分类</U></STRONG></TD></TR>
<TR>
<TD>
<UL>
<LI>&nbsp;<a href='blog.asp?name=晴天'>首页(235)</a><br><a href=blog.asp?subjectid=531&name=晴天>无名历程(6)</a><br><a href=blog.asp?subjectid=540&name=晴天>SP行业(17)</a><br><a href=blog.asp?subjectid=535&name=晴天>遗忘的日子(1)</a><br><a href=blog.asp?subjectid=534&name=晴天>随笔(8)</a><br><a href=blog.asp?subjectid=582&name=晴天>网络与安全(30)</a><br><a href=blog.asp?subjectid=564&name=晴天>搜索与博客(15)</a><br><a href=blog.asp?subjectid=546&name=晴天>转贴文摘(134)</a><br><a href=blog.asp?subjectid=536&name=晴天>代码人生(25)</a><br></LI></UL></TD></TR>
<TR>
<TD>&nbsp;&gt;&gt;&gt;<U><STRONG>日志更新</STRONG></U></TD></TR>
<TR>
<TD>
<DIV align=left><a href=more.asp?name=晴天&id=3892 title=晴天发表于2005-10-11 13:42:00>[设计开发]一个美国老工程师的心理话</a><br><a href=more.asp?name=晴天&id=3890 title=晴天发表于2005-10-11 13:40:00>中国为何拒绝重复使用课本？</a><br><a href=more.asp?name=晴天&id=3891 title=晴天发表于2005-10-11 13:40:00>朝鲜历史（朝鲜人写的）</a><br><a href=more.asp?name=晴天&id=3889 title=晴天发表于2005-10-11 13:39:00>Linux之父15年回首：为何企鹅会</a><br><a href=more.asp?name=晴天&id=3888 title=晴天发表于2005-10-11 13:38:00>微软遭遇中年危机：看盖茨如何教会大象</a><br><a href=more.asp?name=晴天&id=3741 title=晴天发表于2005-9-21 11:37:00>安全经过广州火车站&nbsp;攻略(去广州的必</a><br><a href=more.asp?name=晴天&id=3532 title=晴天发表于2005-8-31 17:49:00>世界上第一张照片</a><br><a href=more.asp?name=晴天&id=3531 title=晴天发表于2005-8-31 16:47:00>BillGates独具特征的领导艺术</a><br><a href=more.asp?name=晴天&id=3528 title=晴天发表于2005-8-31 12:29:00>利用www.google.com入侵</a><br><a href=more.asp?name=晴天&id=3527 title=晴天发表于2005-8-31 12:18:00>(ZT)谁在控制我们的浏览器？</a><br></DIV></TD></TR>
<TR>
<TD>&nbsp;&gt;&gt;&gt;<STRONG><U>最新评论</U></STRONG></TD></TR>
<TR>
<TD>
<DIV align=left><a href=more.asp?name=晴天&id=1175#11720 title=草本知秋(游客)发表评论于2005-10-18 11:56:00>回复:方舟子再批“珍奥核酸”</a><br><a href=more.asp?name=晴天&id=109#11688 title=`121`(游客)发表评论于2005-10-17 13:19:00>回复:[分享]SQl语句学习专题</a><br><a href=more.asp?name=晴天&id=1175#11641 title=dodo(游客)发表评论于2005-10-16 15:38:00>回复:方舟子再批“珍奥核酸”</a><br><a href=more.asp?name=晴天&id=3892#11640 title=ciniao发表评论于2005-10-16 15:01:00>回复:[设计开发]一个美国老工程师的心理</a><br><a href=more.asp?name=晴天&id=3531#11588 title=阿莲(游客)发表评论于2005-10-15 21:03:00>回复:BillGates独具特征的领导艺</a><br><a href=more.asp?name=晴天&id=3351#11585 title=阿莲(游客)发表评论于2005-10-15 20:55:00>回复:当代女大学生语录：漂亮的女生你们消</a><br><a href=more.asp?name=晴天&id=1416#11583 title=阿莲(游客)发表评论于2005-10-15 20:35:00>回复:精彩阅读：一个学生家长的教育手记</a><br><a href=more.asp?name=晴天&id=95#11133 title=seer(游客)发表评论于2005-10-7 20:27:00>回复:华南理工大学收发室长期将师生信件卖</a><br><a href=more.asp?name=晴天&id=1175#10637 title=平(游客)发表评论于2005-9-28 19:53:00>回复:方舟子再批“珍奥核酸”</a><br><a href=more.asp?name=晴天&id=3741#10270 title=晴天发表评论于2005-9-21 21:58:00>回复:安全经过广州火车站&nbsp;攻略</a><br> </DIV></TD></TR>
<TR>
<TD>&nbsp;<form name='search' method='post' action='blog.asp?name=晴天'><select name='selecttype' id='selecttype'><option value='topic' selected>日志标题</option><option value='logtext'>日志内容</option></select><br><input name='keyword' type='text' id='keyword' size='16' maxlength='40'> <input type='submit' name='Submit' value='搜索'></form><BR><STRONG>&gt;&gt;&gt;<U>留言板</U></STRONG></TD></TR>
<TR>
<TD>
<DIV align=left><a href='message.asp?name=晴天#message'>签写新留言</a><br><br><a href=message.asp?name=晴天#633 title=盛网互联(游客)发表于2005-9-21 10:01:00>盛网互联</a><br><a href=message.asp?name=晴天#583 title=李长春(游客)发表于2005-7-31 7:52:00>李长春信函</a><br><a href=message.asp?name=晴天#564 title=(游客)发表于2005-7-7 23:04:00></a><br><a href=message.asp?name=晴天#531 title=世界博客精选(游客)发表于2005-5-19 9:53:00>您的博客文章已被“世界博客精选”收录</a><br><a href=message.asp?name=晴天#510 title=(游客)发表于2005-5-6 19:33:00></a><br><a href=message.asp?name=晴天#497 title=晴天发表于2005-4-11 16:00:00>现在没有合适的地方</a><br><a href=message.asp?name=晴天#473 title=dangdang(游客)发表于2004-11-8 2:28:00>请问</a><br></DIV></TD></TR>
<TR>
<TD><STRONG>&gt;&gt;&gt;<U>链接</U></STRONG></TD></TR>
<TR>
<TD>&nbsp;<br> </TD></TR>
<TR>
<TD><STRONG>&gt;&gt;&gt;<U>Blog信息</U></STRONG></TD></TR>
<TR>
<TD>&nbsp;blog名称:晴天<br>日志总数:235<br>评论数量:222<br>留言数量:7<br>访问次数:53868<br>建立时间:2004年9月29日</TD></TR>
<TR>
<TD>&nbsp; 
<HR>

<P align=center><BR><a href='rss2.asp?name=晴天' target='_blank'><img src='Images/xml.gif' width='36' height='14' border='0'></a></P></TD></TR></TBODY></TABLE></TD>
<TD vAlign=top align=middle><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG><img src=images/face/1.gif ><a href=blog.asp?name=晴天&subjectid=536>[代码人生]<a href=more.asp?name=晴天&id=109>[分享]SQl语句学习专题</a></STRONG></FONT><BR>晴天 发表于 2004-10-26 11:16:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD><P>SQL语句集锦<BR></P>
<P>--语 句&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;功 能<BR>--数据操作<BR>SELECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--从数据库表中检索数据行和列<BR>INSERT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--向数据库表添加新数据行<BR>DELETE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--从数据库表中删除数据行<BR>UPDATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--更新数据库表中的数据<BR>--数据定义<BR>CREATE TABLE&nbsp;&nbsp;&nbsp;&nbsp;--创建一个数据库表<BR>DROP TABLE&nbsp;&nbsp;&nbsp;&nbsp; --从数据库中删除表<BR>ALTER TABLE&nbsp;&nbsp;&nbsp;&nbsp; --修改数据库表结构<BR>CREATE VIEW&nbsp;&nbsp;&nbsp;&nbsp; --创建一个视图<BR>DROP VIEW&nbsp;&nbsp;&nbsp;&nbsp; --从数据库中删除视图<BR>CREATE INDEX&nbsp;&nbsp;&nbsp;&nbsp;--为数据库表创建一个索引<BR>DROP INDEX&nbsp;&nbsp;&nbsp;&nbsp; --从数据库中删除索引<BR>CREATE PROCEDURE&nbsp;&nbsp; --创建一个存储过程<BR>DROP PROCEDURE&nbsp;&nbsp;&nbsp;&nbsp;--从数据库中删除存储过程<BR>CREATE TRIGGER&nbsp;&nbsp;&nbsp;&nbsp;--创建一个触发器<BR>DROP TRIGGER&nbsp;&nbsp;&nbsp;&nbsp;--从数据库中删除触发器<BR>CREATE SCHEMA&nbsp;&nbsp;&nbsp;&nbsp;--向数据库添加一个新模式<BR>DROP SCHEMA&nbsp;&nbsp;&nbsp;&nbsp; --从数据库中删除一个模式<BR>CREATE DOMAIN&nbsp;&nbsp;&nbsp;&nbsp;--创建一个数据值域<BR>ALTER DOMAIN&nbsp;&nbsp;&nbsp;&nbsp;--改变域定义<BR>DROP DOMAIN&nbsp;&nbsp;&nbsp;&nbsp; --从数据库中删除一个域<BR>--数据控制<BR>GRANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--授予用户访问权限<BR>DENY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--拒绝用户访问<BR>REVOKE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--解除用户访问权限<BR>--事务控制<BR>COMMIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--结束当前事务<BR>ROLLBACK&nbsp;&nbsp;&nbsp;&nbsp; --中止当前事务<BR>SET TRANSACTION&nbsp;&nbsp;&nbsp;&nbsp;--定义当前事务数据访问特征<BR>--程序化SQL<BR>DECLARE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--为查询设定游标<BR>EXPLAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--为查询描述数据访问计划<BR>OPEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--检索查询结果打开一个游标<BR>FETCH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--检索一行查询结果<BR>CLOSE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--关闭游标<BR>PREPARE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--为动态执行准备SQL 语句<BR>EXECUTE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--动态地执行SQL 语句<BR>DESCRIBE&nbsp;&nbsp;&nbsp;&nbsp; --描述准备好的查询</P>
<P><BR>&nbsp;</P>
<P>---局部变量<BR>declare @id char(10)<BR>--set @id = '10010001'<BR>select @id = '10010001'</P>
<P><BR>&nbsp;</P>
<P>---全局变量<BR>---必须以@@开头</P>
<P><BR>&nbsp;</P>
<P>--IF ELSE<BR>declare @x int @y int @z int<BR>select @x = 1 @y = 2 @z=3<BR>if @x &gt; @y<BR>print 'x &gt; y' --打印字符串'x &gt; y'<BR>else if @y &gt; @z<BR>print 'y &gt; z'<BR>else print 'z &gt; y'</P>
<P><BR>&nbsp;</P>
<P>--CASE<BR>use pangu<BR>update employee<BR>set e_wage =<BR>case<BR>&nbsp;&nbsp;when job_level = ’1’ then e_wage*1.08<BR>&nbsp;&nbsp;when job_level = ’2’ then e_wage*1.07<BR>&nbsp;&nbsp;when job_level = ’3’ then e_wage*1.06<BR>&nbsp;&nbsp;else e_wage*1.05<BR>end</P>
<P><BR>&nbsp;</P>
<P>--WHILE CONTINUE BREAK<BR>declare @x int @y int @c int<BR>select @x = 1 @y=1<BR>while @x &lt; 3<BR>begin<BR>&nbsp;&nbsp;print @x --打印变量x 的值<BR>&nbsp;&nbsp;while @y &lt; 3<BR>&nbsp;&nbsp; begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;select @c = 100*@x + @y<BR>&nbsp;&nbsp;&nbsp;&nbsp;print @c --打印变量c 的值<BR>&nbsp;&nbsp;&nbsp;&nbsp;select @y = @y + 1<BR>&nbsp;&nbsp; end<BR>&nbsp;&nbsp;select @x = @x + 1<BR>&nbsp;&nbsp;select @y = 1<BR>end</P>
<P><BR>&nbsp;</P>
<P>--WAITFOR<BR>--例 等待1 小时2 分零3 秒后才执行SELECT 语句<BR>waitfor delay ’01:02:03’<BR>select * from employee<BR>--例 等到晚上11 点零8 分后才执行SELECT 语句<BR>waitfor time ’23:08:00’<BR>select * from employee</P>
<P><BR><BR>&nbsp;</P>
<P>***SELECT***</P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp; select *(列名) from table_name(表名) where column_name operator value<BR>&nbsp;&nbsp; ex:(宿主)<BR>&nbsp;&nbsp;select * from stock_information where stockid&nbsp;&nbsp; = str(nid)<BR>&nbsp;&nbsp;&nbsp;&nbsp; stockname = 'str_name' <BR>&nbsp;&nbsp;&nbsp;&nbsp; stockname like '% find this %' <BR>&nbsp;&nbsp;&nbsp;&nbsp; stockname like '[a-zA-Z]%' --------- ([]指定值的范围)<BR>&nbsp;&nbsp;&nbsp;&nbsp; stockname like '[^F-M]%'&nbsp;&nbsp; --------- (^排除指定范围)<BR>&nbsp;&nbsp;&nbsp;&nbsp; --------- 只能在使用like关键字的where子句中使用通配符)<BR>&nbsp;&nbsp;&nbsp;&nbsp; or stockpath = 'stock_path'<BR>&nbsp;&nbsp;&nbsp;&nbsp; or stocknumber &lt; 1000<BR>&nbsp;&nbsp;&nbsp;&nbsp; and stockindex = 24<BR>&nbsp;&nbsp;&nbsp;&nbsp; not stock*** = 'man'<BR>&nbsp;&nbsp;&nbsp;&nbsp; stocknumber between 20 and 100<BR>&nbsp;&nbsp;&nbsp;&nbsp; stocknumber in(10,20,30)<BR>&nbsp;&nbsp;&nbsp;&nbsp; order by stockid desc(asc) --------- 排序，desc-降序，asc-升序<BR>&nbsp;&nbsp;&nbsp;&nbsp; order by 1,2 --------- by列号<BR>&nbsp;&nbsp;&nbsp;&nbsp; stockname = (select stockname from stock_information&nbsp;&nbsp;where stockid&nbsp;&nbsp;= 4)<BR>&nbsp;&nbsp;&nbsp;&nbsp; --------- 子查询<BR>&nbsp;&nbsp;&nbsp;&nbsp; --------- 除非能确保内层select只返回一个行的值，<BR>&nbsp;&nbsp;&nbsp;&nbsp; --------- 否则应在外层where子句中用一个in限定符<BR>&nbsp;&nbsp;select distinct column_name form table_name --------- distinct指定检索独有的列值，不重复<BR>&nbsp;&nbsp;select stocknumber ,"stocknumber + 10" = stocknumber + 10 from table_name<BR>&nbsp;&nbsp;select stockname , "stocknumber" = count(*) from table_name group by stockname<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--------- group by 将表按行分组,指定列中有相同的值<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;having count(*) = 2&nbsp;&nbsp;---------&nbsp;&nbsp;having选定指定的组<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;select * <BR>&nbsp;&nbsp;from table1, table2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;where table1.id *= table2.id -------- 左外部连接，table1中有的而table2中没有得以null表示<BR>&nbsp;&nbsp;&nbsp;&nbsp; table1.id =* table2.id -------- 右外部连接 </P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp;select stockname from table1<BR>&nbsp;&nbsp;union [all]&nbsp;&nbsp;-----&nbsp;&nbsp;union合并查询结果集，all-保留重复行<BR>&nbsp;&nbsp;select stockname from table2</P>
<P><BR>&nbsp;</P>
<P>***insert***</P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp;insert into table_name (Stock_name,Stock_number) value ("xxx","xxxx")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value (select Stockname , Stocknumber from Stock_table2)---value为select语句</P>
<P><BR>&nbsp;</P>
<P>***update***</P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp;update table_name set Stockname = "xxx" [where Stockid = 3]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stockname = default<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stockname = null<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Stocknumber = Stockname + 4</P>
<P><BR>&nbsp;</P>
<P>***delete***</P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp;delete from table_name where Stockid = 3<BR>&nbsp;&nbsp;truncate table_name ----------- 删除表中所有行，仍保持表的完整性<BR>&nbsp;&nbsp;drop table table_name --------------- 完全删除表</P>
<P><BR>&nbsp;</P>
<P>***alter table*** --- 修改数据库表结构</P>
<P><BR>&nbsp;</P>
<P>&nbsp;&nbsp;alter table database.owner.table_name add column_name char(2) null .....<BR>&nbsp;&nbsp;sp_help table_name ---- 显示表已有特征<BR>&nbsp;&nbsp;create table table_name (name char(20), age smallint, lname varchar(30))<BR>&nbsp;&nbsp;insert into table_name select ......... ----- 实现删除列的方法（创建新表）<BR>&nbsp;&nbsp;alter table table_name drop constraint Stockname_default ---- 删除Stockname的default约束<BR>&nbsp;&nbsp;&nbsp;&nbsp;<BR>***function(/*常用函数*/)***</P>
<P><BR>&nbsp;</P>
<P>----统计函数----<BR>AVG&nbsp;&nbsp;&nbsp;&nbsp;--求平均值<BR>COUNT&nbsp;&nbsp; --统计数目<BR>MAX&nbsp;&nbsp;&nbsp;&nbsp;--求最大值<BR>MIN&nbsp;&nbsp;&nbsp;&nbsp;--求最小值<BR>SUM&nbsp;&nbsp;&nbsp;&nbsp;--求和</P>
<P><BR>&nbsp;</P>
<P>--AVG<BR>use pangu<BR>select avg(e_wage) as dept_avgWage<BR>from employee<BR>group by dept_id</P>
<P><BR>&nbsp;</P>
<P>--MAX<BR>--求工资最高的员工姓名<BR>use pangu<BR>select e_name<BR>from employee<BR>where e_wage =<BR>(select max(e_wage)<BR>&nbsp;&nbsp;from employee)</P>
<P><BR>&nbsp;</P>
<P>--STDEV()<BR>--STDEV()函数返回表达式中所有数据的标准差</P>
<P><BR>&nbsp;</P>
<P>--STDEVP()<BR>--STDEVP()函数返回总体标准差</P>
<P><BR>&nbsp;</P>
<P>--VAR()<BR>--VAR()函数返回表达式中所有值的统计变异数</P>
<P><BR>&nbsp;</P>
<P>--VARP()<BR>--VARP()函数返回总体变异数</P>
<P><BR>&nbsp;</P>
<P>----算术函数----</P>
<P><BR>&nbsp;</P>
<P>/***三角函数***/<BR>SIN(float_expression) --返回以弧度表示的角的正弦<BR>COS(float_expression) --返回以弧度表示的角的余弦<BR>TAN(float_expression) --返回以弧度表示的角的正切<BR>COT(float_expression) --返回以弧度表示的角的余切<BR>/***反三角函数***/<BR>ASIN(float_expression) --返回正弦是FLOAT 值的以弧度表示的角<BR>ACOS(float_expression) --返回余弦是FLOAT 值的以弧度表示的角<BR>ATAN(float_expression) --返回正切是FLOAT 值的以弧度表示的角<BR>ATAN2(float_expression1,float_expression2) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--返回正切是float_expression1 /float_expres-sion2的以弧度表示的角<BR>DEGREES(numeric_expression)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --把弧度转换为角度返回与表达式相同的数据类型可为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--INTEGER/MONEY/REAL/FLOAT 类型<BR>RADIANS(numeric_expression) --把角度转换为弧度返回与表达式相同的数据类型可为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--INTEGER/MONEY/REAL/FLOAT 类型<BR>EXP(float_expression)&nbsp;&nbsp;--返回表达式的指数值<BR>LOG(float_expression)&nbsp;&nbsp;--返回表达式的自然对数值<BR>LOG10(float_expression)--返回表达式的以10 为底的对数值<BR>SQRT(float_expression) --返回表达式的平方根<BR>/***取近似值函数***/<BR>CEILING(numeric_expression)&nbsp;&nbsp;--返回&gt;=表达式的最小整数返回的数据类型与表达式相同可为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--INTEGER/MONEY/REAL/FLOAT 类型<BR>FLOOR(numeric_expression)&nbsp;&nbsp;&nbsp;&nbsp;--返回&lt;=表达式的最小整数返回的数据类型与表达式相同可为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--INTEGER/MONEY/REAL/FLOAT 类型<BR>ROUND(numeric_expression)&nbsp;&nbsp;&nbsp;&nbsp;--返回以integer_expression 为精度的四舍五入值返回的数据<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--类型与表达式相同可为INTEGER/MONEY/REAL/FLOAT 类型<BR>ABS(numeric_expression)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--返回表达式的绝对值返回的数据类型与表达式相同可为<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--INTEGER/MONEY/REAL/FLOAT 类型<BR>SIGN(numeric_expression)&nbsp;&nbsp;&nbsp;&nbsp; --测试参数的正负号返回0 零值1 正数或-1 负数返回的数据类型<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--与表达式相同可为INTEGER/MONEY/REAL/FLOAT 类型<BR>PI()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --返回值为π 即3.1415926535897936<BR>RAND([integer_expression])&nbsp;&nbsp; --用任选的[integer_expression]做种子值得出0-1 间的随机浮点数</P>
<P><BR>&nbsp;</P>
<P><BR>----字符串函数----<BR>ASCII()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --函数返回字符表达式最左端字符的ASCII 码值<BR>CHAR()&nbsp;&nbsp; --函数用于将ASCII 码转换为字符<BR>&nbsp;&nbsp;&nbsp;&nbsp;--如果没有输入0 ~ 255 之间的ASCII 码值CHAR 函数会返回一个NULL 值<BR>LOWER()&nbsp;&nbsp; --函数把字符串全部转换为小写<BR>UPPER()&nbsp;&nbsp; --函数把字符串全部转换为大写<BR>STR()&nbsp;&nbsp; --函数把数值型数据转换为字符型数据<BR>LTRIM()&nbsp;&nbsp; --函数把字符串头部的空格去掉<BR>RTRIM()&nbsp;&nbsp; --函数把字符串尾部的空格去掉<BR>LEFT(),RIGHT(),SUBSTRING()&nbsp;&nbsp;--函数返回部分字符串<BR>CHARINDEX(),PATINDEX()&nbsp;&nbsp;--函数返回字符串中某个指定的子串出现的开始位置<BR>SOUNDEX()&nbsp;&nbsp;--函数返回一个四位字符码 <BR>&nbsp;&nbsp;&nbsp;&nbsp;--SOUNDEX函数可用来查找声音相似的字符串但SOUNDEX函数对数字和汉字均只返回0 值&nbsp;&nbsp;&nbsp;&nbsp; <BR>DIFFERENCE()&nbsp;&nbsp;&nbsp;&nbsp;--函数返回由SOUNDEX 函数返回的两个字符表达式的值的差异<BR>&nbsp;&nbsp;&nbsp;&nbsp;--0 两个SOUNDEX 函数返回值的第一个字符不同<BR>&nbsp;&nbsp;&nbsp;&nbsp;--1 两个SOUNDEX 函数返回值的第一个字符相同<BR>&nbsp;&nbsp;&nbsp;&nbsp;--2 两个SOUNDEX 函数返回值的第一二个字符相同<BR>&nbsp;&nbsp;&nbsp;&nbsp;--3 两个SOUNDEX 函数返回值的第一二三个字符相同<BR>&nbsp;&nbsp;&nbsp;&nbsp;--4 两个SOUNDEX 函数返回值完全相同<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </P>
<P><BR>&nbsp;</P>
<P>QUOTENAME()&nbsp;&nbsp;--函数返回被特定字符括起来的字符串<BR>/*select quotename('abc', '{') quotename('abc')<BR>运行结果如下<BR>----------------------------------{<BR>{abc} [abc]*/</P>
<P><BR>&nbsp;</P>
<P>REPLICATE()&nbsp;&nbsp;&nbsp;&nbsp; --函数返回一个重复character_expression 指定次数的字符串<BR>/*select replicate('abc', 3) replicate( 'abc', -2)<BR>运行结果如下<BR>----------- -----------<BR>abcabcabc NULL*/</P>
<P><BR>&nbsp;</P>
<P>REVERSE()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --函数将指定的字符串的字符排列顺序颠倒<BR>REPLACE()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --函数返回被替换了指定子串的字符串<BR>/*select replace('abc123g', '123', 'def')<BR>运行结果如下<BR>----------- -----------<BR>abcdefg*/</P>
<P><BR>&nbsp;</P>
<P>SPACE()&nbsp;&nbsp; --函数返回一个有指定长度的空白字符串<BR>STUFF()&nbsp;&nbsp; --函数用另一子串替换字符串指定位置长度的子串</P>
<P><BR>&nbsp;</P>
<P><BR>----数据类型转换函数----<BR>CAST() 函数语法如下<BR>CAST() (&lt;expression&gt; AS &lt;data_ type&gt;[ length ])<BR>CONVERT() 函数语法如下<BR>CONVERT() (&lt;data_ type&gt;[ length ], &lt;expression&gt; [, style])</P>
<P><BR>&nbsp;</P>
<P>select cast(100+99 as char) convert(varchar(12), getdate())<BR>运行结果如下<BR>------------------------------ ------------<BR>199&nbsp;&nbsp; Jan 15 2000</P>
<P><BR>&nbsp;</P>
<P>----日期函数----<BR>DAY()&nbsp;&nbsp; --函数返回date_expression 中的日期值<BR>MONTH()&nbsp;&nbsp; --函数返回date_expression 中的月份值<BR>YEAR()&nbsp;&nbsp; --函数返回date_expression 中的年份值<BR>DATEADD(&lt;datepart&gt; ,&lt;number&gt; ,&lt;date&gt;) <BR>&nbsp;&nbsp;&nbsp;&nbsp;--函数返回指定日期date 加上指定的额外日期间隔number 产生的新日期<BR>DATEDIFF(&lt;datepart&gt; ,&lt;number&gt; ,&lt;date&gt;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;--函数返回两个指定日期在datepart 方面的不同之处<BR>DATENAME(&lt;datepart&gt; , &lt;date&gt;)&nbsp;&nbsp;--函数以字符串的形式返回日期的指定部分<BR>DATEPART(&lt;datepart&gt; , &lt;date&gt;)&nbsp;&nbsp;--函数以整数值的形式返回日期的指定部分<BR>GETDATE()&nbsp;&nbsp;--函数以DATETIME 的缺省格式返回系统当前的日期和时间</P>
<P><BR>&nbsp;</P>
<P>----系统函数----<BR>APP_NAME()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--函数返回当前执行的应用程序的名称<BR>COALESCE()&nbsp;&nbsp;--函数返回众多表达式中第一个非NULL 表达式的值<BR>COL_LENGTH(&lt;'table_name'&gt;, &lt;'column_name'&gt;) --函数返回表中指定字段的长度值<BR>COL_NAME(&lt;table_id&gt;, &lt;column_id&gt;)&nbsp;&nbsp; --函数返回表中指定字段的名称即列名<BR>DATALENGTH() --函数返回数据表达式的数据的实际长度<BR>DB_ID(['database_name']) --函数返回数据库的编号<BR>DB_NAME(database_id)&nbsp;&nbsp;--函数返回数据库的名称<BR>HOST_ID()&nbsp;&nbsp;&nbsp;&nbsp; --函数返回服务器端计算机的名称<BR>HOST_NAME()&nbsp;&nbsp;&nbsp;&nbsp; --函数返回服务器端计算机的名称<BR>IDENTITY(&lt;data_type&gt;[, seed increment]) [AS column_name])<BR>--IDENTITY() 函数只在SELECT INTO 语句中使用用于插入一个identity column列到新表中<BR>/*select identity(int, 1, 1) as column_name<BR>into newtable<BR>from oldtable*/<BR>ISDATE()&nbsp;&nbsp;--函数判断所给定的表达式是否为合理日期<BR>ISNULL(&lt;check_expression&gt;, &lt;replacement_value&gt;) --函数将表达式中的NULL 值用指定值替换<BR>ISNUMERIC()&nbsp;&nbsp;--函数判断所给定的表达式是否为合理的数值<BR>NEWID()&nbsp;&nbsp; --函数返回一个UNIQUEIDENTIFIER 类型的数值<BR>NULLIF(&lt;expression1&gt;, &lt;expression2&gt;)<BR>--NULLIF 函数在expression1 与expression2 相等时返回NULL 值若不相等时则返回expression1 的值</P></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%"><a href=more.asp?name=晴天&id=109>阅读全文(10730)</a> | <a href=more.asp?name=晴天&id=109#comment>回复(20)</a> | <a href=showtb.asp?id=109 target=_blank>引用(0)</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>精妙SQL语句<a name='3739'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:16:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD><P>精妙SQL语句<BR>说明：复制表(只复制结构,源表名：a 新表名：b)<BR>SQL: select * into b from a where 1&lt;&gt;1<BR>说明：拷贝表(拷贝数据,源表名：a 目标表名：b)<BR>SQL: insert into b(a, b, c) select d,e,f from b;<BR>说明：显示文章、提交人和最后回复时间<BR>SQL: select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b<BR>说明：外连接查询(表名1：a 表名2：b)<BR>SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c<BR>说明：日程安排提前五分钟提醒<BR>SQL: select * from 日程安排 where datediff('minute',f开始时间,getdate())&gt;5</P>
<P>说明：两张关联表，删除主表中已经在副表中没有的信息<BR>SQL: <BR>delete from info where not exists ( select * from infobz where info.infid=infobz.infid ) <BR>说明：--<BR>SQL: <BR>SELECT A.NUM, A.NAME, B.UPD_DATE, B.PREV_UPD_DATE<BR>FROM TABLE1, <BR>(SELECT X.NUM, X.UPD_DATE, Y.UPD_DATE PREV_UPD_DATE<BR>FROM (SELECT NUM, UPD_DATE, INBOUND_QTY, STOCK_ONHAND<BR>FROM TABLE2<BR>WHERE TO_CHAR(UPD_DATE,'YYYY/MM') = TO_CHAR(SYSDATE, 'YYYY/MM')) X, <BR>(SELECT NUM, UPD_DATE, STOCK_ONHAND<BR>FROM TABLE2<BR>WHERE TO_CHAR(UPD_DATE,'YYYY/MM') = <BR>TO_CHAR(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM') || '/01','YYYY/MM/DD') - 1, 'YYYY/MM') ) Y, <BR>WHERE X.NUM = Y.NUM （+）<BR>AND X.INBOUND_QTY + NVL(Y.STOCK_ONHAND,0) &lt;&gt; X.STOCK_ONHAND ) B<BR>WHERE A.NUM = B.NUM<BR>说明：--<BR>SQL: <BR>select * from studentinfo where not exists(select * from student where studentinfo.id=student.id) and 系名称='"&amp;strdepartmentname&amp;"' and 专业名称='"&amp;strprofessionname&amp;"' order by 性别,生源地,高考总成绩<BR>说明：<BR>从数据库中去一年的各单位电话费统计(电话费定额贺电化肥清单两个表来源）<BR>SQL: <BR>SELECT a.userper, a.tel, a.standfee, TO_CHAR(a.telfeedate, 'yyyy') AS telyear,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '01', a.factration)) AS JAN,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '02', a.factration)) AS FRI,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '03', a.factration)) AS MAR,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '04', a.factration)) AS APR,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '05', a.factration)) AS MAY,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '06', a.factration)) AS JUE,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '07', a.factration)) AS JUL,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '08', a.factration)) AS AGU,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '09', a.factration)) AS SEP,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '10', a.factration)) AS OCT,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '11', a.factration)) AS NOV,<BR>SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '12', a.factration)) AS DEC<BR>FROM (SELECT a.userper, a.tel, a.standfee, b.telfeedate, b.factration<BR>FROM TELFEESTAND a, TELFEE b<BR>WHERE a.tel = b.telfax) a<BR>GROUP BY a.userper, a.tel, a.standfee, TO_CHAR(a.telfeedate, 'yyyy')<BR>说明：四表联查问题：<BR>SQL: select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where .....<BR>说明：得到表中最小的未使用的ID号<BR>SQL:<BR>SELECT (CASE WHEN EXISTS(SELECT * FROM Handle b WHERE b.HandleID = 1) THEN MIN(HandleID) + 1 ELSE 1 END) as HandleID<BR>FROM Handle<BR>WHERE NOT HandleID IN (SELECT a.HandleID - 1 FROM Handle a)<BR>详细的请见原贴：http://expert.csdn.net/Expert/topic/1546/1546652.xml?temp=.3089716</P></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3739#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3740'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:16:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>: 我在ms sql中建了一个表,可由于种种原因有些记录重复了<BR>: 记录完全的一模一样。<BR>: 现在我想把重复的都删掉,只保留重复记录中的第一条。<BR>: 我在database好象看到有介绍oracle的，<BR><BR><BR>select distinct * into #table_name from table_name<BR>delete from table_name<BR>select * into table_name from #table_name<BR>drop table #table_name<BR><BR>与此相关的是“select into”选项，可以在数据库属性<BR>对话框中，勾起来此项，或者在Query Analyzer中执行<BR>execute sp_dboption 'db_name','select into','true'<BR>开启。默认值是关闭的。<BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3740#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>专贴揭示SQL语句,贴出你的精妙SQL<a name='3741'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:17:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>主　　题：专贴揭示SQL语句,贴出你的精妙SQL,欢迎来抢分!<BR>作　　者：csdntoll (低调惯了) <BR>等　　级： <BR>信 誉 值：147<BR>所属论坛：Web 开发 ASP<BR>问题点数：200<BR>回复次数：260<BR>发表时间：2003-3-18 18:02:24<BR>格式<BR>说明：复制表(只复制结构,源表名：a 新表名：b)<BR>SQL: select * into b from a where 1&lt;&gt;1<BR><BR>回复人： LuoGD(沃适) ( ) 信誉：100 2003-3-18 18:07:37 得分:5<BR><BR>说明：拷贝表(拷贝数据,源表名：a 目标表名：b)<BR>insert into b(a, b, c) select d,e,f from b;<BR><BR>Top<BR>回复人： LuoGD(沃适) ( ) 信誉：100 2003-3-18 18:09:37 得分:5<BR><BR>说明：合并数据(表名1：a 表名2：b)<BR>select a,b,c from a union select d,e,f from b;<BR><BR>Top<BR>回复人： LuoGD(沃适) ( ) 信誉：100 2003-3-18 18:11:36 得分:5<BR><BR>说明：子查询(表名1：a 表名2：b)<BR>select a,b,c from a where a IN (select d from b )<BR>或者:<BR>select a,b,c from a where a IN (1,2,3)<BR><BR>Top<BR>回复人： _TMG_(Alan) ( ) 信誉：120 2003-3-18 18:11:55 得分:0<BR><BR>这都是精妙？<BR><BR>Top<BR>回复人： junsisi(君三思) ( ) 信誉：100 2003-3-18 18:12:36 得分:5<BR><BR>俺来贴个让俺对sql茅塞顿开的例子<BR>说明：显示文章、提交人和最后回复时间<BR>sql:select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b<BR><BR>Top<BR>回复人： LuoGD(沃适) ( ) 信誉：100 2003-3-18 18:13:48 得分:0<BR><BR>说明：外连接查询(表名1：a 表名2：b)<BR>select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c<BR><BR>Top<BR>回复人： LuoGD(沃适) ( ) 信誉：100 2003-3-18 18:15:56 得分:0<BR><BR>说明：在线视图查询(表名1：a )<BR>select * from (SELECT a,b,c FROM a) T where t.a &gt; 1;<BR><BR>Top<BR>回复人： gcs925(Study Java&amp;Jsp ing) ( ) 信誉：105 2003-3-18 18:16:00 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： net_lover(孟子E章) ( ) 信誉：727 2003-3-18 18:16:14 得分:0<BR><BR>SQL:SELECT NEWID()<BR><BR>Top<BR>回复人： snakegod(蛇姬) ( ) 信誉：100 2003-3-18 21:49:41 得分:0<BR><BR>????<BR>没有深度 没兴趣<BR><BR>Top<BR>回复人： _TMG_(Alan) ( ) 信誉：120 2003-3-18 21:54:21 得分:0<BR><BR>我宁愿用数据库冗余也不会使用子查询,除非万不得已<BR><BR>Top<BR>回复人： nittystone(没有想法) ( ) 信誉：115 2003-3-18 22:20:49 得分:5<BR><BR>自连接取出荣于数据<BR>把所有姓名相同的只取出一个<BR>select a.name from table_name a where a.id in <BR>(select b.id from table_name b where a.id&lt;&gt;b.id)<BR>同理删除荣誉数据<BR>delete from table_name&nbsp;&nbsp;where table_name.id in <BR>(select b.id from table_name b where table_name.id&lt;&gt;b.id)<BR><BR>Top<BR>回复人： allforly(白衣胜血) ( ) 信誉：126 2003-3-19 1:18:29 得分:0<BR><BR>今天开眼界了啊，我就会select * from ** where **=**这一句<BR><BR>Top<BR>回复人： gddd(gddd) ( ) 信誉：100 2003-3-19 2:07:30 得分:0<BR><BR>利害...我会多一句<BR>select top n * form ** where XXX<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-19 9:22:40 得分:0<BR><BR>不错，不错，<BR>蛮喜欢junsisi(君三思)的这句：<BR>select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b<BR>对net_lover(孟子E章)前辈，这句不理解，我菜，呵呵<BR>SQL:SELECT NEWID()<BR><BR>Top<BR>回复人： cpp2017(幕白兄) ( ) 信誉：145 2003-3-19 9:27:39 得分:0<BR><BR>SELECT DISTINCT TSD.Time_Sheet_Dtl_Record_No,TSD.User_Record_No,TP.Period_Start_Date ,TP.Period_End_Date INTO #temp FROM Time_Sheet_Details TSD, Time_Sheet_Period TP ,User_Group_User_Relationship UGUR,User_Group_Master UGM ,User_Data_Access_Right UDAR WHERE TSD.status ='TS_WFMGRA' AND DATEDIFF(dd,TP.period_start_date,TSD.work_Date)&gt;=0 AND DATEDIFF(dd,TP.period_end_date,TSD.work_Date)&lt;=0 AND UGUR.User_Record_No = TSD.User_Record_No AND UGM.User_Group_Record_No=UGUR.User_Group_Record_No AND UGM.User_Group_Name IN('Technician','Engineer') AND UDAR.User_Record_No = TSD.User_Record_No AND UDAR.Division_Record_No IN(1) SELECT DISTINCT A.User_Record_No, B.Staff_No, B.Full_Name,B.Job_Title, SUM(working_hour) AS Working_Hours,SUM(ot) AS OT_HOURS, C.Period_Start_Date,C.Period_End_Date INTO #temp2 FROM Time_Sheet_Details A INNER JOIN User_Master B ON B.User_Record_No= A.User_Record_No INNER JOIN #temp C ON C.Time_Sheet_Dtl_Record_No = A.Time_Sheet_Dtl_Record_No GROUP BY A.User_Record_No, B.Staff_No,B.Full_Name,B.Job_Title, C.Period_Start_Date,C.Period_End_Date HAVING COUNT(*) = DATEDIFF(d,C.Period_Start_Date,C.Period_End_Date)+1 Select A.User_Record_No,A.Staff_No,A.Full_Name,A.Job_Title ,A.Working_Hours,A.OT_HOURS,A.Period_Start_Date,A.Period_End_Date ,DM.Division_Code INTO #temp3 FROM #temp2 AS A INNER JOIN User_Data_Access_Right UDAR ON UDAR.User_Record_No = A.User_Record_No INNER JOIN Division_Master DM ON DM.Division_Record_No = UDAR.Division_Record_No SELECT * From #temp3 order by 1,7,8; Select Count(Distinct User_Record_No+Period_Start_Date+Period_End_Date) From #temp3 DROP TABLE #temp ,#temp2,#temp3<BR><BR>Top<BR>回复人： cloud1002(好得掉渣~) ( ) 信誉：100 2003-3-19 9:35:06 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： smallmuda(飞翔的猪) ( ) 信誉：101 2003-3-19 9:37:27 得分:0<BR><BR>select * from a where time between time1 and time2<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 9:40:15 得分:0<BR><BR>让你们看看什么是SQL经典吧..<BR>http://expert.csdn.net/Expert/TopicView1.asp?id=928809<BR><BR>Top<BR>回复人： cpp2017(幕白兄) ( ) 信誉：145 2003-3-19 9:41:08 得分:5<BR><BR>select isNull(A.name,B.name),isnull(a.code,B.code) from table1 A<BR>full out join table2 B on<BR>A.id = B.id<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 9:43:29 得分:0<BR><BR>to cpp2017(长安不见使人愁) <BR>jeff?<BR><BR>Top<BR>回复人： zhw_yihui(卜卢特) ( ) 信誉：94 2003-3-19 9:53:25 得分:0<BR><BR>SQL:SELECT NEWID()<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 9:58:59 得分:0<BR><BR>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)<BR>选择在每一组b值相同的数据中对应的a最大的(换成average或别的函数或子查询,你会有意想不到的发现)记录的所有信息.<BR>类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.<BR>上面的许多同志对子查询存在有偏见与误解,其实在一个好的数据分析程序中,子查询可以简化很多程序逻辑.<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 10:01:40 得分:0<BR><BR>上面select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)<BR>这种相关子查询和delete(insert)等结合起来,可以用于消除数据库中某个字段(或某些)的重复值<BR><BR>Top<BR>回复人： hubinasm(火星撞地球) ( ) 信誉：115 2003-3-19 10:10:41 得分:0<BR><BR>(select a from tableA ) except (select a from tableB) except (select a from tableC)<BR><BR>Top<BR>回复人： aocool(知秋一叶) ( ) 信誉：100 2003-3-19 10:14:11 得分:0<BR><BR>获益不浅啊.<BR>SELECT DISTINCT TSD.Time_Sheet_Dtl_Record_No,TSD.User_Record_No,TP.Period_Start_Date ,TP.Period_End_Date INTO #temp FROM Time_Sheet_Details TSD, Time_Sheet_Period TP ,User_Group_User_Relationship UGUR,User_Group_Master UGM ,User_Data_Access_Right UDAR WHERE TSD.status ='TS_WFMGRA' AND DATEDIFF(dd,TP.period_start_date,TSD.work_Date)&gt;=0 AND DATEDIFF(dd,TP.period_end_date,TSD.work_Date)&lt;=0 AND UGUR.User_Record_No = TSD.User_Record_No AND UGM.User_Group_Record_No=UGUR.User_Group_Record_No AND UGM.User_Group_Name IN('Technician','Engineer') AND UDAR.User_Record_No = TSD.User_Record_No AND UDAR.Division_Record_No IN(1) SELECT DISTINCT A.User_Record_No, B.Staff_No, B.Full_Name,B.Job_Title, SUM(working_hour) AS Working_Hours,SUM(ot) AS OT_HOURS, C.Period_Start_Date,C.Period_End_Date INTO #temp2 FROM Time_Sheet_Details A INNER JOIN User_Master B ON B.User_Record_No= A.User_Record_No INNER JOIN #temp C ON C.Time_Sheet_Dtl_Record_No = A.Time_Sheet_Dtl_Record_No GROUP BY A.User_Record_No, B.Staff_No,B.Full_Name,B.Job_Title, C.Period_Start_Date,C.Period_End_Date HAVING COUNT(*) = DATEDIFF(d,C.Period_Start_Date,C.Period_End_Date)+1 Select A.User_Record_No,A.Staff_No,A.Full_Name,A.Job_Title ,A.Working_Hours,A.OT_HOURS,A.Period_Start_Date,A.Period_End_Date ,DM.Division_Code INTO #temp3 FROM #temp2 AS A INNER JOIN User_Data_Access_Right UDAR ON UDAR.User_Record_No = A.User_Record_No INNER JOIN Division_Master DM ON DM.Division_Record_No = UDAR.Division_Record_No SELECT * From #temp3 order by 1,7,8; Select Count(Distinct User_Record_No+Period_Start_Date+Period_End_Date) From #temp3 DROP TABLE #temp ,#temp2,#temp3<BR>:)<BR><BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3741#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3742'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:18:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>Top<BR>回复人： seafarer777(还是离爱情远点......) ( ) 信誉：95 2003-3-19 10:21:04 得分:0<BR><BR>收藏，^_^<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-19 10:51:59 得分:0<BR><BR>cpp2017(长安不见使人愁)这么长一句，少见，能否介绍介绍它的功力？^_^<BR>SELECT DISTINCT TSD.Time_Sheet_Dtl_Record_No,TSD.User_Record_No,TP.Period_Start_Date ,TP.Period_End_Date INTO #temp FROM Time_Sheet_Details TSD, Time_Sheet_Period TP ,User_Group_User_Relationship UGUR,User_Group_Master UGM ,User_Data_Access_Right UDAR WHERE TSD.status ='TS_WFMGRA' AND DATEDIFF(dd,TP.period_start_date,TSD.work_Date)&gt;=0 AND DATEDIFF(dd,TP.period_end_date,TSD.work_Date)&lt;=0 AND UGUR.User_Record_No = TSD.User_Record_No AND UGM.User_Group_Record_No=UGUR.User_Group_Record_No AND UGM.User_Group_Name IN('Technician','Engineer') AND UDAR.User_Record_No = TSD.User_Record_No AND UDAR.Division_Record_No IN(1) SELECT DISTINCT A.User_Record_No, B.Staff_No, B.Full_Name,B.Job_Title, SUM(working_hour) AS Working_Hours,SUM(ot) AS OT_HOURS, C.Period_Start_Date,C.Period_End_Date INTO #temp2 FROM Time_Sheet_Details A INNER JOIN User_Master B ON B.User_Record_No= A.User_Record_No INNER JOIN #temp C ON C.Time_Sheet_Dtl_Record_No = A.Time_Sheet_Dtl_Record_No GROUP BY A.User_Record_No, B.Staff_No,B.Full_Name,B.Job_Title, C.Period_Start_Date,C.Period_End_Date HAVING COUNT(*) = DATEDIFF(d,C.Period_Start_Date,C.Period_End_Date)+1 Select A.User_Record_No,A.Staff_No,A.Full_Name,A.Job_Title ,A.Working_Hours,A.OT_HOURS,A.Period_Start_Date,A.Period_End_Date ,DM.Division_Code INTO #temp3 FROM #temp2 AS A INNER JOIN User_Data_Access_Right UDAR ON UDAR.User_Record_No = A.User_Record_No INNER JOIN Division_Master DM ON DM.Division_Record_No = UDAR.Division_Record_No SELECT * From #temp3 order by 1,7,8; Select Count(Distinct User_Record_No+Period_Start_Date+Period_End_Date) From #temp3 DROP TABLE #temp ,#temp2,#temp3<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 11:14:05 得分:0<BR><BR>我认为上面的语句在实现需求时并不是最简,效率最高的语句.<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-19 11:45:29 得分:0<BR><BR>各种查询技巧结合才能写出最高效的查询<BR>在SQL中使用DISTINCT是代价比较高的查询方式<BR><BR>Top<BR>回复人： oldsky(九指神丐) ( ) 信誉：54 2003-3-19 13:13:09 得分:0<BR><BR>微软不公布SQLserver2000中的函数:<BR>print pwdcompare('helloworld', pwdencrypt('helloworld'))<BR>print pwdcompare('hello', pwdencrypt('world'))<BR><BR>Top<BR>回复人： funboy88(司令) ( ) 信誉：121 2003-3-19 13:20:20 得分:0<BR><BR>pwdencrypt<BR>密码加密？<BR>有些什么作用，不明白<BR>随机取出10条数据<BR>select top 10 * from tablename order by newid()<BR><BR>Top<BR>回复人： mzcih(小马过河) ( ) 信誉：110 2003-3-19 13:25:31 得分:0<BR><BR>看君一张贴，胜看一天书。<BR><BR>Top<BR>回复人： funboy88(司令) ( ) 信誉：121 2003-3-19 13:26:48 得分:5<BR><BR>功能：<BR>type&nbsp;&nbsp; vender pcs<BR>电脑&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>电脑&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1<BR>光盘&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>光盘&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2<BR>手机&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<BR>手机&nbsp;&nbsp; C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3<BR>select type,sum(case vender when 'A' then pcs else 0 end),sum(case vender when 'C' then pcs else 0 end),sum(case vender when 'B' then pcs else 0 end) FROM tablename group by type<BR><BR>Top<BR>回复人： funboy88(司令) ( ) 信誉：121 2003-3-19 13:30:27 得分:0<BR><BR>FUNCTION：DELELTE REPEAT RECORDS<BR>DELETE&nbsp;&nbsp;from tablename where id not in (select max(id) from tablename group by col1,col2,...)<BR><BR>Top<BR>回复人： chonboy(一只来自南方的羊) ( ) 信誉：100 2003-3-19 14:32:56 得分:0<BR><BR>Microsoft SQL Server是如何加密口令的？未公开的加密函数？ <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>如果对MSSQL的用户信息有兴趣的，可能会发现master.dbo.sysxlogins里面存放着用户的口令，可是呢，password字段如果不是null就是一堆看不懂的binary，这个口令是怎么加密的呢？<BR>其实只要仔细看看master.dbo.sp_addlogin就知道了，MSSQL的sp都可以看到代码，真是不错。<BR>让我们来看看它是怎么做的，注意这一行select @passwd = pwdencrypt(@passwd)，这个时后@passwd就被加密了，让我们也来试一下<BR>DECLARE @ClearPWD varchar(255) <BR>DECLARE @EncryptedPWD varbinary(255)<BR>SELECT @ClearPWD = 'test'<BR>SELECT @EncryptedPWD = CONVERT(varbinary(255), pwdencrypt(@ClearPWD))<BR>SELECT @EncryptedPWD<BR>看上去不错，确实被加密了，可是我怎么还原呢？ <BR>呵呵，这就没戏了，口令加密都是单向的，用加密后的密文来比较就可以了。<BR>继续看看其它用户相关的sp，可以发现master.dbo.sp_password里面有口令比较的内容。<BR>pwdcompare(@old, password, (CASE WHEN xstatus&amp;2048 = 2048 THEN 1 ELSE 0 END))<BR>不用去理会xstatus，这是一个状态掩码，一般我们用的时候就直接用0就可以了<BR>DECLARE @ClearPWD varchar(255) <BR>DECLARE @EncryptedPWD varbinary(255)<BR>SELECT @ClearPWD = 'test'<BR>SELECT @EncryptedPWD = CONVERT(varbinary(255), pwdencrypt(@ClearPWD))<BR>SELECT pwdcompare(@ClearPWD, @EncryptedPWD, 0)<BR>SELECT pwdcompare('ErrorPassword', @EncryptedPWD, 0)<BR>这样我们就可以使用这两个函数来加密自己的密码了，怎么样，还不错吧？<BR><BR>引用自<BR>http://www.bgchina.com/daily/bd_1/<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-20 10:00:45 得分:0<BR><BR>SELECT语法：(基本)<BR>SELECT [DISTINCT]<BR>(column [{, column } ] )| *<BR>FROM table [ { , table} ]<BR>[ORDER BY column [ASC] | [DESC<BR>[{ , column [ASC] | [DESC } ] ]<BR>WHERE predicate [ { logical-connector predicate } ];<BR>------------------------------------------------------<BR>INSERT语法：<BR>INSERT INTO table<BR>[(column { ,column})]<BR>VALUES<BR>(columnvalue [{,columnvalue}]);<BR>------------------------------------------------------<BR>UPDATE语法：<BR>UPDATE table<BR>SET column = value [{, column = value}]<BR>[ WHERE predicate [ { logical-connector predicate}]];<BR>------------------------------------------------------<BR>DELETE语法：<BR>DELETE FROM table<BR>[WHERE predicate [ { logical-connector predicate} ] ];<BR>------------------------------------------------------<BR><BR>Top<BR>回复人： liuzxit(每日晕十几次) ( ) 信誉：115 2003-3-20 10:13:05 得分:0<BR><BR>想把我那身L的SELECTZ句拿出砹拴o不^]d趣<BR><BR>Top<BR>回复人： lgj1012(oοО○≮国产超人≯○Оοo) ( ) 信誉：99 2003-3-20 10:13:41 得分:0<BR><BR>MARK MARK<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-20 10:41:56 得分:0<BR><BR>常识补充<BR>统计函数：<BR>AVG(字段名) 得出一个表格栏平均值<BR>COUNT(*|字段名) 对数据行数的统计或对某一栏有值的数据行数统计<BR>MAX(字段名) 取得一个表格栏最大的值<BR>MIN(字段名) 取得一个表格栏最小的值<BR>SUM(字段名) 把数据栏的值相加<BR>eg：<BR>sql="select sum(字段名) as 别名 from 数据表 where 条件表达式"<BR><BR>Top<BR>回复人： carl__yao(^目) ( ) 信誉：95 2003-3-20 10:50:06 得分:0<BR><BR>select top 0 * into b from a<BR><BR>Top<BR>回复人： flashasp(flashasp) ( ) 信誉：95 2003-3-20 13:05:01 得分:0<BR><BR>select name from sysobjects where type='U''列出数据库里所有的表名<BR>select name from syscolumns where id=object_id('TableName')'列出表里的所有的<BR><BR>Top<BR>回复人： flashasp(flashasp) ( ) 信誉：95 2003-3-20 13:05:47 得分:0<BR><BR>select name from sysobjects where type='U''列出数据库里所有的表名<BR>select name from syscolumns where id=object_id('TableName')'列出表里的所有的字段名<BR><BR>Top<BR>回复人： annkie(无声的雨) ( ) 信誉：113 2003-3-20 13:27:22 得分:0<BR><BR>帮忙看看这个帖子，解决了我想贴在这里应该是可以的 :)<BR>http://expert.csdn.net/Expert/topic/1554/1554516.xml?temp=.6041071<BR><BR>Top<BR>回复人： flyinto(孤独求败) ( ) 信誉：100 2003-3-20 14:14:42 得分:0<BR><BR>MARK<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-20 14:15:00 得分:0<BR><BR>source data<BR>kzx4dm xbdm jylsfsdm ...<BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10<BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 <BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10<BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20 <BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20<BR>destination:<BR>kzx4dm&nbsp;&nbsp;bys_count yjs_count jy_ratio<BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.00<BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/3<BR>SELECT DISTINCT kzx4dm,(SELECT COUNT(jylsfsdm) FROM tablename WHERE kzx4dm=TA.kzx4dm) AS bys_count,(SELECT COUNT(jylsfsdm) FROM tablename WHERE kzx4dm=TA.kzx4dm WHERE jylsfsdm=10) AS yjs_count,yjs_count/bys_count AS jy_ratio<BR>FROM tablename AS TA<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-20 14:18:35 得分:10<BR><BR>to annkie(活着便精彩) <BR>看看上面的语句是否解决了问题?<BR>纠正一下,应该是<BR>SELECT DISTINCT kzx4dm,(SELECT COUNT(jylsfsdm) FROM tablename WHERE kzx4dm=TA.kzx4dm) AS bys_count,(SELECT COUNT(jylsfsdm) FROM tablename WHERE kzx4dm=TA.kzx4dm AND jylsfsdm=10) AS yjs_count,yjs_count/bys_count AS jy_ratio<BR>FROM tablename AS TA<BR><BR>Top<BR>回复人： GageCSDN(稻草人) ( ) 信誉：100 2003-3-20 17:30:45 得分:0<BR><BR>seeing........<BR><BR>Top<BR>回复人： allserver(server) ( ) 信誉：100 2003-3-20 19:13:25 得分:0<BR><BR>8错<BR><BR>Top<BR>回复人： kirc(无聊中...) ( ) 信誉：100 2003-3-20 19:16:32 得分:0<BR><BR>关注....<BR><BR>Top<BR>回复人： annkie(无声的雨) ( ) 信誉：113 2003-3-20 19:28:23 得分:0<BR><BR>To yonghengdizhen:<BR>thank you.<BR>正在研究此问题中.<BR>yjs_count/bys_count AS jy_ratio 这句无法通过检查,不过可以把前面的东西拿倒这里来搞定,不使用字段名.<BR>&nbsp;&nbsp;你的sql语句是对的.<BR><BR>Top<BR>回复人： flyycyu(fly) ( ) 信誉：100 2003-3-21 9:36:40 得分:0<BR><BR>gz<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-21 10:02:00 得分:0<BR><BR>我决定：把200分中的180分，奖给贴出最精妙的SQL的高手！<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-21 11:00:52 得分:0<BR><BR>二维表 T(F1,F2,F3,F4,F5,F6,F7) 表示如下关系:<BR>&nbsp;&nbsp;学生ID&nbsp;&nbsp;&nbsp;&nbsp;学生姓名&nbsp;&nbsp;&nbsp;&nbsp;课程ID&nbsp;&nbsp;&nbsp;&nbsp;课程名称&nbsp;&nbsp;&nbsp;&nbsp; 成绩&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;教师ID&nbsp;&nbsp;&nbsp;&nbsp;教师姓名 <BR>&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;王五&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;政治&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 赵老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;张三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数学&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 张老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;英语&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;88&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 李老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;张三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;政治&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;77&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 赵老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;政治&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;67&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 周老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;王五&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;语文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 王老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;王五&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数学&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 张老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;张三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;语文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 王老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;赵六&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;语文&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 王老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;张三&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;英语&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 李老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;S2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;李四&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数学&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 张老师&nbsp;&nbsp;<BR>&nbsp;&nbsp;请以一句 T-SQL (Ms SQL Server) 或 Jet SQL (Ms Access) 在 原表 T 基础上作答<BR>1.如果 T 表还有一字段 F0 数据类型为自动增量整型(唯一,不会重复),<BR>&nbsp;&nbsp;而且 T 表中含有除 F0 字段外,请删除其它字段完全相同的重复多余的脏记录数据:<BR>delete from t&nbsp;&nbsp;where f0 in(select max(f0) from t group by f1,f2,f3,f4,f5,f6,f7 having count(f0)&gt;1)<BR>2.列印各科成绩最高和最低的记录: (就是各门课程的最高、最低分的学生和老师)<BR>&nbsp;&nbsp;课程ID,课程名称,最高分,学生ID,学生姓名,教师ID,教师姓名,最低分,学生ID,学生姓名,教师ID,教师姓名<BR>select tb.f4,tb.f3,tb1.f5,tb.f1,tb.f2,tb.f6,tb.f7,tb2.f5,tb2.f1,tb2.f2,tb2.f6,tb2.f7 from t tb where <BR>f5=(select max(f5) from t where t.f4=tb.f4)<BR>join select f2,f7 from t tb2 where <BR>f5=(select min(f5) from t where t.f4=tb2.f4)<BR>on tb.f4=tb2.f4<BR>先完成一个,想想在做下一个.<BR>3.按成绩从高到低顺序,列印所有学生四门(数学,语文,英语,政治)课程成绩: (就是每个学生的四门课程的成绩单)<BR>&nbsp;&nbsp;学生ID,学生姓名,数学,语文,英语,政治,有效课程数,有效平均分<BR>&nbsp;&nbsp;(注: 有效课程即在 T 表中有该学生的成绩记录,如不明白可不列印"有效课程数"和"有效平均分")<BR>select tb1.f1,tb1.f2,count(tb1.f5) as scores,sum(tb1.f5) as scoresum, avg(tb1.f5) AS average, <BR>tb2.f5,tb3.f5,tb4.f5,tb5.f5 <BR>from t as tb1 <BR>left join t as tb2<BR>on tb1.f0=tb2.f0 and tb2.f3=k4<BR>left join t as tb3<BR>on tb1.f0=tb3.f0 and tb3.f3=k3<BR>left join t as tb4<BR>on tb1.f0=tb4.f0 and tb4.f3=k2<BR>left join t as tb5<BR>on tb1.f0=tb5.f0 and tb5.f3=k1<BR>grout by tb1.f2 order by tb1.scoresum desc<BR>4.按各科不及格率的百分数从低到高和平均成绩从高到低顺序,统计并列印各科平均成绩和不及格率的百分数(用"N行"表示): (就是分析哪门课程难)<BR>&nbsp;&nbsp;课程ID,课程名称,平均成绩,及格百分数<BR>select&nbsp;&nbsp;f3,f4, (select count(f1) from t where t.f4=tb.f4 and f5&lt;60)/(select count(f1) from t where t.f4=tb.f4) as failper,((select sum(f5) from t where t.f4=tb.f4)/ (select count(f5) from t where t.f4=tb.f4)) as averagescore<BR>from t tb order by failper asc, as averagescore desc<BR><BR>Top<BR>回复人： wenhao676(zzc) ( ) 信誉：93 2003-3-21 11:01:50 得分:0<BR><BR>/****** Object:&nbsp;&nbsp;Stored Procedure dbo.dt_checkoutobject&nbsp;&nbsp;&nbsp;&nbsp;Script Date: 2003-3-12 9:25:26 ******/<BR>create proc dbo.dt_checkoutobject<BR>&nbsp;&nbsp;&nbsp;&nbsp;@chObjectType&nbsp;&nbsp;char(4),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@vchObjectName varchar(255),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@vchComment&nbsp;&nbsp;&nbsp;&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@vchLoginName&nbsp;&nbsp;varchar(255),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@vchPassword&nbsp;&nbsp; varchar(255),<BR>&nbsp;&nbsp;&nbsp;&nbsp;@iVCSFlags&nbsp;&nbsp;&nbsp;&nbsp; int = 0,<BR>&nbsp;&nbsp;&nbsp;&nbsp;@iActionFlag&nbsp;&nbsp; int = 0/* 0 =&gt; Checkout, 1 =&gt; GetLatest, 2 =&gt; UndoCheckOut */<BR>as<BR>set nocount on<BR>declare @iReturn int<BR>declare @iObjectId int<BR>select @iObjectId =0<BR>declare @VSSGUID varchar(100)<BR>select @VSSGUID = 'SQLVersionControl.VCS_SQL'<BR>declare @iReturnValue int<BR>select @iReturnValue = 0<BR>declare @vchTempText varchar(255)<BR>/* this is for our strings */<BR>declare @iStreamObjectId int<BR>select @iStreamObjectId = 0<BR>&nbsp;&nbsp;&nbsp;&nbsp;declare @iPropertyObjectId int<BR>&nbsp;&nbsp;&nbsp;&nbsp;select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')<BR>&nbsp;&nbsp;&nbsp;&nbsp;declare @vchProjectName&nbsp;&nbsp; varchar(255)<BR>&nbsp;&nbsp;&nbsp;&nbsp;declare @vchSourceSafeINI varchar(255)<BR>&nbsp;&nbsp;&nbsp;&nbsp;declare @vchServerName&nbsp;&nbsp;&nbsp;&nbsp;varchar(255)<BR>&nbsp;&nbsp;&nbsp;&nbsp;declare @vchDatabaseName&nbsp;&nbsp;varchar(255)<BR>&nbsp;&nbsp;&nbsp;&nbsp;exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @vchProjectName&nbsp;&nbsp; OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',&nbsp;&nbsp;&nbsp;&nbsp; @vchServerName&nbsp;&nbsp;&nbsp;&nbsp;OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',&nbsp;&nbsp; @vchDatabaseName&nbsp;&nbsp;OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;if @chObjectType = 'PROC'<BR>&nbsp;&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/* Procedure Can have up to three streams<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Drop Stream, Create Stream, GRANT stream */<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @iReturn &lt;&gt; 0 GOTO E_OAError<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec @iReturn = sp_OAMethod @iObjectId,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'CheckOut_StoredProcedure',<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sProjectName = @vchProjectName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sSourceSafeINI = @vchSourceSafeINI,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sObjectName = @vchObjectName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sServerName = @vchServerName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sDatabaseName = @vchDatabaseName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sComment = @vchComment,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sLoginName = @vchLoginName,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@sPassword = @vchPassword,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@iVCSFlags = @iVCSFlags,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@iActionFlag = @iActionFlag<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @iReturn &lt;&gt; 0 GOTO E_OAError<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec @iReturn = sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @iReturn &lt;&gt; 0 GOTO E_OAError<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create table #commenttext (id int identity, sourcecode varchar(255))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select @vchTempText = 'STUB'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while @vchTempText IS NOT NULL<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec @iReturn = sp_OAMethod @iStreamObjectId, 'GetStream', @iReturnValue OUT, @vchTempText OUT<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @iReturn &lt;&gt; 0 GOTO E_OAError<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@vchTempText IS NOT NULL) insert into #commenttext (sourcecode) select @vchTempText<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select 'VCS'=sourcecode from #commenttext order by id<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select 'SQL'=text from syscomments where id = object_id(@vchObjectName) order by colid<BR>&nbsp;&nbsp;&nbsp;&nbsp;end<BR>CleanUp:<BR>&nbsp;&nbsp;&nbsp;&nbsp;return<BR>E_OAError:<BR>&nbsp;&nbsp;&nbsp;&nbsp;exec dbo.dt_displayoaerror @iObjectId, @iReturn<BR>&nbsp;&nbsp;&nbsp;&nbsp;GOTO CleanUp<BR>GO<BR>看的我直晕~！<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-21 11:17:12 得分:0<BR><BR>1.如果 T 表还有一字段 F0 数据类型为自动增量整型(唯一,不会重复),<BR>&nbsp;&nbsp;而且 T 表中含有除 F0 字段外,请删除其它字段完全相同的重复多余的脏记录数据:<BR>delete from t&nbsp;&nbsp;where f0 in(select max(f0) from t group by f1,f2,f3,f4,f5,f6,f7 having count(f0)&gt;1)<BR>上面这个sql有问题<BR>正确的如下<BR>DELETE Legal_Dispute_Lawyer WHERE Lawyer_Record_No IN(SELECT Lawyer_Record_No FROM Legal_Dispute_Lawyer LDL WHERE Lawyer_Record_No(SELECT TOP 1 Lawyer_Record_No FROM Legal_Dispute_Lawyer WHERE LD=LDL.LD AND Name=LDL.Name AND Email=LDL.Email AND Phone_No=LDL.Phone_No AND Fax_No=LDL.Fax_No))<BR>消除Legal_Dispute_Lawyer 表中除Lawyer_Record_No(自增字段)外其余数据完全相同的记录.<BR>表结构如下<BR>if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[Legal_Dispute_Lawyer]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)<BR>drop table [dbo].[Legal_Dispute_Lawyer]<BR>GO<BR>CREATE TABLE [dbo].[Legal_Dispute_Lawyer] (<BR>[Lawyer_Record_No] [int] IDENTITY (1, 1) NOT NULL ,<BR>[LD] [int] NOT NULL ,<BR>[Name] [int] NOT NULL ,<BR>[Phone_No] [varchar] (255) COLLATE Chinese_PRC_CI_AS NULL ,<BR>[Fax_No] [varchar] (255) COLLATE Chinese_PRC_CI_AS NULL ,<BR><a href=http://bbs.fractalist.cn/Skins/Default/emot/email.gif target=_blank><IMG onmousewheel="return bbimg(this)" src="http://bbs.fractalist.cn/Skins/Default/emot/email.gif" onload="javascript :if(this.width onmousewheel='return bbimg(this)' border='0'  border='0' title='点击在新窗口查看原始图片' onload='java_script_:if(this.width>400)this.width=400'></a>screen.width-500)this.style.width=screen.width-500;" align=middle border=0> [varchar] (255) COLLATE Chinese_PRC_CI_AS NULL <BR>) ON [PRIMARY]<BR>GO<BR>以这种方式还可以实现组内消除重复值..<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-21 11:19:48 得分:0<BR><BR>DELETE Legal_Dispute_Lawyer WHERE Lawyer_Record_No IN(SELECT Lawyer_Record_No FROM Legal_Dispute_Lawyer LDL WHERE Lawyer_Record_No&lt;&gt;(SELECT TOP 1 Lawyer_Record_No FROM Legal_Dispute_Lawyer WHERE LD=LDL.LD AND Name=LDL.Name AND Email=LDL.Email AND Phone_No=LDL.Phone_No AND Fax_No=LDL.Fax_No))<BR><BR>Top<BR>回复人： ylecho(~猫猫) ( ) 信誉：100 2003-3-21 13:58:37 得分:0<BR><BR>select * from table;<BR>xixi<BR><BR>Top<BR>回复人： SeaSee(纵横四海) ( ) 信誉：100 2003-3-21 14:10:19 得分:0<BR><BR>table1<BR>kzx4dm xbdm jylsfsdm ...<BR>10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8<BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9 <BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19<BR>13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 18 <BR>14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19<BR>select top 3 with ties jylsfsdm from table1<BR>结果：<BR>kzx4dm xbdm jylsfsdm ...<BR>12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19<BR>14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 19<BR>13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 18 <BR>11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9 <BR>说明：取出并列排行的所有记录<BR><BR>Top<BR>回复人： lsqteng(阿琦) ( ) 信誉：102 2003-3-21 14:18:11 得分:0<BR><BR>说到语法我就来兴趣了，哈哈，请看:<BR>SELECT statement::=<BR>&lt;query_experssion&gt;<BR>[ORDER BY {order_by_expression|Column_position[ASC|DESC]}<BR>[,...n]]<BR>[COMPUTE<BR>{{AVG|COUNT|MAX|MIN|SUM}(exression)}[,...n]<BR>[BY expression[,...n]]<BR>]<BR>[FOR {BROWSE |XML{RAW|AUTO|EXPLICIT}<BR>&nbsp;&nbsp;[,XMLDATA]<BR>&nbsp;&nbsp;[,ELEMENTS]<BR>&nbsp;&nbsp;[,BINARY base64]<BR>}<BR>]<BR>[OPTION(&lt;query_hint&gt;[,...n])]<BR>&nbsp;&nbsp; &lt;query expression&gt;::=<BR>{&lt;query specification&gt;|(&lt;query expression&gt;)}<BR>[UNION[ALL]&lt;query specification|(&lt;query expression&lt;)[...n]]<BR>&lt;query specification&gt;::=<BR>SELECT [ALL|DISTINCT]<BR>&nbsp;&nbsp;[{TOP integer|TOP integer PERCENT}[WITH TIES]]<BR>&lt;select _list&gt;<BR>[INTO new_table]<BR>[FROM{&lt;table_source&gt;}[,...n]]<BR>[WHERE &lt;search_condition&gt;]<BR>[GROUP BY [ALL]group_by_expression[,...n]<BR>&nbsp;&nbsp;[WITH{CUBE|ROLLUP}]<BR>]<BR>[HAVING&lt;search_condition&gt;}<BR>哎，行了吧，这还是select 语句的形式。要看完全的，喔，那可不得了喔。我不写了，累死了，呵呵<BR><BR>Top<BR>回复人： vulcan(东方不败) ( ) 信誉：126 2003-3-21 14:24:43 得分:0<BR><BR>关注.<BR><BR>Top<BR>回复人： zhangguagua(瓜瓜) ( ) 信誉：131 2003-3-21 14:37:53 得分:0<BR><BR>收藏<BR><BR>Top<BR>回复人： shark7823(魔鬼的脸蛋，天使的身材) ( ) 信誉：97 2003-3-21 14:45:12 得分:0<BR><BR>这种好贴，不mark，不行啊<BR><BR>Top<BR>回复人： bingeng(大眼镜) ( ) 信誉：102 2003-3-21 14:47:42 得分:0<BR><BR>UP<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-21 15:24:55 得分:0<BR><BR>敬请高手出贴，最好是存储过程<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-21 15:31:32 得分:0<BR><BR>存储过程其实没什么经典不经典.<BR>无非是把你在VBS中实现的逻辑在sql服务端实现而已..<BR>而高效的存储过程往往还是使用传统的sql语法来实现主要逻辑.<BR><BR>Top<BR>回复人： windyao(猫) ( ) 信誉：94 2003-3-21 16:02:22 得分:0<BR><BR>8错8错<BR><BR>Top<BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3742#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3743'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:18:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>回复人： wwl1981(小刀) ( ) 信誉：105 2003-3-21 16:04:18 得分:0<BR><BR>是那个家伙对数据下了手脚^_^<BR>create table IKnowYou<BR>(userid varchar(30),<BR>TableName varchar(50),<BR>Action varchar(6),<BR>DateT datatime,<BR>TrrigerTableColumns.....,<BR>TrrigerTableColumns.....)<BR>create trriger Who_Do_It on table<BR>for update<BR>as<BR>declare userid varchar(30)<BR>declare TableName varchar(50)<BR>declare Action varchar(6)<BR>userid=@@suser_sname<BR>Action='update'<BR>TableName='tabel'<BR>insert into IKnowYou values(userid,TableName,Action,Now,select * from deleted,select * from inserted)<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-21 17:06:52 得分:0<BR><BR>kill all connections to a given databse<BR>CREATE PROCEDURE usp_killDBConnections @DBName varchar(50), @withmsg bit=1<BR>AS<BR>SET NOCOUNT ON<BR>DECLARE @spidstr varchar(8000)<BR>DECLARE @ConnKilled smallint<BR>SET @ConnKilled=0<BR>SET @spidstr = ''<BR>IF db_id(@DBName) &lt; 4 <BR>BEGIN<BR>PRINT 'Connections to system databases cannot be killed'<BR>RETURN<BR>END<BR>SELECT @spidstr=coalesce(@spidstr,',' )+'kill '+convert(varchar, spid)+ '; '<BR>FROM master..sysprocesses WHERE dbid=db_id(@DBName)<BR>IF LEN(@spidstr) &gt; 0 <BR>BEGIN<BR>EXEC(@spidstr)<BR>SELECT @ConnKilled = COUNT(1)<BR>FROM master..sysprocesses WHERE dbid=db_id(@DBName) <BR>END<BR>IF @withmsg =1<BR>PRINT&nbsp;&nbsp;CONVERT(VARCHAR(10), @ConnKilled) + ' Connection(s) killed for DB '&nbsp;&nbsp;+ @DBName<BR>GO<BR><BR>Top<BR>回复人： matq2008(叶子.net) ( ) 信誉：100 2003-3-21 18:00:47 得分:0<BR><BR>SELECT A.NUM, A.NAME, B.UPD_DATE, B.PREV_UPD_DATE<BR>&nbsp;&nbsp;FROM TABLE1, <BR>&nbsp;&nbsp;&nbsp;&nbsp;(SELECT X.NUM, X.UPD_DATE, Y.UPD_DATE PREV_UPD_DATE<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT NUM, UPD_DATE, INBOUND_QTY, STOCK_ONHAND<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM TABLE2<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE TO_CHAR(UPD_DATE,'YYYY/MM') = TO_CHAR(SYSDATE, 'YYYY/MM')) X, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT NUM, UPD_DATE, STOCK_ONHAND<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM TABLE2<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE TO_CHAR(UPD_DATE,'YYYY/MM') = <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TO_CHAR(TO_DATE(TO_CHAR(SYSDATE, 'YYYY/MM') &amp;brvbar;&amp;brvbar; '/01','YYYY/MM/DD') - 1, 'YYYY/MM') ) Y, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE X.NUM = Y.NUM （+）<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND X.INBOUND_QTY + NVL(Y.STOCK_ONHAND,0) &lt;&gt; X.STOCK_ONHAND ) B<BR>WHERE A.NUM = B.NUM&nbsp;&nbsp;<BR><BR>Top<BR>回复人： cnuninet(www.helloaspx.com) ( ) 信誉：100 2003-3-21 18:26:32 得分:0<BR><BR>SELECT * FROM table ORDER BY id<BR>SELECT * FROM table ORDER BY id DESC<BR>正反排序,厉害吧!<BR><BR>Top<BR>回复人： cnuninet(www.helloaspx.com) ( ) 信誉：100 2003-3-21 18:26:54 得分:0<BR><BR>还有,一次选出表中的所有内容:<BR>SELECT * FROM table<BR><BR>Top<BR>回复人： learnner(&amp;nbsp;) ( ) 信誉：110 2003-3-21 18:42:16 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-21 18:42:41 得分:0<BR><BR>楼上的哥们，厉害！^_^<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-21 18:45:07 得分:0<BR><BR>不是说你，是说： cnuninet(www.helloaspx.com) ,呵呵<BR><BR>Top<BR>回复人： miqier1209(米琪儿) ( ) 信誉：100 2003-3-21 22:58:39 得分:0<BR><BR>select * into b from a where 1&lt;&gt;1<BR>这样生成的b表访问的用户没有select的权限？<BR>请问sql DX们这个问题怎么解决？<BR><BR>Top<BR>回复人： whcasp(money is best~) ( ) 信誉：105 2003-3-22 9:25:25 得分:0<BR><BR>厉害<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-22 10:09:48 得分:0<BR><BR>Select left(field,1) as field1 from table_name order by field desc<BR><BR>Top<BR>回复人： ministrybill(生命的烙印) ( ) 信誉：120 2003-3-22 10:23:58 得分:0<BR><BR>唉，好像称不上经典<BR>大家来捧捧场：http://expert.csdn.net/Expert/topic/1545/1545418.xml?temp=.6732141<BR><BR>Top<BR>回复人： legend9(legend) ( ) 信誉：100 2003-3-22 11:13:44 得分:0<BR><BR>select count(clubmember.clubid)as hot,clubmember.clubid,clubinfo.clubid,clubinfo.name from clubmember,clubinfo where clubinfo.clubid=clubmember.clubid group by clubmember.clubid order by hot DESC limit 10<BR><BR>Top<BR>回复人： waterfall_cp(鸟鸟) ( ) 信誉：98 2003-3-22 11:36:37 得分:0<BR><BR>条件删除<BR>DELETE DBO.TEMP WHERE FLD_CHARACTER IN <BR>(<BR>SELECT FLD_CHARACTER<BR>FROM dbo.TBL_CHARACTER<BR>WHERE (FLD_DELETED = 1) AND (FLD_LEVEL &lt;= 18) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(FLD_UPDATEDATETIME &lt;= GETDATE() - 5)<BR>)<BR><BR>Top<BR>回复人： georgechen(小雨点) ( ) 信誉：100 2003-3-22 15:39:49 得分:0<BR><BR>选择前数据库里前10条记录：<BR>1、select top 10 * from table<BR>2、set rowcount 10<BR>&nbsp;&nbsp; select * from table<BR><BR>Top<BR>回复人： dh20156(风之石-ASP.net学习中) ( ) 信誉：5 2003-3-22 16:13:21 得分:0<BR><BR>今天才把合计函数搞定：<BR>&nbsp;&nbsp; Set rs=conn.execute("Select min(id) as minID from TABLE") ^_^<BR><BR>Top<BR>回复人： boy21cnthp(娃娃) ( ) 信誉：99 2003-3-22 17:06:00 得分:0<BR><BR>高手<BR><BR>Top<BR>回复人： honghaier(红孩儿) ( ) 信誉：100 2003-3-22 18:23:01 得分:0<BR><BR>select SQL高手 from 本版发贴者<BR>Where&nbsp;&nbsp;得分&gt;0<BR><BR>Top<BR>回复人： sevenhzheleven(水冰) ( ) 信誉：100 2003-3-24 1:54:26 得分:0<BR><BR>哇,,,,高手,你们是工作的时候学的,还是读书的时候开始学的?请教<BR><BR>Top<BR>回复人： ljupin(无情刀) ( ) 信誉：106 2003-3-24 2:09:57 得分:0<BR><BR>select * form *<BR>会执行吗<BR><BR>Top<BR>回复人： dawooo(大宇) ( ) 信誉：100 2003-3-24 8:15:58 得分:0<BR><BR>大宇阅览<BR><BR>Top<BR>回复人： wfnuser(夏雪) ( ) 信誉：103 2003-3-24 8:52:17 得分:5<BR><BR>select * from 日程安排 where datediff('minute',f开始时间,getdate())&gt;5<BR>日程安排提前五分钟提醒。<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-24 9:52:31 得分:0<BR><BR>to miqier1209(米琪儿) ( ) 信誉：100&nbsp;&nbsp;2003-03-21 22:58:00&nbsp;&nbsp;得分:0 <BR><BR><BR>&nbsp;&nbsp;select * into b from a where 1&lt;&gt;1<BR>这样生成的b表访问的用户没有select的权限？<BR>请问sql DX们这个问题怎么解决？<BR>指定dbo前缀应该可以解决问题了..<BR><BR><BR><BR>Top<BR>回复人： accp258(男人背后的女人) ( ) 信誉：101 2003-3-24 11:17:19 得分:0<BR><BR>mark!<BR><BR>Top<BR>回复人： suasalito(妈的，什么血这么难喝，喝可乐去) ( ) 信誉：100 2003-3-24 11:19:59 得分:0<BR><BR>同学们回答的都不错，恩，值得表扬<BR><BR>Top<BR>回复人： hotel9545(清风剑客) ( ) 信誉：100 2003-3-24 12:10:38 得分:0<BR><BR>复制一张表<BR>create table aaa as select * from bbb;<BR><BR>Top<BR>回复人： fenlin(千里之行，始于足下......) ( ) 信誉：110 2003-3-24 12:21:33 得分:0<BR><BR>我也来凑热闹，呵呵......<BR>&lt;%<BR>'取出随机记录<BR>Randomize<BR>RNumber = Int(Rnd*200) + 1<BR>SQL = "SELECT * FROM Customers WHERE ID = " &amp; RNumber<BR>set objRec = ObjConn.Execute(SQL)<BR>Response.WriteRNumber &amp; " = " &amp; objRec("ID") &amp; " " &amp; objRec("c_email")<BR>%&gt;<BR><BR>Top<BR>回复人： linens(存储过程) ( ) 信誉：100 2003-3-24 13:33:10 得分:0<BR><BR>上面的人把视图都搬出来了啊不过几乎都是查询，我来点实用的<BR>insert into pbrule(newrid,subj,bz,zf,orid,rstat,layer,bid) select newrid,subj,bz,zf,orid,rstat,layer,bid from pbrule1 where bruleid=bruleid<BR>将pbrule1 表中符合条件的记录 导入 pbrule表中<BR><BR>Top<BR>回复人： linens(存储过程) ( ) 信誉：100 2003-3-24 13:38:49 得分:0<BR><BR>下面这个更实用，就是两张关联表，删除主表中已经在副表中没有的信息<BR>delete from info where not exists ( select * from infobz where info.infid=infobz.infid ) <BR>这条语句就是删除 INFO表中infid字段在infobz中不存在的记录<BR>此语句用来维护数据库很有用哦。<BR>楼主给点分吧<BR><BR>Top<BR>回复人： qigang_liu(云山云海) ( ) 信誉：100 2003-3-24 15:19:57 得分:5<BR><BR>CREATE OR REPLACE PROCEDURE DUMP_TO_WEB_TCLHD_SP_OBJ<BR>AS<BR>BEGIN<BR>CALC_PIA_PRICE ;<BR>DELETE FROM TCLHD_SP_OBJ ;<BR>INSERT INTO TCLHD_SP_OBJ (NAME,CODE,ID,PRICE,TYPE,FIELDS) (<BR>SELECT c.DESCRIPTION,C.SEGMENT1,a.INVENTORY_ITEM_ID, nvl(c.ATTRIBUTE14,'0'),0,nvl(c.ATTRIBUTE13,0)<BR>from mtl_item_categories a , mtl_categories b , mtl_system_items c&nbsp;&nbsp; <BR>where a.CATEGORY_ID = b.CATEGORY_ID and b.SEGMENT1='原材料' <BR>and a.INVENTORY_ITEM_ID = c.INVENTORY_ITEM_ID AND A.ORGANIZATION_ID = 21&nbsp;&nbsp;&nbsp;&nbsp;<BR>and c.ORGANIZATION_ID = 21 and c.inventory_item_status_code = 'Active' );<BR>COMMIT ;<BR>END ;<BR><BR>Top<BR>回复人： wnhoo(ｅ梦缘) ( ) 信誉：115 2003-3-24 15:38:58 得分:0<BR><BR>数据库IBM DB2 》》》SQL<BR>绝对精华<BR>select dmbh,SJDM,flsm,dmzz from ydm where dmbh=3300<BR>union all<BR>select dmbh,SJDM,flsm,dmzz from ydm where dmbh in<BR>(select dmzz from ydm where dmbh=3300)<BR>union all<BR>select dmbh,SJDM,flsm,dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300))<BR>union all<BR>select dmbh,SJDM,flsm,dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300)))<BR>union all<BR>select dmbh,SJDM,flsm,dmzz from ydm where dmbh in<BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300))))<BR>**********************************<BR>select SJDM from ydm where dmbh=3300<BR>union all<BR>select SJDM from ydm where dmbh in<BR>(select dmzz from ydm where dmbh=3300)<BR>union all<BR>select SJDM from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300))<BR>union all<BR>select SJDM from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300)))<BR>union all<BR>select SJDM from ydm where dmbh in<BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in <BR>(select dmzz from ydm where dmbh in (<BR>select dmzz from ydm where dmbh=3300))))<BR>**************************************************<BR>SELECT COUNT(*) as yhs ,SUM(DF) as df FROM DB2.DFTDF<BR>WHERE (year(rq)*12+month(rq)) between 24015 and 24015 <BR>AND dflb=513 <BR>and (ZHH,YYH) IN <BR>(SELECT ZHH,YYxH FROM DB2.YDD111 WHERE HYM in<BR>( select SJDM from DB2.ydm where dmbh=3200 <BR>union all <BR>select SJDM from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh=3200) <BR>union all<BR>select SJDM from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh=3200))<BR>union all<BR>select SJDM from DB2.ydm where dmbh in (<BR>Select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh=3200)))<BR>union all<BR>select SJDM from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh in (<BR>select dmzz from DB2.ydm where dmbh=3200))))<BR>)) <BR>***********************************************<BR>select bcm,bsm,count(bsm) as sl<BR>from (<BR>select&nbsp;&nbsp;bcm,case <BR>when blx='DXB' and bxh like 'DD%' AND BXH NOT LIKE 'DDS%'<BR>then 'JJB'<BR>else 'DZB'<BR>end as bsm<BR>from jldb) as jldb2<BR>group by bcm,bsm<BR>select bcm,bsm,count(bsm) as sl<BR>from (<BR>select&nbsp;&nbsp;bcm,case <BR>when blx='DXB' and bxh like 'DD%' AND BXH NOT LIKE 'DDS%'<BR>then 'JJB'<BR>else 'DZB'<BR>end as bsm<BR>from jldb<BR>where bzt='OK' and qyrq between '1999-1-1' and '2003-1-3' ) as jldb2<BR>group by bcm,bsm<BR>****************<BR>select bcm,bsm,bxh,count(bsm) as sl<BR>from (<BR>select&nbsp;&nbsp;bcm,case <BR>when blx='DXB' and bxh like 'DD%' AND BXH NOT LIKE 'DDS%'<BR>then 'JJB'<BR>else 'DZB'<BR>end as bsm,bxh<BR>from jldb<BR>where bzt='OK' and qyrq between '1999-1-1' and '2003-1-3' ) as jldb2<BR>group by bcm,bxh,bsm<BR>**********************************************<BR>with ttt as (select bcm,bxh,bsm,count(bsm) as sl from (select&nbsp;&nbsp;bcm,bxh,case&nbsp;&nbsp;when blx='DXB' and bxh like 'DD%' AND BXH NOT LIKE 'DDS%' then '机械表' else 'DZB' end <BR>as bsm from jldb where bzt='OK' and qyrq&lt;='2002-2-2'&nbsp;&nbsp;) as jldb2 group by bcm,bxh,bsm),<BR>sss as (select bcm,bxh,bsm,count(bsm) as sl1 from (select&nbsp;&nbsp;bcm,bxh,case&nbsp;&nbsp;when blx='DXB' and bxh like 'DD%' AND BXH NOT LIKE 'DDS%' then '机械表' else 'DZB' end <BR>as bsm from jldb where bzt='OK' and qyrq&lt;='2000-1-1'&nbsp;&nbsp;) as jldb2 group by bcm,bxh,bsm)<BR>select ttt.bcm,ttt.bxh,ttt.bsm,value(ttt.sl,0) as sl1,value(sss.sl1,0)&nbsp;&nbsp;as sl2,(value(ttt.sl,0)-value(sss.sl1,0)) as sl3 from ttt full join sss <BR>on sss.bxh=ttt.bxh and sss.bcm=ttt.bcm and sss.bsm=ttt.bsm order by ttt.bcm,ttt.bxh,ttt.bsm<BR><BR>Top<BR>回复人： guzh() ( ) 信誉：100 2003-3-24 17:45:41 得分:0<BR><BR>看了<BR><BR>Top<BR>回复人： realljx(至尊十三少) ( ) 信誉：102 2003-3-24 18:52:15 得分:0<BR><BR>好长<BR><BR>Top<BR>回复人： shawshanke(我随风而来,随风而去) ( ) 信誉：100 2003-3-24 19:44:53 得分:0<BR><BR>恭喜此帖突破100大观!<BR>--------------------------------------------------<BR>我随风而来,又随风而去!<BR><BR>Top<BR>回复人： cep50(cep50) ( ) 信誉：100 2003-3-24 20:30:58 得分:0<BR><BR>上当了，该软件没什么用。是在骗取别人的智慧，还要收人家的人民币。<BR><BR>Top<BR>回复人： eafin(ｅ峰.Net)(一叶枫舟) ( ) 信誉：115 2003-3-24 21:00:38 得分:0<BR><BR>收藏啦！<BR>希望谁能把这些整理一下。然后我再收藏，呵呵<BR><BR>Top<BR>回复人： rolandzhang() ( ) 信誉：103 2003-3-24 21:22:06 得分:0<BR><BR>wenhao676能否加些注释？我菜一点。<BR><BR>Top<BR>回复人： coffee_black(黑咖啡) ( ) 信誉：100 2003-3-25 0:07:54 得分:0<BR><BR>是好贴！！<BR><BR>Top<BR>回复人： zhw_yihui(卜卢特) ( ) 信誉：94 2003-3-25 8:34:10 得分:0<BR><BR>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)<BR>选择在每一组b值相同的数据中对应的a最大的(换成average或别的函数或子查询,你会有意想不到的发现)记录的所有信息.<BR>类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等.<BR>上面的许多同志对子查询存在有偏见与误解,其实在一个好的数据分析程序中,子查询可以简化很多程序逻辑.<BR><BR>Top<BR>回复人： gage(蓝宝石) ( ) 信誉：100 2003-3-25 11:17:11 得分:0<BR><BR>收藏<BR><BR>Top<BR>回复人： fvsl(楚龙) ( ) 信誉：98 2003-3-25 13:09:51 得分:0<BR><BR>我收藏：）<BR><BR>Top<BR>回复人： zhusuhao(不以为然) ( ) 信誉：101 2003-3-25 13:51:32 得分:0<BR><BR>藏<BR><BR>Top<BR>回复人： fule(孤魂野鬼) ( ) 信誉：100 2003-3-25 13:59:59 得分:0<BR><BR>藏<BR><BR>Top<BR>回复人： 98130(Oracle) ( ) 信誉：100 2003-3-25 14:33:53 得分:0<BR><BR>回复人： fenlin(千里之行，始于足下......) ( ) 信誉：100&nbsp;&nbsp;2003-03-24 12:21:00&nbsp;&nbsp;得分:0 <BR><BR><BR>&nbsp;&nbsp;我也来凑热闹，呵呵......<BR>&lt;%<BR>'取出随机记录<BR>Randomize<BR>RNumber = Int(Rnd*200) + 1<BR>SQL = "SELECT * FROM Customers WHERE ID = " &amp; RNumber<BR>set objRec = ObjConn.Execute(SQL)<BR>Response.WriteRNumber &amp; " = " &amp; objRec("ID") &amp; " " &amp; objRec("c_email")<BR>%&gt;<BR>&nbsp;&nbsp;<BR><BR>这种方法存在bug,有可能取不出数据来，<BR>最好还是还<BR>select top 1 * from tablename order by newid()<BR><BR>Top<BR>回复人： hisi(海山) ( ) 信誉：100 2003-3-25 16:05:23 得分:0<BR><BR>收藏...<BR><BR>Top<BR>回复人： lyexcel(冰上飞人) ( ) 信誉：100 2003-3-25 16:36:58 得分:0<BR><BR>select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from GuestBook <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where 1=1 and Deleted = false <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; order by GuestID desc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>order by GuestID desc<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-25 18:37:44 得分:0<BR><BR>select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from GuestBook <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where 1=1 and Deleted = false <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; order by GuestID desc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>order by GuestID desc<BR>这可是一个经典的SQL.<BR>大概再加几层嵌套,查询引擎都可以崩溃了..<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-26 9:49:49 得分:0<BR><BR>昨天刚写的：<BR>update picture set IsUse='1' where instr(PicPath,'_1')&gt;0<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-26 11:53:51 得分:0<BR><BR>下面的语句不是精华.但是却是用很多用T-SQL进行开发的同志所不了解的..<BR>如何更新nText,Text,Image字段数据..<BR>DECLARE @ptrval binary(16)<BR>SELECT @ptrval = TEXTPTR(LSD_Comment) <BR>&nbsp;&nbsp; FROM Legal_Dispute WHERE LD_Record_No=25 --得到指定记录的nText文本指针<BR>UPDATETEXT Legal_Dispute.LSD_Comment @ptrval 0 0 N'Insert Text Content Into Old Content Before'&nbsp;&nbsp; ---将数据插入在老数据之前.<BR>很多同志在更新nText字段的时候使用一个记录集取回ASP然后一次性用"UPDATE set fieldname='" &amp; new content &amp; old content &amp; "'"的方式实现..<BR>却不知道,sql string一次只能提交的string是有限制的,这样一来,实际的text,ntext永远也不可能存储它所支持的最大长度的数据..也远远不能达到使用nText字段的目的了..<BR><BR>Top<BR>回复人： jtmoon(逍遥小贼) ( ) 信誉：234 2003-3-26 12:50:27 得分:0<BR><BR>呵呵，不错啊，收藏<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-26 17:49:24 得分:0<BR><BR>有好料快点贴，不久要揭贴喽!<BR><BR>Top<BR>回复人： chinahuman(枯) ( ) 信誉：105 2003-3-26 19:36:33 得分:0<BR><BR>高手们来看一看这个问题了http://expert.csdn.net/Expert/topic/1580/1580778.xml?temp=5.489528E-03<BR>在线等了！<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-26 21:12:14 得分:0<BR><BR>to 上面的兄弟<BR>SELECT * INTO [D:\database.mdb].table4 FROM [C:\database.mdb].table1<BR>前提是ASP用户对后者有读权限.<BR>前者有写权限<BR><BR>Top<BR>回复人： guiguai(鬼怪) ( ) 信誉：101 2003-3-26 22:09:06 得分:0<BR><BR>收藏！<BR><BR>Top<BR>回复人： wertou() ( ) 信誉：100 2003-3-27 10:55:30 得分:0<BR><BR>select * from studentinfo where not exists(select * from student where studentinfo.id=student.id) and 系名称='"&amp;strdepartmentname&amp;"' and 专业名称='"&amp;strprofessionname&amp;"' order by 性别,生源地,高考总成绩<BR><BR>Top<BR>回复人： Swanzy(志远) ( ) 信誉：100 2003-3-27 11:57:47 得分:0<BR><BR>请问查询时时有两行相同的记录，如何去掉一行？（其中包含TEXT数据类型）<BR>select&nbsp;&nbsp;brepeople,姓名,bbs_content.* from bbs_revert,bbs_content,bbs_userinfo where bauthor=职员id and brepeople='m043' and bbs_content.id=bid<BR>显示“我”参加的主题回复时，如果本主题回复了两次以上，那查询的结果将有两行以上的记录。<BR><BR>Top<BR>回复人： huangang(H.G) ( ) 信誉：100 2003-3-27 12:08:42 得分:0<BR><BR>select * form a like %keywords%<BR>模糊查询<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-27 12:20:43 得分:0<BR><BR>to Swanzy(志远) <BR>包含有text类型数据是无法进行消除重复值处理的..<BR>因为在sql server中text处理为一个指针..<BR>读取并比较该字段需要专用的语法<BR>如果要做,建议在存储过程中做或将该字段排除在比较条件外<BR><BR>Top<BR>回复人： 98130(Oracle) ( ) 信誉：100 2003-3-27 12:41:06 得分:0<BR><BR>select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select * from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 * <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from GuestBook <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where 1=1 and Deleted = false <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; order by GuestID desc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>&nbsp;&nbsp;&nbsp;&nbsp;order by GuestID asc) <BR>order by GuestID desc<BR>我怎么运行不了?<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-27 14:18:27 得分:0<BR><BR>to 98130(Oracle) <BR>下面的可以.但是好象看起来很没有必要<BR>select top 1 num1 from <BR>&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 num1 from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select top 1 num1 from <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select top 5 num1 <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from table1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order by num1 desc) as a<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order by num1 asc) as b<BR>&nbsp;&nbsp;&nbsp;&nbsp;order by num1 asc) as c<BR>order by num1 desc<BR><BR>Top<BR>回复人： tigerflyfly(小飞虎) ( ) 信誉：100 2003-3-27 21:20:40 得分:0<BR><BR>取出最先的是select top *&nbsp;&nbsp;from tablename<BR>取出最后的几条是什么？<BR><BR>Top<BR>回复人： clipper_clipper(clipper_clipper) ( ) 信誉：104 2003-3-27 21:46:59 得分:0<BR><BR>select count(*) from tb_tablename<BR>经常用的，取记录数<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-3-28 9:26:47 得分:0<BR><BR>t tigerflyfly(小飞虎)<BR>还是用select top,只是排序倒过来即可，比如：<BR>select top 10 * from tablename order by id desc<BR><BR>Top<BR>回复人： entice(踏雪寻梅) ( ) 信誉：106 2003-3-28 9:27:16 得分:0<BR><BR>to tigerflyfly(小飞虎)<BR>用排序呀。<BR><BR>Top<BR>回复人： xiaojiyi(小己乙) ( ) 信誉：100 2003-3-28 11:15:44 得分:0<BR><BR>分页语句<BR>select top 100 * from 表名 where id not in (select top page_no*100 * from 表名)<BR>page_no是程序中的变量<BR><BR>Top<BR>回复人： xiaoshi(js真痛苦!我要被炒了) ( ) 信誉：101 2003-3-28 11:42:47 得分:0<BR><BR>我收藏<BR>中午来看<BR><BR>Top<BR>回复人： alu_ok(冬瓜茶) ( ) 信誉：100 2003-3-28 13:16:31 得分:0<BR><BR>从数据库直接输出XML数据:<BR>select text1,text2 from table1 where text1 like '%alu_ok%' for xml auto<BR><BR>Top<BR>回复人： alu_ok(冬瓜茶) ( ) 信誉：100 2003-3-28 13:19:12 得分:0<BR><BR>UPDATE titles<BR>&nbsp;&nbsp;&nbsp;&nbsp;SET t.ytd_sales = t.ytd_sales + s.qty<BR>&nbsp;&nbsp;&nbsp;&nbsp;FROM titles t, sales s<BR>&nbsp;&nbsp;&nbsp;&nbsp;WHERE t.title_id = s.title_id<BR>&nbsp;&nbsp;&nbsp;&nbsp;AND s.ord_date = (SELECT MAX(sales.ord_date) FROM sales)<BR><BR>Top<BR>回复人： PeterMCT(天天下雨1991) ( ) 信誉：101 2003-3-28 13:21:02 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： alu_ok(冬瓜茶) ( ) 信誉：100 2003-3-28 13:21:07 得分:0<BR><BR>DELETE authors <BR>FROM (SELECT TOP 10 * FROM authors) AS t1<BR>WHERE authors.au_id = t1.au_id<BR><BR>Top<BR>回复人： alu_ok(冬瓜茶) ( ) 信誉：100 2003-3-28 13:22:26 得分:0<BR><BR>初始化表table1<BR>TRUNCATE TABLE table1<BR><BR>Top<BR>回复人： lxxlily(笨鸟先飞) ( ) 信誉：107 2003-3-28 13:31:43 得分:0<BR><BR>cnuninet(www.helloaspx.com) :晕～～<BR><BR>Top<BR>回复人： zhjzh_zjz(虚心学习，望多指教) ( ) 信誉：117 2003-3-28 15:11:57 得分:0<BR><BR>从入库信息表和入库清单表中得期初期末库存：<BR>SELECT a.mattype as mattype, a.matname as matname, a.spec as spec,a.indate as indate, a.amount AS lastnum, a.matsum AS lastsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.amount AS curnum, b.matsum AS cursum<BR>FROM (SELECT a.mattype, a.matname, a.spec, TO_CHAR(a.indate, 'yyyy-mm') AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(b.amount) AS amount, SUM(b.matsum) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype, a.matname, a.spec, a.indate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype = b.mattype (+) AND a.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname = b.matname (+) AND a.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec = b.spec (+) AND a.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.indate = b.outdate (+) AND a.indate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY a.mattype, a.matname, a.spec, a.indate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT b.mattype, b.matname, b.spec, b.outdate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype (+) = b.mattype AND b.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname (+) = b.matname AND b.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec (+) = b.spec AND b.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.indate (+) = b.outdate AND b.outdate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY b.mattype, b.matname, b.spec, b.outdate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT c.mattype, c.matname, c.spec, c.backdate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype (+) = c.mattype AND b.mattype (+) = c.mattype AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname (+) = c.matname AND c.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.spec = a.spec (+) AND c.spec = b.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.backdate = b.outdate (+) AND c.backdate = a.indate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY c.mattype, c.matname, c.spec, c.backdate) a,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT a.mattype, a.matname, a.spec, a.indate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype = b.mattype (+) AND a.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname = b.matname (+) AND a.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec = b.spec (+) AND a.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.indate = b.outdate (+) AND a.indate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY a.mattype, a.matname, a.spec, a.indate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT b.mattype, b.matname, b.spec, b.outdate AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUM(nvl(a.amount, 0) - NVL(b.amount, 0) + NVL(c.amount, 0)) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AS amount, SUM(nvl(a.matsum, 0) - NVL(b.matsum, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype (+) = b.mattype AND b.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname (+) = b.matname AND b.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec (+) = b.spec AND b.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.indate (+) = b.outdate AND b.outdate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY b.mattype, b.matname, b.spec, b.outdate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT c.mattype, c.matname, c.spec, c.backdate AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUM(nvl(a.amount, 0) - NVL(b.amount, 0) + NVL(c.amount, 0)) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AS amount, SUM(nvl(a.matsum, 0) - NVL(b.matsum, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype (+) = c.mattype AND b.mattype (+) = c.mattype AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname (+) = c.matname AND c.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.spec = a.spec (+) AND c.spec = b.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.backdate = b.outdate (+) AND c.backdate = a.indate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY c.mattype, c.matname, c.spec, c.backdate) b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE TO_CHAR(b.indate, 'yyyy-mm') &lt;= TO_CHAR(a.indate, 'yyyy-mm') AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.mattype = b.mattype (+) AND a.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec = b.spec (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY a.mattype, a.matname, a.spec, TO_CHAR(a.indate, 'yyyy-mm')) a,<BR>---未完，待续<BR><BR>Top<BR>回复人： zhjzh_zjz(虚心学习，望多指教) ( ) 信誉：117 2003-3-28 15:13:01 得分:0<BR><BR>---接上面<BR>&nbsp;&nbsp;(SELECT a.mattype, a.matname, a.spec, TO_CHAR(a.indate, 'yyyy-mm') AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUM(b.amount) AS amount, SUM(b.matsum) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype, a.matname, a.spec, a.indate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype = b.mattype (+) AND a.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname = b.matname (+) AND a.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec = b.spec (+) AND a.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.indate = b.outdate (+) AND a.indate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY a.mattype, a.matname, a.spec, a.indate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT b.mattype, b.matname, b.spec, b.outdate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype (+) = b.mattype AND b.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname (+) = b.matname AND b.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec (+) = b.spec AND b.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.indate (+) = b.outdate AND b.outdate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY b.mattype, b.matname, b.spec, b.outdate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SELECT c.mattype, c.matname, c.spec, c.backdate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, SUM(nvl(a.matsum, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE a.mattype (+) = c.mattype AND b.mattype (+) = c.mattype AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.matname (+) = c.matname AND c.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.spec = a.spec (+) AND c.spec = b.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.backdate = b.outdate (+) AND c.backdate = a.indate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY c.mattype, c.matname, c.spec, c.backdate) a,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SELECT a.mattype, a.matname, a.spec, a.indate, SUM(nvl(a.amount, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- NVL(b.amount, 0) + NVL(c.amount, 0)) AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(nvl(a.matsum, 0) - NVL(b.matsum, 0) + NVL(c.matsum, 0)) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype = b.mattype (+) AND a.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname = b.matname (+) AND a.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec = b.spec (+) AND a.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.indate = b.outdate (+) AND a.indate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY a.mattype, a.matname, a.spec, a.indate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT b.mattype, b.matname, b.spec, b.outdate AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(nvl(a.amount, 0) - NVL(b.amount, 0) + NVL(c.amount, 0)) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS amount, SUM(nvl(a.matsum, 0) - NVL(b.matsum, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype (+) = b.mattype AND b.mattype = c.mattype (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname (+) = b.matname AND b.matname = c.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec (+) = b.spec AND b.spec = c.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.indate (+) = b.outdate AND b.outdate = c.backdate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY b.mattype, b.matname, b.spec, b.outdate<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNION<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT c.mattype, c.matname, c.spec, c.backdate AS indate, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(nvl(a.amount, 0) - NVL(b.amount, 0) + NVL(c.amount, 0)) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AS amount, SUM(nvl(a.matsum, 0) - NVL(b.matsum, 0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ NVL(c.matsum, 0)) AS matsum<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM (SELECT a.mattype AS mattype, a.matname AS matname, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec AS spec, b.indate AS indate, a.amount AS amount, <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matsum AS matsum, b.matsource AS matsource<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM materialin a, matin b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE b.serial = a.serial) a, matuse b, matback c<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.mattype (+) = c.mattype AND b.mattype (+) = c.mattype AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.matname (+) = c.matname AND c.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.spec = a.spec (+) AND c.spec = b.spec (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c.backdate = b.outdate (+) AND c.backdate = a.indate (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY c.mattype, c.matname, c.spec, c.backdate) b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE TO_CHAR(b.indate, 'yyyy-mm') &lt;= TO_CHAR(a.indate, 'yyyy-mm') AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.mattype = b.mattype (+) AND a.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.spec = b.spec (+)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GROUP BY a.mattype, a.matname, a.spec, TO_CHAR(a.indate, 'yyyy-mm')) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b<BR>WHERE a.mattype = b.mattype (+) AND a.matname = b.matname (+) AND <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.spec = b.spec (+) AND TO_DATE(a.indate, 'yyyy-mm') <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= ADD_MONTHS(TO_DATE(b.indate, 'yyyy-mm'), 1)<BR>--语句完毕<BR><BR>Top<BR>回复人： zhjzh_zjz(虚心学习，望多指教) ( ) 信誉：117 2003-3-28 15:15:27 得分:0<BR><BR>上面用的是Oracle数据库。由于涉及到双向外连接，所以很长<BR><BR>Top<BR>回复人： zhongjz(小海螺) ( ) 信誉：105 2003-3-28 15:46:39 得分:5<BR><BR>从数据库中去一年的各单位电话费统计（电话费定额贺电化肥清单两个表来源）<BR>SELECT a.userper, a.tel, a.standfee, TO_CHAR(a.telfeedate, 'yyyy') AS telyear,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '01', a.factration)) AS JAN,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '02', a.factration)) AS FRI,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '03', a.factration)) AS MAR,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '04', a.factration)) AS APR,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '05', a.factration)) AS MAY,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '06', a.factration)) AS JUE,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '07', a.factration)) AS JUL,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '08', a.factration)) AS AGU,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '09', a.factration)) AS SEP,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '10', a.factration)) AS OCT,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '11', a.factration)) AS NOV,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUM(decode(TO_CHAR(a.telfeedate, 'mm'), '12', a.factration)) AS DEC<BR>FROM (SELECT a.userper, a.tel, a.standfee, b.telfeedate, b.factration<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM TELFEESTAND a, TELFEE b<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE a.tel = b.telfax) a<BR>GROUP BY a.userper, a.tel, a.standfee, TO_CHAR(a.telfeedate, 'yyyy')<BR><BR>Top<BR>回复人： zzlcn() ( ) 信誉：86 2003-3-28 17:24:15 得分:0<BR><BR>请问如果有 10 万 条数据 该怎么查询，我一查询就出错<BR>如果是3万条还可以接受，但是到了3万条以上就不稳定！<BR>我用了 sqlserver 也没有用<BR>10 万条数据来一次分页显示居然要 10-15秒的超长时间！！！！！<BR>如果在分页显示中查询，立即告吹！！！<BR>asp 和 asp.net 我都试用过（＋ ms sqlserver）<BR>均是如此<BR>是不是 asp 和 asp.net 都是垃圾中的垃圾！！！<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-28 17:40:16 得分:0<BR><BR>大量复杂的数据分析,在结构设计上就应该要考虑进去.适当设置一些字段或表存储分段统计信息.<BR>否则再好的数据库都撑不住的..<BR><BR>Top<BR>回复人： sishuo(思铄) ( ) 信誉：100 2003-3-29 9:39:01 得分:0<BR><BR>好，收了。<BR><BR>Top<BR>回复人： huijunzi(Cyril) ( ) 信誉：97 2003-3-30 16:49:18 得分:5<BR><BR>有意思,我也来一个，解决跳号的问题：<BR>select min(bh)+1 from Table1 where bh+1 not in(select bh from Table1)<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-3-31 9:50:13 得分:0<BR><BR>进行复杂数据分析还有一种趋势那就是使用数据仓库(Data Houseware)和OLAP.<BR><BR>Top<BR>回复人： bkss(白开水水) ( ) 信誉：100 2003-4-1 11:09:20 得分:0<BR><BR>哈哈，我也来凑热闹。。。<BR>DECLARE @QuitMedNo char(13) <BR>DECLARE @PreRecipeNo char(13),@PreRecipeXNo char(3) <BR>Declare @zyxh char(12),@kdks char(8) <BR>DECLARE @DepotName char(10) <BR>BEGIN TRAN <BR>if not exists(select 摆药单号 from&nbsp;&nbsp;摆药单 where 状态='00' and 摆药单号=@PutMedNo)<BR>begin<BR>&nbsp;&nbsp;return 0<BR>end<BR>EXECUTE Sp_GetBillNo @QuitMedNo output,'D' <BR>INSERT INTO [退药]([退药序号], [操作员], [退药时间], [退药说明]) <BR>&nbsp;&nbsp;&nbsp;&nbsp; VALUES(@QuitMedNo,@Operator,cast(getdate() as smalldatetime),@Intro) <BR>if (@@error&lt;&gt;0 or @@rowcount=0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;begin <BR>&nbsp;&nbsp;rollback transaction<BR>&nbsp;&nbsp;raiserror('插入退药表失败',16,-1)<BR>&nbsp;&nbsp;return 1 <BR>&nbsp;&nbsp;&nbsp;&nbsp;end<BR>DECLARE PutMed_Cursor CURSOR FOR<BR>SELECT DISTINCT A.处方号,A.处方序号,B.住院序号,B.科室,C.名称 as 摆药区 FROM 摆药单明细 A inner join 处方 B ON A.处方号 =B.处方号 AND A.处方序号=B.处方序号 <BR>INNER JOIN 摆药区 C ON B.摆药区=C.代码 WHERE A.摆药单号=@PutMedNo <BR>OPEN PutMed_Cursor<BR>FETCH NEXT FROM PutMed_Cursor INTO @PreRecipeNo, @PreRecipeXNo,@zyxh,@kdks,@DepotName<BR>WHILE @@FETCH_STATUS = 0<BR>BEGIN<BR>EXEC usp_QuitBillDetail @QuitMedNo ,@PutMedNo,@PreRecipeNo,@PreRecipeXNo,@zyxh,@kdks,@fsks,@DepotName<BR>--另一个存储过程<BR>if (@@error&lt;&gt;0) <BR>&nbsp;&nbsp;&nbsp;&nbsp;begin <BR>&nbsp;&nbsp;rollback transaction<BR>&nbsp;&nbsp;CLOSE PutMed_Cursor<BR>&nbsp;&nbsp;--DEALLOCATE PutMed_Cursor<BR>&nbsp;&nbsp;raiserror('更新退单处方明细失败',16,-1)<BR>&nbsp;&nbsp;return 1 <BR>&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;FETCH NEXT FROM PutMed_Cursor INTO @PreRecipeNo, @PreRecipeXNo,@zyxh,@kdks<BR>END<BR><BR>Top<BR>回复人： bkss(白开水水) ( ) 信誉：100 2003-4-1 11:21:36 得分:10<BR><BR>个人认为，偶写了这么久的SQL，只说语法很无聊，语句的涵义与灵活的组合很重要，下面这个是写的一个药品管理的存储过程的一句，很经典：<BR>UPDATE 药房库存 SET 库存数量=库存数量-B.用量 FROM [药房库存] A ,<BR>( Select sum(用量) as 用量,药品价码 FROM 处方项 <BR>&nbsp;&nbsp;&nbsp;&nbsp;WHERE 处方号=@RecipeNo AND 处方序号=@RecipeXNo <BR>&nbsp;&nbsp;GROUP BY 药品价码<BR>) B&nbsp;&nbsp;WHERE A.药品价码=B.药品价码 AND A.库房名称=@DepotName<BR>这是一个参照B表将A表中库存一一修改，而B表中存在一个求和，A表也与B表关联，同时要满足A表条件。<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-4-1 11:26:50 得分:0<BR><BR>是的..SQL中应用的经典应该只考虑SQL查询的应用..<BR>存储过程已经使用控制语法操作了,和别的程序设计语言设计算法没什么区别..<BR><BR>Top<BR>回复人： yexiao(叶开) ( ) 信誉：100 2003-4-1 14:11:35 得分:0<BR><BR>gz<BR><BR>Top<BR>回复人： rong451(rong451) ( ) 信誉：100 2003-4-1 15:43:10 得分:0<BR><BR>very good 我一定收藏！！！<BR><BR>Top<BR>回复人： gengwei80(gengwei) ( ) 信誉：99 2003-4-2 9:40:27 得分:0<BR><BR>create or replace procedure p_table<BR>(<BR>p_g3e_fno g3e_features_optable.g3e_fno%type<BR>)<BR>as<BR>v_xlmc VARCHAR2(12);<BR>v_XLDM VARCHAR2(5);<BR>cursor c_table IS<BR>select g3e_table from g3e_component where g3e_cno=(select g3e_primaryattributecno<BR>&nbsp;&nbsp;from g3e_features_optable where g3e_fno=p_g3e_fno);<BR>type t_sor is ref cursor;<BR>v_sor t_sor;<BR>str varchar2(50);<BR>begin<BR>&nbsp;&nbsp;for v_table in&nbsp;&nbsp;c_table&nbsp;&nbsp;loop<BR>&nbsp;&nbsp; str:='select xlmc,xldm from '||v_table.g3e_table;<BR>&nbsp;&nbsp;&nbsp;&nbsp;dbms_output.put_line(v_table.g3e_table);<BR>&nbsp;&nbsp; open v_sor for str;<BR>&nbsp;&nbsp; loop<BR>&nbsp;&nbsp; fetch v_sor into v_xlmc,v_xldm;<BR>&nbsp;&nbsp;&nbsp;&nbsp;dbms_output.put_line('hello g3e_table');<BR>&nbsp;&nbsp;&nbsp;&nbsp;dbms_output.put_line(v_xlmc||' '||v_xldm);<BR>&nbsp;&nbsp; exit when v_sor%notfound;<BR>&nbsp;&nbsp; end loop;<BR>&nbsp;&nbsp; close v_sor;<BR>&nbsp;&nbsp;end loop;<BR>end p_table;<BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3743#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3744'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:18:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>Top<BR>回复人： bloodsha(huangxi) ( ) 信誉：98 2003-4-3 8:58:06 得分:0<BR><BR>学<BR><BR>Top<BR>回复人： csdntoll(低调惯了) ( ) 信誉：147 2003-4-3 11:40:16 得分:0<BR><BR>回复人： csdntoll(toll) ( ) 信誉：100&nbsp;&nbsp;2003-3-21 10:02:00&nbsp;&nbsp;得分:0 <BR>&nbsp;&nbsp;<BR>我决定：把200分中的180分，奖给贴出最精妙的SQL的高手！<BR>-------------------------------------------------------------------<BR>想揭贴，可是为难了：<BR>我要遵守自己说过的话（如上），可我菜，鉴别能力有限，怎么办？<BR><BR>Top<BR>回复人： wilsonGao(笑傲江湖) ( ) 信誉：101 2003-4-3 13:29:11 得分:0<BR><BR>如何用一句语句实现两个表的关键字倒换？<BR><BR>Top<BR>回复人： pyz8000(黑洞) ( ) 信誉：101 2003-4-3 18:48:04 得分:0<BR><BR>晕倒，，，收藏～～<BR><BR>Top<BR>回复人： chinahuman(枯) ( ) 信誉：105 2003-4-3 18:50:07 得分:0<BR><BR>有没有办法一条语句实现以下功能：比如一个新闻系统里有很多个管理员，在添加过程中每条都记录管理员的ID，现想根据用户ID来实现统计它们添加的条数？<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-4-3 19:29:42 得分:0<BR><BR>to&nbsp;&nbsp;chinahuman(枯) <BR>一个group by和一个聚合函数(count)就可以了..<BR>select count(Title) from news group by creade_by<BR>如果需要得到除非聚合字段外的详细信息那么就得使用相关子查询了..<BR><BR>Top<BR>回复人： ld_key(什么名字也想) ( ) 信誉：100 2003-4-4 9:59:55 得分:0<BR><BR>markable<BR><BR>Top<BR>回复人： superdullwolf(超级大笨狼) ( ) 信誉：99 2003-4-4 22:04:45 得分:0<BR><BR>看我的，四表联查问题：<BR>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c&nbsp;&nbsp;inner join d on a.a=d.d where .....<BR><BR>Top<BR>回复人： superdullwolf(超级大笨狼) ( ) 信誉：99 2003-4-4 22:11:39 得分:10<BR><BR>应聘做了一个小程序,在多人中表现最好,高兴,散分100!!是关于sql查询显示的<BR>题目大概是SQL&nbsp;&nbsp;&nbsp;&nbsp; 表1：班级/老师&nbsp;&nbsp;&nbsp;&nbsp;表2学生/班级&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表三数学/学生&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表4语文/学生<BR>查询显示结果大概是这样：<BR>班级1&nbsp;&nbsp;老师1<BR>学生1&nbsp;&nbsp; 数学&nbsp;&nbsp;语文<BR>学生2&nbsp;&nbsp; 数学&nbsp;&nbsp;语文<BR>班级2&nbsp;&nbsp;老师1<BR>学生1&nbsp;&nbsp; 数学&nbsp;&nbsp;语文<BR>学生2&nbsp;&nbsp; 数学&nbsp;&nbsp;语文<BR>不及格：<BR>学生1&nbsp;&nbsp; 班级1 老师1&nbsp;&nbsp;数学&nbsp;&nbsp;语文 <BR>学生1&nbsp;&nbsp; 班级1 老师1&nbsp;&nbsp;数学&nbsp;&nbsp;语文<BR>还有录入学生和成绩的界面<BR>用到了多表之间的inner join&nbsp;&nbsp;on 语句，而且我显示的很漂亮，靠，做了一下午，我好想抽烟啊，当时：）<BR>看我的，四表联查问题：<BR>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c&nbsp;&nbsp;inner join d on a.a=d.d where .....<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-4-7 9:43:55 得分:0<BR><BR>左连接右连接内连接全部上马,的确经典哦.<BR>据说你写过上万行代码,大概这就是最经典的一段代码了吧.<BR><BR>Top<BR>回复人： zady(森林木) ( ) 信誉：100 2003-4-7 14:56:01 得分:5<BR><BR>需求：<BR>得到表中最小的未使用的ID号。<BR>例：<BR>table Name:Handle<BR>HandleID<BR>--------<BR>1<BR>2<BR>5<BR>6<BR>7<BR>--5 Records<BR>执行结果须为3<BR>解决：<BR>SELECT (CASE WHEN EXISTS(SELECT * FROM Handle b WHERE b.HandleID = 1) THEN MIN(HandleID) + 1 ELSE 1 END) as HandleID<BR>FROM&nbsp;&nbsp;Handle<BR>WHERE NOT HandleID IN (SELECT a.HandleID - 1 FROM Handle a)<BR><BR>Top<BR>回复人： Iamfish(呆鱼) ( ) 信誉：105 2003-4-8 13:36:00 得分:80<BR><BR>两台SQL服务器上的一个数据表同步!<BR>drop procedure dbSync<BR>GO<BR>/*&nbsp;&nbsp;&nbsp;&nbsp; 数据同步&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<BR>CREATE PROCEDURE dbSync <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @sTabelName&nbsp;&nbsp;varchar(255),&nbsp;&nbsp;&nbsp;&nbsp;--要同步的表名<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @sKeyField&nbsp;&nbsp; varchar(255),&nbsp;&nbsp;&nbsp;&nbsp;--关键字段<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @sServer&nbsp;&nbsp;&nbsp;&nbsp; varchar(255),&nbsp;&nbsp;&nbsp;&nbsp;--服务器名称或IP<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @sUserName&nbsp;&nbsp; varchar(255),&nbsp;&nbsp;&nbsp;&nbsp;--登录到服务器的用户名，一般为sa<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @sPassWord&nbsp;&nbsp; varchar(32)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--用户登录到服务器的密码 <BR>AS<BR>&nbsp;&nbsp; /*删除临时表*/<BR>&nbsp;&nbsp;if exists (select * from dbo.sysobjects where id = object_id(N'tempTbl') and OBJECTPROPERTY(id, N'IsUserTable') = 1)<BR>&nbsp;&nbsp;drop table tempTbl<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;declare @sql VARCHAR(2000) <BR>&nbsp;&nbsp;/*把表@sTabelName[远程]的数据拷贝到临时表*/<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp;set @sql='select * into tempTbl from '<BR>&nbsp;&nbsp;set @sql=@sql + ' OPENDATASOURCE( '<BR>&nbsp;&nbsp;set @sql=@sql + '''SQLOLEDB.1'','<BR>&nbsp;&nbsp;set @sql=@sql + '''Persist Security Info=True;User ID=' + @sUserName<BR>&nbsp;&nbsp;set @sql=@sql + ';Password=' + @sPassWord<BR>&nbsp;&nbsp;set @sql=@sql + ';Initial Catalog=toys;Data Source=' + @sServer<BR>&nbsp;&nbsp;set @sql=@sql + ''').toys.dbo.'+@sTabelName<BR>&nbsp;&nbsp;EXEC(@sql)&nbsp;&nbsp;<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;/* 把@sTabelName[本地]中的@sTabelName[远程]表中没有的数据插入到临时表中*/<BR>&nbsp;&nbsp;set @sql='insert into tempTbl select * from '+@sTabelName+' where ['+@sKeyField+'] not in (select ['+@sKeyField+'] from tempTbl)'<BR>&nbsp;&nbsp;EXEC(@sql)<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;/*清空表@sTabelName[本地]*/<BR>&nbsp;&nbsp;set @sql='truncate table '+@sTabelName<BR>&nbsp;&nbsp;EXEC(@sql)<BR>&nbsp;&nbsp;<BR>&nbsp;&nbsp;--取得列名<BR>&nbsp;&nbsp;declare @MySql VARCHAR(2000)<BR>&nbsp;&nbsp;set @MySql=''<BR>&nbsp;&nbsp;declare @title varchar(20)<BR>&nbsp;&nbsp;DECLARE titles_cursor CURSOR FOR <BR>&nbsp;&nbsp;SELECT name from syscolumns where id=object_id(@sTabelName)<BR>&nbsp;&nbsp;OPEN titles_cursor<BR>&nbsp;&nbsp;FETCH NEXT FROM titles_cursor INTO @title<BR>&nbsp;&nbsp;WHILE @@FETCH_STATUS = 0<BR>&nbsp;&nbsp;BEGIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;if @title&lt;&gt;'id' <BR>&nbsp;&nbsp;&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if @MySql = ''<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set @MySql = @MySql + @title<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set @MySql = @MySql + ',' + @title<BR>&nbsp;&nbsp;&nbsp;&nbsp;end<BR>&nbsp;&nbsp;&nbsp;&nbsp;FETCH NEXT FROM titles_cursor INTO @title<BR>&nbsp;&nbsp;END<BR>&nbsp;&nbsp;CLOSE titles_cursor<BR>&nbsp;&nbsp;DEALLOCATE titles_cursor<BR>&nbsp;&nbsp;--取列名结束<BR>&nbsp;&nbsp;/*把临时表的内容插入到表@sTabelName[本地]*/<BR>&nbsp;&nbsp;set @sql='insert into '+@sTabelName+' select '+@MySql+' from tempTbl'<BR>&nbsp;&nbsp;EXEC(@sql) <BR>&nbsp;&nbsp;/*删除临时表*/<BR>&nbsp;&nbsp;if exists (select * from dbo.sysobjects where id = object_id(N'tempTbl') and OBJECTPROPERTY(id, N'IsUserTable') = 1)<BR>&nbsp;&nbsp;drop table tempTbl<BR>GO<BR><BR>Top<BR>回复人： lizongqi(英雄啊) ( ) 信誉：100 2003-4-8 15:02:07 得分:0<BR><BR>收藏ing..<BR><BR>Top<BR>回复人： Swanzy(志远) ( ) 信誉：100 2003-4-8 18:06:08 得分:0<BR><BR>收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏收藏<BR><BR>Top<BR>回复人： zhyx21century(zhyx) ( ) 信誉：100 2003-4-9 11:19:17 得分:0<BR><BR>UP<BR><BR>Top<BR>回复人： kingkout(kingkout) ( ) 信誉：100 2003-4-9 14:05:22 得分:0<BR><BR>GZ<BR><BR>Top<BR>回复人： xxl0914(microlin) ( ) 信誉：105 2003-4-9 14:23:49 得分:0<BR><BR>用sql语句对不同的几张表做笛卡尔积<BR><BR>Top<BR>回复人： lizongqi(英雄啊) ( ) 信誉：100 2003-4-10 10:44:56 得分:0<BR><BR>收藏ing....<BR><BR>Top<BR>回复人： xieyj(快乐天使) ( ) 信誉：103 2003-4-11 8:36:16 得分:5<BR><BR>查找一个已知字段所在的表名：<BR>Select Name From Sysobjects Where Id in (select id from syscolumns where name='字段名')<BR><BR>Top<BR>回复人： leeeel(三角比三星差？) ( ) 信誉：100 2003-4-11 8:55:15 得分:0<BR><BR>强列地反对多个　Select 套在一个语句中使用　！<BR><BR>Top<BR>回复人： zhaoming1112(随风往事) ( ) 信誉：100 2003-4-11 11:44:58 得分:0<BR><BR>SELECT套在一起，好用，我不反对。<BR><BR>Top<BR>回复人： csdnshao(如水人生) ( ) 信誉：105 2003-4-11 11:50:17 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： cuoban(搓板) ( ) 信誉：100 2003-4-11 14:57:58 得分:5<BR><BR>前些日子刚写的<BR>说明：进行判断，得出两种应纳税额。<BR>SELECT 姓名, BM AS 部门, SF1 AS 实发, SFZH AS 身份证, Jjje AS 奖金, SF1 + Jjje - 860 AS 应纳所得, XL AS 学历, NTG AS 性别, GWW AS 职务, round((CASE WHEN (SF1 + Jjje - 860 &lt; 500) THEN (SF1 + Jjje - 860) * 0.05 ELSE CASE WHEN (SF1 + Jjje - 860 &gt; 500) THEN (SF1 + GJJ - 860) * 0.10 - 25 END END), 2) AS 应纳税额 FROM GZ20029 WHERE (sf1 + Jjje) &gt; 860<BR><BR>Top<BR>回复人： lanyd(山雨欲来风满楼) ( ) 信誉：100 2003-4-11 16:13:44 得分:0<BR><BR>强！<BR>看完这些，我也成sql专家了，哈哈<BR><BR>Top<BR>回复人： 750906(750906) ( ) 信誉：105 2003-4-11 16:29:33 得分:0<BR><BR>SELECT A.*, B.ColumnString AS ColumnString,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SELECT COUNT(StatuteId)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM StatuteLib_Body<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE ColumnId IN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (SELECT ColumnId<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM StatuteLib_ColumnString<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE ColumnString LIKE B.ColumnString + '%')) AS StatuteCount<BR>FROM cw25109.StatuteLib_Column A INNER JOIN<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cw25109.StatuteLib_ColumnString B ON A.ColumnId = B.ColumnId<BR><BR>Top<BR>回复人： Swanzy(志远) ( ) 信誉：100 2003-4-12 11:04:11 得分:0<BR><BR>如何查询表中为空值的所有字段内容？<BR><BR>Top<BR>回复人： xdk(冼德锟) ( ) 信誉：97 2003-4-12 11:37:01 得分:0<BR><BR>好...我是来抢分加收藏的...<BR><BR>Top<BR>回复人： yu_shi_bin(清风) ( ) 信誉：100 2003-4-14 13:13:18 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： sohi(阿梓) ( ) 信誉：100 2003-4-15 8:20:17 得分:0<BR><BR>good<BR><BR>Top<BR>回复人： laker_tmj(laker) ( ) 信誉：100 2003-4-15 12:22:45 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： cboy2003(三碗（cpubook.com)) ( ) 信誉：100 2003-4-15 12:26:13 得分:0<BR><BR>不错<BR>全部收了，我把常用的，最最普通的贴出来大家看看吧，我是对上面的某些半知，对自己贴的<BR>还能用用，哈哈<BR>SQL常用命令使用方法： <BR>(1) 数据记录筛选： <BR>sql="select * from 数据表 where 字段名=字段值 order by 字段名 [desc]" <BR>sql="select * from 数据表 where 字段名 like '%字段值%' order by 字段名 [desc]" <BR>sql="select top 10 * from 数据表 where 字段名 order by 字段名 [desc]" <BR>sql="select * from 数据表 where 字段名 in ('值1','值2','值3')" <BR>sql="select * from 数据表 where 字段名 between 值1 and 值2" <BR>(2) 更新数据记录： <BR>sql="update 数据表 set 字段名=字段值 where 条件表达式" <BR>sql="update 数据表 set 字段1=值1,字段2=值2 …… 字段n=值n where 条件表达式" <BR>(3) 删除数据记录： <BR>sql="delete from 数据表 where 条件表达式" <BR>sql="delete from 数据表" (将数据表所有记录删除) <BR>(4) 添加数据记录： <BR>sql="insert into 数据表 (字段1,字段2,字段3 …) valuess (值1,值2,值3 …)" <BR>sql="insert into 目标数据表 select * from 源数据表" (把源数据表的记录添加到目标数据表) <BR>(5) 数据记录统计函数： <BR>AVG(字段名) 得出一个表格栏平均值 <BR>COUNT(*|字段名) 对数据行数的统计或对某一栏有值的数据行数统计 <BR>MAX(字段名) 取得一个表格栏最大的值 <BR>MIN(字段名) 取得一个表格栏最小的值 <BR>SUM(字段名) 把数据栏的值相加 <BR>引用以上函数的方法： <BR>sql="select sum(字段名) as 别名 from 数据表 where 条件表达式" <BR>set rs=conn.excute(sql) <BR>用 rs("别名") 获取统的计值，其它函数运用同上。 <BR>(5) 数据表的建立和删除： <BR>CREATE TABLE 数据表名称(字段1 类型1(长度),字段2 类型2(长度) …… ) <BR>例：CREATE TABLE tab01(name varchar(50),datetime default now()) <BR>DROP TABLE 数据表名称 (永久性删除一个数据表) <BR><BR>Top<BR>回复人： zigzag81814() ( ) 信誉：100 2003-4-15 13:09:38 得分:0<BR><BR>好<BR><BR>Top<BR>回复人： skyswan(施望) ( ) 信誉：100 2003-4-15 13:33:36 得分:0<BR><BR>怎么都是用在Sql Server上的。<BR>有好多是不能用在Oracle的PL/SQL上的<BR><BR>Top<BR>回复人： cboy2003(三碗（cpubook.com)) ( ) 信誉：100 2003-4-15 14:30:18 得分:0<BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3744#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>SQL语法参考手册&nbsp;<a name='3745'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:19:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>SQL语法参考手册 <BR>2001年3月22日 <BR>DB2 提供了关连式资料库的查询语言 ＳＱＬ (Structured Query Language)，是一种非常口语化、既易学又易懂的语法。此一语言几乎是每个资料库系统都必须提供的，用以表示关连式的操作，包含了资料的定义（ＤＤＬ）以及资料的处理（ＤＭＬ）。SQL原来拼成SEQUEL，这语言的原型以"系统 R"的名字在 IBM 圣荷西实验室完成，经过IBM内部及其他的许多使用性及效率测试，其结果相当令人满意，并决定在系统R 的技术基础发展出来 IBM 的产品。而且美国国家标准学会（ANSI）及国际标准化组织（ISO）在1987遵循一个几乎是以 IBM SQL 为基础的标准关连式资料语言定义。<BR>一、资料定义 ＤＤＬ（Data Definition Language) <BR>资料定语言是指对资料的格式和形态下定义的语言，他是每个资料库要建立时候时首先要面对的，举凡资料分哪些表格关系、表格内的有什麽栏位主键、表格和表格之间互相参考的关系等等，都是在开始的时候所必须规划好的。<BR>１、建表格：<BR>CREATE TABLE table_name( <BR>column1 DATATYPE [NOT NULL] [NOT NULL PRIMARY KEY], <BR>column2 DATATYPE [NOT NULL],<BR>...）<BR>说明：　<BR>DATATYPE --是资料的格式，详见表。<BR>NUT NULL --可不可以允许资料有空的（尚未有资料填入）。<BR>PRIMARY KEY --是本表的主键。<BR>２、更改表格　<BR>ALTER TABLE table_name <BR>ADD COLUMN column_name DATATYPE <BR>说明：增加一个栏位（没有删除某个栏位的语法。<BR>ALTER TABLE table_name<BR>ADD PRIMARY KEY (column_name)<BR>说明：更改表得的定义把某个栏位设为主键。<BR>ALTER TABLE table_name<BR>DROP PRIMARY KEY (column_name)<BR>说明：把主键的定义删除。<BR>３、建立索引　<BR>CREATE INDEX index_name ON table_name (column_name)<BR>说明：对某个表格的栏位建立索引以增加查询时的速度。<BR>４、删除　<BR>DROP table_name<BR>DROP index_name<BR>二、的资料形态 DATATYPEs<BR>smallint<BR>16 位元的整数。<BR>interger<BR>32 位元的整数。<BR>decimal(p,s)<BR>p 精确值和 s 大小的十进位整数，精确值p是指全部有几个数(digits)大小值，s是指小数<BR>点後有几位数。如果没有特别指定，则系统会设为 p=5; s=0 。 <BR>float<BR>32位元的实数。<BR>double<BR>64位元的实数。<BR>char(n)<BR>n 长度的字串，n不能超过 254。<BR>varchar(n)<BR>长度不固定且其最大长度为 n 的字串，n不能超过 4000。<BR>graphic(n)<BR>和 char(n) 一样，不过其单位是两个字元 double-bytes， n不能超过127。这个形态是为<BR>了支援两个字元长度的字体，例如中文字。<BR>vargraphic(n)<BR>可变长度且其最大长度为 n 的双字元字串，n不能超过 2000。<BR>date<BR>包含了 年份、月份、日期。<BR>time<BR>包含了 小时、分钟、秒。<BR>timestamp<BR>包含了 年、月、日、时、分、秒、千分之一秒。<BR>三、资料操作 ＤＭＬ （Data Manipulation Language)<BR>资料定义好之後接下来的就是资料的操作。资料的操作不外乎增加资料（insert)、查询资料（query）、更改资料（update) 、删除资料（delete）四种模式，以下分 别介绍他们的语法：<BR>１、增加资料：<BR>INSERT INTO table_name (column1,column2,...)<BR>VALUES ( value1,value2, ...)<BR>说明：<BR>1.若没有指定column 系统则会按表格内的栏位顺序填入资料。<BR>2.栏位的资料形态和所填入的资料必须吻合。<BR>3.table_name 也可以是景观 view_name。<BR>INSERT INTO table_name (column1,column2,...)<BR>SELECT columnx,columny,... FROM another_table<BR>说明：也可以经过一个子查询（subquery）把别的表格的资料填入。<BR>２、查询资料：<BR>基本查询<BR>SELECT column1,columns2,...<BR>FROM table_name<BR>说明：把table_name 的特定栏位资料全部列出来<BR>SELECT *<BR>FROM table_name<BR>WHERE column1 = xxx <BR>[AND column2 &gt; yyy] [OR column3 &lt;&gt; zzz]<BR>说明：<BR>1.'*'表示全部的栏位都列出来。<BR>2.WHERE 之後是接条件式，把符合条件的资料列出来。<BR>SELECT column1,column2<BR>FROM table_name<BR>ORDER BY column2 [DESC]<BR>说明：ORDER BY 是指定以某个栏位做排序，[DESC]是指从大到小排列，若没有指明，则是从小到大<BR>排列<BR>组合查询<BR>组合查询是指所查询得资料来源并不只有单一的表格，而是联合一个以上的<BR>表格才能够得到结果的。<BR>SELECT *<BR>FROM table1,table2<BR>WHERE table1.colum1=table2.column1<BR>说明：<BR>1.查询两个表格中其中 column1 值相同的资料。<BR>2.当然两个表格相互比较的栏位，其资料形态必须相同。<BR>3.一个复杂的查询其动用到的表格可能会很多个。<BR>整合性的查询：<BR>SELECT COUNT (*) <BR>FROM table_name<BR>WHERE column_name = xxx<BR>说明：<BR>查询符合条件的资料共有几笔。<BR>SELECT SUM(column1)<BR>FROM table_name<BR>说明：<BR>1.计算出总和，所选的栏位必须是可数的数字形态。<BR>2.除此以外还有 AVG() 是计算平均、MAX()、MIN()计算最大最小值的整合性查询。<BR>SELECT column1,AVG(column2)<BR>FROM table_name<BR>GROUP BY column1<BR>HAVING AVG(column2) &gt; xxx<BR>说明：<BR>1.GROUP BY: 以column1 为一组计算 column2 的平均值必须和 AVG、SUM等整合性查询的关键字<BR>一起使用。 <BR>2.HAVING : 必须和 GROUP BY 一起使用作为整合性的限制。<BR>复合性的查询<BR>SELECT *<BR>FROM table_name1<BR>WHERE EXISTS (<BR>SELECT *<BR>FROM table_name2<BR>WHERE conditions )<BR>说明：<BR>1.WHERE 的 conditions 可以是另外一个的 query。<BR>2.EXISTS 在此是指存在与否。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 IN (<BR>SELECT column1 <BR>FROM table_name2<BR>WHERE conditions )<BR>说明：　<BR>1. IN 後面接的是一个集合，表示column1 存在集合里面。<BR>2. SELECT 出来的资料形态必须符合 column1。 <BR>其他查询<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 LIKE 'x%' <BR>说明：LIKE 必须和後面的'x%' 相呼应表示以 x为开头的字串。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 IN ('xxx','yyy',..)<BR>说明：IN 後面接的是一个集合，表示column1 存在集合里面。<BR>SELECT *<BR>FROM table_name1<BR>WHERE column1 BETWEEN xx AND yy<BR>说明：BETWEEN 表示 column1 的值介於 xx 和 yy 之间。 <BR>３、更改资料：<BR>UPDATE table_name<BR>SET column1='xxx'<BR>WHERE conditoins<BR>说明：<BR>1.更改某个栏位设定其值为'xxx'。<BR>2.conditions 是所要符合的条件、若没有 WHERE 则整个 table 的那个栏位都会全部被更改。<BR>４、删除资料：<BR>DELETE FROM table_name<BR>WHERE conditions<BR>说明：删除符合条件的资料。<BR>说明：关于WHERE条件后面如果包含有日期的比较，不同数据库有不同的表达式。具体如下：<BR>(1)如果是ACCESS数据库，则为：WHERE mydate&gt;#2000-01-01# <BR>(2)如果是ORACLE数据库，则为：WHERE mydate&gt;cast('2000-01-01' as date)<BR>或：WHERE mydate&gt;to_date('2000-01-01','yyyy-mm-dd')<BR>在Delphi中写成：<BR>thedate='2000-01-01';<BR>query1.SQL.add('select * from abc where mydate&gt;cast('+''''+thedate+''''+' as date)'); <BR>如果比较日期时间型，则为：<BR>WHERE mydatetime&gt;to_date('2000-01-01 10:00:01','yyyy-mm-dd hh24:mi:ss')<BR><BR>Top<BR>回复人： qxm(qxm) ( ) 信誉：100 2003-4-15 15:09:04 得分:0<BR><BR>不错<BR><BR>Top<BR>回复人： dj0430() ( ) 信誉：100 2003-4-15 15:22:27 得分:0<BR><BR>表达式求值:<BR>&nbsp;&nbsp; 直接发送 Select（1+2)*3 <BR>&nbsp;&nbsp; 或者&nbsp;&nbsp;&nbsp;&nbsp; Select top 1 (1+2)*3 from TableName<BR>欢迎前去讨论“各种语言的表达式求值问题”<BR>http://expert.csdn.net/Expert/topic/1661/1661139.xml?temp=.6748773<BR><BR>Top<BR>回复人： sanzfm(珊珊来迟) ( ) 信誉：100 2003-4-15 15:28:52 得分:0<BR><BR>收藏收藏<BR><BR>Top<BR>回复人： baiyunfei(埋头苦学) ( ) 信誉：97 2003-4-15 17:03:36 得分:0<BR><BR>恩，埋头学习中！<BR><BR>Top<BR>回复人： weijiajia11() ( ) 信誉：97 2003-4-15 17:11:17 得分:0<BR><BR>太多了<BR><BR>Top<BR>回复人： imports(小鸡快跑!Q_Q) ( ) 信誉：99 2003-4-15 17:20:34 得分:0<BR><BR>不懂! <BR>Mark!<BR><BR>Top<BR>回复人： xboy(一剑如故) ( ) 信誉：100 2003-4-15 18:57:09 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： wlhtake(正在调试) ( ) 信誉：99 2003-4-15 21:40:19 得分:0<BR><BR>我考~！ 这些人贴sql又不说明适用数据库，容易搞晕的哈<BR>再说了，这些sql太常用了，何来精妙之言？<BR>最精妙的语句莫过于 SELECT * FROM&nbsp;&nbsp;<BR><BR>Top<BR>回复人： reddg(reddg) ( ) 信誉：100 2003-4-15 23:21:48 得分:0<BR><BR>浪费时间<BR><BR>Top<BR>回复人： Tomcat4(Tom) ( ) 信誉：105 2003-4-16 9:47:15 得分:0<BR><BR>up!<BR><BR>Top<BR>回复人： junyh(阿俊) ( ) 信誉：100 2003-4-16 10:03:03 得分:0<BR><BR>学习先<BR><BR>Top<BR>回复人： lizongqi(英雄啊) ( ) 信誉：100 2003-4-16 10:36:57 得分:0<BR><BR>收<BR><BR>Top<BR>回复人： Swanzy(志远) ( ) 信誉：100 2003-4-16 13:19:58 得分:0<BR><BR>常用的就不贴了吧？<BR>我绝对支持&nbsp;&nbsp;wlhtake(正在调试) ！<BR>“最精妙的语句莫过于 SELECT * FROM&nbsp;&nbsp;”！！！！<BR><BR>Top<BR>回复人： chenquan(嘉威王子) ( ) 信誉：100 2003-4-16 13:25:20 得分:5<BR><BR>我也来，以前给一个网友的贴<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt <BR>group by a,b,c) --c小计<BR>union<BR>(select a,'小计' b,'' c,sum(Mavg) Mavg,sum(Mcount) Mcount from<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt group by a,b,c) <BR>as chen<BR>group by a) --A小计<BR>union<BR>(select a,b,'小计' c,sum(Mavg) Mavg,sum(Mcount) Mcount from<BR>(select a,b,c,avg(s) as Mavg,count(s) Mcount from cq_tt group by a,b,c) <BR>as chen<BR>group by a,b) --B小计<BR><BR>Top<BR>回复人： kjijian(!魔法师) ( ) 信誉：100 2003-4-16 15:18:51 得分:0<BR><BR>mark.<BR><BR>Top<BR>回复人： tangyong_delphi() ( ) 信誉：99 2003-4-16 21:42:34 得分:0<BR><BR>经典收藏。<BR><BR>Top<BR>回复人： donglw(天行) ( ) 信誉：100 2003-4-17 1:28:45 得分:0<BR><BR>值得收藏!<BR><BR>Top<BR>回复人： williy(肩扛干粮找组织) ( ) 信誉：100 2003-4-17 9:07:31 得分:0<BR><BR>嗯！好！！！<BR><BR>Top<BR>回复人： brat365(我就是五亿探长--雷洛) ( ) 信誉：97 2003-4-17 10:21:09 得分:0<BR><BR>学习了不少，感谢大家做出的贡献<BR><BR>Top<BR>回复人： lilyfirstone(永恒......) ( ) 信誉：100 2003-4-17 10:45:29 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： pengdali(大力 V2.0) ( ) 信誉：100 2003-4-17 12:06:07 得分:0<BR><BR>哈哈。。太简单了！哈哈。。<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-4-17 12:34:25 得分:0<BR><BR>to&nbsp;&nbsp;pengdali(大力) <BR>怎么有空到这儿瞧..<BR>WEB这东东可是没什么好玩的耶.偶都要改行了<BR><BR>Top<BR>回复人： rena0504(丽娜) ( ) 信誉：100 2003-4-17 12:48:34 得分:0<BR><BR>select a,b,c <BR>from a <BR>where a IN <BR>&nbsp;&nbsp;&nbsp;&nbsp; (select d from b )<BR><BR>Top<BR>回复人： readersm68(地主) ( ) 信誉：100 2003-4-17 15:31:09 得分:0<BR><BR>结束。<BR><BR>Top<BR>回复人： hcgui(浪子) ( ) 信誉：100 2003-4-17 16:15:19 得分:0<BR><BR>good<BR><BR>Top<BR>回复人： javafish(小鱼儿) ( ) 信誉：101 2003-4-18 11:46:50 得分:0<BR><BR>mark<BR><BR>Top<BR>回复人： rengs(冷雨) ( ) 信誉：100 2003-4-18 13:58:18 得分:0<BR><BR>oracle:<BR>select 'sql的精妙不在于写的简短，而在于能使得查询效率提高' from dual<BR><BR>Top<BR>回复人： rengs(冷雨) ( ) 信誉：100 2003-4-18 14:27:44 得分:5<BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3745#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3746'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:19:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>回复人： LuoGD(沃适) ( ) 信誉：100&nbsp;&nbsp;2003-3-18 18:11:36&nbsp;&nbsp;得分:0 <BR>说明：子查询(表名1：a 表名2：b)<BR>select a,b,c from a where a IN (select d from b )<BR>这是一个可以优化的sql语句，给a表中的a和b表中的d使用索引，然后改为<BR>select a,b,c from a where exists (select * from b where b.d=a.a)<BR>总结说一点：<BR>1、要合理使用索引<BR>索引是数据库一个重要的构成部分，很多人都会忽略它，其实索引的根本目的就是<BR>为了提高查询效率。<BR>使用原则如下： <BR>在经常进行连接，但是没有指定为外键的列上建立索引，而不经常连接的字段则<BR>由优化器自动生成索引。 <BR>在频繁进行排序或分组（即进行group by或order by操作）的列上建立索引。 <BR>在条件表达式中经常用到的不同值较多的列上建立检索，在不同值少的列上不要<BR>建立索引。比如在雇员表的“性别”列上只有“男”与“女”两个不同值，因此就<BR>无必要建立索引。如果建立索引不但不会提高查询效率，反而会严重降低更新速度<BR>。 <BR>如果待排序的列有多个，可以在这些列上建立复合索引（compound index）。 <BR>在写sql语句时就必须注意有些写法是会使得数据库无法使用索引的，比如IS NULL<BR>IS NOT NULL，IN ，NOT IN 等。。。<BR>2．避免或简化排序 <BR>应当简化或避免对大型表进行重复的排序。当能够利用索引自动以适当的次序产生<BR>输出时，优化器就避免了排序的步骤。以下是一些影响因素： <BR>●索引中不包括一个或几个待排序的列； <BR>●group by或order by子句中列的次序与索引的次序不一样； <BR>●排序的列来自不同的表。 <BR>为了避免不必要的排序，就要正确地增建索引，合理地合并数据库表（尽管有时可<BR>能影响表的规范化，但相对于效率的提高是值得的）。如果排序不可避免，那么应<BR>当试图简化它，如缩小排序的列的范围等。 <BR>3．消除对大型表行数据的顺序存取 <BR>在嵌套查询中，对表的顺序存取对查询效率可能产生致命的影响。比如采用顺序存<BR>取策略，一个嵌套3层的查询，如果每层都查询1000行，那么这个查询就要查询10<BR>亿行数据。避免这种情况的主要方法就是对连接的列进行索引。例如，两个表：学<BR>生表（学号、姓名、年龄……）和选课表（学号、课程号、成绩）。如果两个表要<BR>做连接，就要在“学号”这个连接字段上建立索引。 <BR>还可以使用并集来避免顺序存取。尽管在所有的检查列上都有索引，但某些形式的<BR>where子句强迫优化器使用顺序存取。下面的查询将强迫对orders表执行顺序操作<BR>： <BR>SELECT ＊ FROM orders WHERE (customer_num=104 AND order_num&gt;1001) OR <BR>order_num=1008 <BR>虽然在customer_num和order_num上建有索引，但是在上面的语句中优化器还是使<BR>用顺序存取路径扫描整个表。因为这个语句要检索的是分离的行的集合，所以应该<BR>改为如下语句： <BR>SELECT ＊ FROM orders WHERE customer_num=104 AND order_num&gt;1001 <BR>UNION <BR>SELECT ＊ FROM orders WHERE order_num=1008 <BR>这样就能利用索引路径处理查询。 <BR>4．避免相关子查询 <BR>一个列的标签同时在主查询和where子句中的查询中出现，那么很可能当主查询中<BR>的列值改变之后，子查询必须重新查询一次。查询嵌套层次越多，效率越低，因此<BR>应当尽量避免子查询。如果子查询不可避免，那么要在子查询中过滤掉尽可能多的<BR>行。 <BR>5．避免困难的正规表达式 <BR>MATCHES和LIKE关键字支持通配符匹配，技术上叫正规表达式。但这种匹配特别耗<BR>费时间。例如：SELECT ＊ FROM customer WHERE zipcode LIKE “98_ _ _” <BR>即使在zipcode字段上建立了索引，在这种情况下也还是采用顺序扫描的方式。如<BR>果把语句改为SELECT ＊ FROM customer WHERE zipcode &gt;“98000”，在执行查询<BR>时就会利用索引来查询，显然会大大提高速度。 <BR>另外，还要避免非开始的子串。例如语句：SELECT ＊ FROM customer WHERE <BR>zipcode[2，3] &gt;“80”，在where子句中采用了非开始子串，因而这个语句也不会<BR>使用索引。 <BR>6．使用临时表加速查询 <BR>把表的一个子集进行排序并创建临时表，有时能加速查询。它有助于避免多重排序<BR>操作，而且在其他方面还能简化优化器的工作。例如： <BR>SELECT cust.name，rcvbles.balance，……other columns <BR>FROM cust，rcvbles <BR>WHERE cust.customer_id = rcvlbes.customer_id <BR>AND rcvblls.balance&gt;0 <BR>AND cust.postcode&gt;“98000” <BR>ORDER BY cust.name <BR>如果这个查询要被执行多次而不止一次，可以把所有未付款的客户找出来放在一个<BR>临时文件中，并按客户的名字进行排序： <BR>SELECT cust.name，rcvbles.balance，……other columns <BR>FROM cust，rcvbles <BR>WHERE cust.customer_id = rcvlbes.customer_id <BR>AND rcvblls.balance&gt;0 <BR>ORDER BY cust.name <BR>INTO TEMP cust_with_balance <BR>然后以下面的方式在临时表中查询： <BR>SELECT ＊ FROM cust_with_balance <BR>WHERE postcode&gt;“98000” <BR>临时表中的行要比主表中的行少，而且物理顺序就是所要求的顺序，减少了磁盘<BR>I/O，所以查询工作量可以得到大幅减少。 <BR>注意：临时表创建后不会反映主表的修改。在主表中数据频繁修改的情况下，注意<BR>不要丢失数据。 <BR>7．用排序来取代非顺序存取 <BR>非顺序磁盘存取是最慢的操作，表现在磁盘存取臂的来回移动。SQL语句隐藏了这<BR>一情况，使得我们在写应用程序时很容易写出要求存取大量非顺序页的查询。 <BR>有些时候，用数据库的排序能力来替代非顺序的存取能改进查询。 <BR>&nbsp;&nbsp;<BR><BR><BR>Top<BR>回复人： istrue(象) ( ) 信誉：100 2003-4-20 18:10:13 得分:0<BR><BR>create table 小孩 select 精子,卵子 from 男,女 where 男.生殖器=女.生殖器<BR><BR>Top<BR>回复人： runner001_cn(柳生007) ( ) 信誉：100 2003-4-20 22:47:37 得分:0<BR><BR>最近我做一个出版图书项目，我用的是access数据库。<BR>表cbs_public中有字段<BR>id,cbs_bcode,cbs_bname,cbs_bauthor,cbs_banci......<BR>cbs_bcode:一种书的唯一编号，我们称为社内编号。<BR>cbs_bname:书名<BR>cbs_buthor:作者<BR>cbs_banci:书的版次，这个字段是4位的字符。如0103,表示第一版第三次印刷<BR>&nbsp;&nbsp;&nbsp;&nbsp;这个库中有3000多记录，由于有的书多次再版或是重印，使得同一本书（cbs_bcode一样）的记录出现多次，但是cbs_banci不一样，现在我想把同一本书的最新版的最近印刷的那条记录选择出来，而将其他记录删除掉，我因该如何做？<BR>我尝试过在access2000的查询表中使用group by having 语句以及集函数max()，但好像不成功，我应该如何做呢？<BR>这个帖子有很多sql语言高手，希望有人能帮我解答，谢谢！<BR><BR>Top<BR>回复人： mee123456(臭球) ( ) 信誉：100 2003-4-22 14:05:15 得分:0<BR><BR>摘自某帖，供尚未知情者参考：<BR>SQL Server中实现limit功能，如选择stu(num,name) 中的第10到第20条记录：<BR>SELECT TOP 10 a.num, a.name<BR>FROM (SELECT TOP 20 *<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM stu<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY num DESC) a<BR>ORDER BY a.num<BR><BR>Top<BR>回复人： zhongjz(小海螺) ( ) 信誉：105 2003-4-22 19:31:47 得分:0<BR><BR>一个最简单的调试函数办法：<BR>再要在函数 ecoadd 中加入：<BR>DBMS_OUTPUT.PUT_LINE('v_canBeAdd is '||v_canBeAdd); --输出中间变量<BR>SQL&gt; set serverout on;<BR>SQL&gt; declare<BR>&nbsp;&nbsp;2&nbsp;&nbsp;a number;<BR>&nbsp;&nbsp;3&nbsp;&nbsp;begin<BR>&nbsp;&nbsp;4&nbsp;&nbsp;a:=ecoadd('21',to_date('2003-04-18','yyyy-mm-dd'));<BR>&nbsp;&nbsp;5&nbsp;&nbsp;end;<BR>&nbsp;&nbsp;6&nbsp;&nbsp;/<BR>v_canBeAdd is 1<BR>PL/SQL procedure successfully completed.<BR><BR>Top<BR>回复人： Tabasco(飞鸟) ( ) 信誉：100 2003-4-23 12:10:43 得分:0<BR><BR>不错不错<BR><BR>Top<BR>回复人： hnhhcj(亦凡) ( ) 信誉：100 2003-4-23 19:20:23 得分:0<BR><BR>好！我喜欢！<BR><BR>Top<BR>回复人： willway(编程是工作-足球是娱乐-学习是永恒！) ( ) 信誉：95 2003-4-24 16:03:40 得分:0<BR><BR>看到了大海，才知道以前一直在小水沟里游泳<BR><BR>Top<BR>回复人： tigerwen01(小虎)(编程艺术化) ( ) 信誉：485 2003-4-24 17:21:56 得分:0<BR><BR>我也来一句吧：<BR>Select field1,field2,(Case When ** then aa When *** then aaa Else bbb End)ResultVal From Tablename where 条件 order by id DESC<BR><BR>Top<BR>回复人： luckysym(热带风暴) ( ) 信誉：100 2003-4-25 13:57:26 得分:0<BR><BR>sign<BR><BR>Top<BR>回复人： findya(满地找牙) ( ) 信誉：100 2003-4-25 15:06:49 得分:0<BR><BR>to annkie(活着便精彩) ：<BR>select *, ((yjs_count + 0.00)/bys_count) as jy_ratio from<BR>(<BR>select kzx4dm, count(kzx4dm) as bys_count, <BR>&nbsp;&nbsp;sum(case jylsfsdm when 10 then 1 else 0 end) as yjs_count<BR>from Test<BR>group by kzx4dm <BR>) a<BR><BR>Top<BR>回复人： yoki(小马哥) ( ) 信誉：100 2003-4-26 15:22:16 得分:0<BR><BR>要学sql还是去mssql版吧<BR><BR>Top<BR>回复人： xiaoyuer0851(红旗下的蛋) ( ) 信誉：100 2003-4-26 20:48:04 得分:0<BR><BR>经典，谢谢了，各位<BR><BR>Top<BR>回复人： tboer(五峰) ( ) 信誉：96 2003-4-27 13:17:54 得分:0<BR><BR>收藏～<BR><BR>Top<BR>回复人： java2000(左天) ( ) 信誉：100 2003-4-28 12:45:18 得分:0<BR><BR>好东西，大家继续。。。。。。。。<BR>收藏....<BR><BR>Top<BR>回复人： jihejihe(几何) ( ) 信誉：100 2003-4-28 14:56:09 得分:0<BR><BR>强烈关注！！！<BR><BR>Top<BR>回复人： boy21cnthp(娃娃) ( ) 信誉：99 2003-5-1 1:55:00 得分:0<BR><BR>收藏<BR><BR>Top<BR>回复人： xiaoduan0115(小段) ( ) 信誉：100 2003-5-1 19:18:27 得分:0<BR><BR>学习中<BR><BR>Top<BR>回复人： lynn0821(林子) ( ) 信誉：100 2003-5-3 17:04:12 得分:0<BR><BR>看不懂啊！<BR>高手这么多！<BR><BR>Top<BR>回复人： dgm8(dgm8) ( ) 信誉：100 2003-5-3 22:22:08 得分:0<BR><BR>不知道写的人自己懂不懂,要贴的话,我也可以从教材上拷一大堆.<BR><BR>Top<BR>回复人： Redball(红刺猬) ( ) 信誉：100 2003-5-3 22:58:39 得分:0<BR><BR>drop index<BR><BR></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3746#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>回复:[分享]SQl语句学习专题<a name='3747'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:19:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD>Top<BR>回复人： ljz811(李建忠) ( ) 信誉：100 2003-5-5 0:23:56 得分:0<BR><BR>Microsoft SQL Server 2000的索引并没有太多变化，本来还以为会有R-Tree、Bitmap Index之类的东东出来呢，结果很让人失<BR>望：（<BR>不过还是有一些变化的，第三讲里面已经说过了可以给View加索引，还有一点就是可以给计算列（Computed Columns）加索引。<BR>？不知道什么是Computed Columns？我倒！<BR>其实这东东我也就用过一次，抄一段Online Book的Sample Code吧<BR>CREATE TABLE t2 (a int, b int, c int, x float, <BR>&nbsp;&nbsp;&nbsp;&nbsp;y as CASE x <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 0 THEN a <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN 1 THEN b <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE c <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END)<BR>CREATE TABLE mytable <BR>&nbsp;&nbsp; (<BR>&nbsp;&nbsp;&nbsp;&nbsp;low int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;high int,<BR>&nbsp;&nbsp;&nbsp;&nbsp;myavg AS (low + high)/2<BR>&nbsp;&nbsp; )<BR>看明白了吧，就是as后面加一个计算值而已，OK, continue<BR>现在虽然可以给计算列加索引了，但是还是受到一些限制的，比如说，象avg、sum这样的和整张表都有关的计算值就不可以加索<BR>引，还有，具有不确定计算值的也不可以加索引，表达式中使用的字段也必须是这张表中的。<BR>SQL 2000里面对索引作了一些优化，不过具体的细节不是很清楚，我所知道的就是在多CPU的机器上建立索引的时候可以使用平行<BR>多线程来扫描和分类数据。实现的技术细节没有太多的意思，简单介绍一下就是，服务器在建立索引之前对表做一个快速的随机扫<BR>描，把数据按照设置的平行度分为几块，然后每个线程利用过滤器对基表进行查询，分别建立索引结构，每个线程都完成之后再把<BR>这些索引连接起来。<BR>SQL 2000中很多地方对多CPU和Clustered Server做了优化，可惜现在的资料太少，不过使用一段时间就会慢慢发现的了。<BR><BR>Top<BR>回复人： ljz811(李建忠) ( ) 信誉：100 2003-5-5 0:26:11 得分:5<BR><BR>多重查询的解决方案<BR>注：本文来自<BR>http://www.printmarket.com.cn 朱继山 tozjs@263.net,否则视为侵权。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[前言]<BR>&nbsp;&nbsp;&nbsp;&nbsp;我们经常会遇到多重查询问题，而长长的SQL语句往往让人丈二和尚摸不着头脑。特别是客户端部分填入查询条件时，如用普通方法将更是难上加难。<BR>&nbsp;&nbsp;&nbsp;&nbsp;以下巧妙地利用"where 1=1"的恒等式（事实上很多，让它值为TRUE即可）解决此问题。<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [正文概要]<BR>'subject 信息标题<BR>'company 发布信息的公司名称<BR>'content 发布信息的内容<BR>'address 公司地址<BR>'infomation 公司简介<BR>'note 相关说明<BR>以上值均由FORM提交，然后通过:subject=trim(Request.Form("subject"))等得到相应的值。<BR>&lt;%<BR>'这个函数很关键！---------------------------<BR>Function sql(a,b,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;if b&lt;&gt;"" then&nbsp;&nbsp; '如果客户端没有提交此值，则不会产生相应的SQL语句。<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sqls &amp; " and " &amp; a &amp; " like '%" &amp; b &amp; "%'"<BR>&nbsp;&nbsp;&nbsp;&nbsp;end if<BR>&nbsp;&nbsp;&nbsp;&nbsp;sql=sqls<BR>End Function<BR>'-----------------调用数据库<BR>&nbsp;&nbsp;&nbsp;&nbsp;Set conn=Server.CreateObject("ADODB.Connection")<BR>&nbsp;&nbsp;&nbsp;&nbsp;DBpath=Server.MapPath("/database/mydb.mdb")<BR>&nbsp;&nbsp;&nbsp;&nbsp;Conn.Open "driver={Microsoft Access Driver (*.mdb)};pwd=;dbq=" &amp; DBpath<BR>&nbsp;&nbsp;&nbsp;&nbsp;Set rs=Server.CreateObject("ADODB.Recordset")<BR>sqls="select * from mytable&nbsp;&nbsp;where 1=1 "<BR>'以下调用上面的函数即可,可以很多个调用（理论上是任意）<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("subject",subject,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("company",company,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("content",content,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("address",address,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("infomation",infomation,sqls)<BR>&nbsp;&nbsp;&nbsp;&nbsp;sqls=sql("note",note,sqls)<BR>sqls=sqls &amp; " order by id desc"<BR>&nbsp;&nbsp;&nbsp;&nbsp;rs.open sqls,conn,3,2<BR>%&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[结束语]<BR>&nbsp;&nbsp;&nbsp;&nbsp;如果没有关键的函数Function sql(a,b,sqls)，我们可以想象，需要多少判断的一个接一个的语句！<BR><BR>Top<BR>回复人： tigerwen01(小虎)(编程艺术化) ( ) 信誉：485 2003-5-7 8:46:11 得分:0<BR><BR>Case语句：<BR>SELECT FIELD1,FIELD2,(CASE WHEN 某某 THEN 某某 WHEN 某某 THEN 某某 ELSE 某某 END)NEWFIELD FROM TABLENAME ORDER BY FIELD<BR><BR>Top<BR>回复人： hakin(边城之风) ( ) 信誉：101 2003-5-8 21:34:51 得分:0<BR><BR>占个位。。。。<BR><BR>Top<BR>回复人： playboy200(林) ( ) 信誉：100 2003-5-9 10:56:39 得分:0<BR><BR>VBSCRIPT常见的内部函数<BR>函数 功能简述 <BR>ABS(number) 返回数字的绝对值 <BR>Array(arglist) 返回数组实例 <BR>Asc(string) 返回ANSI字符字符串 <BR>Atn(number) 返回Arctangernt值 <BR>CBool(expression) 返回Boolean类型的值 <BR>CByte(expression) 返回Byte类型的值 <BR>CCur(expression) 返回Currency类型的值 <BR>&nbsp;&nbsp;&nbsp;&nbsp; CDate(date) 返回Date类型的值 <BR>CDbl(expression) 返回Double类型的值 <BR>Chr(charcode) 返回ANSI字符码 <BR>&nbsp;&nbsp;&nbsp;&nbsp;CInt(expression) 返回Integer类型值 <BR>CLng(expression) 返回Long类型值 <BR>Cos(nubmer) 返回一个弧度数字的Cosine值 <BR>CreateObject(class) 返回一个对象实例 <BR>CSng(expression) 返回Single类型的值 <BR>&nbsp;&nbsp;&nbsp;&nbsp;CStr(expression) 返回string类型的值 <BR>Date 返回目前的系统时间 <BR>DateAdd(interval,number,date) 返回更改的时间 <BR>DateDiff(interval,date1,date2) 返回两日期的间隔 <BR>DatePart(interval,date) 返回给定时间的某个部分值 <BR>DateSerial(year,month,day) 转换给定时间Date类型 <BR>DateValue(date) 返回date类型的值 <BR>Day(date) 返回1-31的日期数字 <BR>Exp(number) 返回自然指数的次方数 <BR>Int(nubmber) 返回数字的绝对整数（无条件进位） <BR>Fix(number) 返回数字的整数（无条件舍去） <BR>Filter(Inputstrings,value) 返回一维数组内字符串位置 <BR>FormatCurrency(expression) 返回表达式类型 <BR>&nbsp;&nbsp; FormatDateTime(date) 返回日期或时间的表达式 <BR>&nbsp;&nbsp;FormatNumber(expression) 返回数字的表达式 <BR>FormatParcent(expression) 返回百分比的表达式 <BR>GetObject([pathname][,class]) 去回文件内的对象 <BR>Hex(number) 返回数字的16进位 <BR>Hour(time) 返回时间的小时数 <BR>InputBox(prompt,...) 显示一个可供输入的对话框 <BR>Instr(string,searchstr) 返回搜寻字符串的第一个位置 <BR>InstrRev(string,searchstr) 从尾端搜寻字符串的位置 <BR>IsArray(varname) 判定是变量还是数组 <BR>IsDate(expression) 判定是否是日期表达式 <BR>IsEmpty(expression) 判定变量内是否有值 <BR>IsNull(expression) 判定是否为NULL值 <BR>IsNumeric(expression) 判定是否为数字值 <BR>LoadPicture(picturename) 返回一个图象对象 <BR>IsObject(expression) 判定是否为一个变量 <BR>Join(list[,delimiter]) 加入一数组内的子字符串 <BR>LBound(arrayname) 返回数组的最小索引 <BR>LCase(string) 返回小写字符串 <BR>Left(string,ength) 返回需要长度的字符串 <BR>Len(string|varname) 返回字符场长度 <BR>Log(number) 返回自然对数 <BR>LTrim(string) 去除字符串的开头空白字符 <BR>RTrim(string) 去除字符串的尾端空白字符 <BR>Trim(string) 去除字符串的开头、尾端空白字符 <BR>Mid(string,start[,length]) 返回指定位置的字符串 <BR>Minute(time) 返回时间的分数 <BR>Month(date) 返回日期的月份 <BR>MonthName(month[,abbreviate]) 返回月份字符串 <BR>MsgBox(prompt,...) 显示一个信息框 <BR>Now 返回系统的日期与时间 <BR>Oct(number) 返回数字的八进制 <BR>Replace(string,find,replacewith) 取代部分字符串 <BR>Right(string,ength) 从尾端返回需要长度的字符串 <BR>Rnd[(number)] 返回一个随机数 <BR>Split(expression,...) 返回指定字符串的一维数组 <BR>ScriptEngineBuildVersion 返回现在使用的Script语言的版本 <BR>ScriptEngineMajorVersion 返回现在使用的Script语言的主要版本 <BR>ScriptEngineMinorVersion 返回现在使用的Script语言的次要版本 <BR>Round(expression[,num])&nbsp;&nbsp;Returns a number rounded <BR>ScriptEngine 返回现在使用的Script语言 <BR>Second(time) 返回时间秒数 <BR>Sgn(number) 判断数字的正负号 <BR>Sin(number) 返回弧度数字的Sin值 <BR>Space(number) 返回指定的空白字符字符串 <BR>Sqr(number) 返回数字的二次方根 <BR>StrComp(string1,string2[,compare]) 比较两个字符串 <BR>StrReverse(string) 反过来排列字符串 <BR>String(number,character) 返回一重复字符串 <BR>Tan(number) 返回弧度数字的Tangent值 <BR>这个一定精典吧<BR>Time 返回目前的系统时间 <BR>TimeSerial(hour,minute,second) 返回时间date类型 <BR>TimeValje(time) 繁华包含时间的date类型 <BR>TypeName(varname) 返回变量的数据类型 <BR>UBound(arrayname) 从尾端返回数组的最小索引 <BR>UCase(string) 返回大写字符 <BR>VarType(varname) 发行代表变量数据类型的数字 <BR>Weekday(date,[firstdayofweek]) 返回日期是礼拜几 <BR>Year(date) 返回日期内的年数 <BR><BR>Top<BR>回复人： playboy200(林) ( ) 信誉：100 2003-5-9 10:58:39 得分:0<BR><BR>防止重复提交的巧妙方法[<BR>在document.form1.submit();后加<BR>document.body.innerHtml = "&lt;center&gt; Waiting...&lt;/center&gt;"; //当然这里的html代码就由你发挥了，还可把这段写成函数，这样维护就方便了！<BR>这一处理，就让用户在等待提交时不会误以为没提交而重复按提交按钮！<BR><BR>Top<BR>回复人： bondlei(洗前尘-快平生) ( ) 信誉：101 2003-5-9 21:29:16 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： wgrabob1(红客男孩) ( ) 信誉：115 2003-5-10 12:39:46 得分:0<BR><BR>select * form *<BR><BR>Top<BR>回复人： nboys() ( ) 信誉：105 2003-5-10 13:49:15 得分:0<BR><BR>选择从10到15的记录<BR>select top 5 * from (select top 15 * from table order by id asc) table_别名 order by id desc<BR>or <BR>selecct top 5 * from table where id not in (select top 10 id from table order by id asc) order by id asc<BR><BR>Top<BR>回复人： pyyxs(大力神) ( ) 信誉：100 2003-5-10 13:56:57 得分:0<BR><BR>gz<BR><BR>Top<BR>回复人： pyyxs(大力神) ( ) 信誉：100 2003-5-10 14:09:10 得分:0<BR><BR>to&nbsp;&nbsp;pengdali(大力)<BR>来个复杂的瞧瞧<BR><BR>Top<BR>回复人： vigorlee3(青蛙呆) ( ) 信誉：100 2003-5-10 22:30:39 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： qinchao08(三人行) ( ) 信誉：100 2003-5-14 10:39:07 得分:0<BR><BR>晕<BR><BR>Top<BR>回复人： CHARGING(粽子) ( ) 信誉：105 2003-5-15 14:50:28 得分:0<BR><BR>请教：<BR>一个表有三个字段：ID（自动）、COL1、COL2。COL1值不限，COL2的值有‘0’、‘1’、‘2’三种，假如表中有以下几条数据：<BR>ID&nbsp;&nbsp;&nbsp;&nbsp;COL1&nbsp;&nbsp;&nbsp;&nbsp;COL2<BR>1&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0<BR>2&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1<BR>3&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1<BR>4&nbsp;&nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2<BR>5&nbsp;&nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2<BR>如何检索出以下的数据？（TEMP1为COL2中出现“0”的次数，TEMP2为出现“1”的次数，TEMP3为出现“2”的次数，TEMP4为COL1中不重复值出现的总次数）<BR>COL1&nbsp;&nbsp;&nbsp;&nbsp;TEMP1&nbsp;&nbsp;&nbsp;&nbsp;TEMP2&nbsp;&nbsp;&nbsp;&nbsp;TEMP3&nbsp;&nbsp;&nbsp;&nbsp; TEMP4<BR>A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3<BR>B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2<BR><BR>Top<BR>回复人： yonghengdizhen(刹那←→永恒) ( ) 信誉：112 2003-5-15 16:17:20 得分:0<BR><BR>几个子查询而已。当需统计离散值数量不确定时，无法由一个sql完成，建议采用sql+XML方式完成<BR><BR>Top<BR>回复人： surfl(晓龙) ( ) 信誉：100 2003-5-16 16:51:45 得分:0<BR><BR>mark!<BR><BR>Top<BR>回复人： chichuli_4(clf) ( ) 信誉：110 2003-5-16 17:03:29 得分:0<BR><BR>INSERT INTO [tablea]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(field1,field2,....)<BR>SELECT field1,field2,....<BR>FROM tableb<BR><BR>Top<BR>回复人： boy21cnthp(娃娃) ( ) 信誉：99 2003-5-18 4:49:30 得分:0<BR><BR>up<BR><BR>Top<BR>回复人： mengxianbao1521(代码优化) ( ) 信誉：100 2003-5-21 13:21:26 得分:5<BR><BR>我的仔细看看各位的回帖，学习学习，本人也很喜欢SQL语句。<BR>希望与各位高手朋友长探讨。<BR>尤其敬仰yonghengdizhen(回首梦已远)功底深厚。<BR>.联系方式：MSN:mengxianbao1521#@sian.com<BR>nn <BR>问题：如何使用SQL语句比较两个相似表，那些字段相同（包括长度，类型）。<BR>select A.name as col, C.name as type, A.length <BR>from<BR>syscolumns A left join sysobjects B <BR>on A.id = B.id <BR>left join systypes C<BR>on A.xtype = C.xtype<BR>where B.name = 'T_Bookings' or B.name = 'T_Reca'<BR>group by A.name<BR>, C.name, A.length<BR>having count(A.name) &gt; 1<BR>SELECT * FROM SYSOBJECTS<BR>SELECT * FROM SYSCOLUMNS<BR>SELECT * FROM SYSTYPES<BR><BR>Top<BR>回复人： mengxianbao1521(代码优化) ( ) 信誉：100 2003-5-21 13:58:12 得分:0<BR><BR>怎么联系方式写错了。<BR>MSN:mengxianbao1521@sina.com<BR><BR>Top<BR>回复人： Eddie(元直) ( ) 信誉：100 2003-5-21 14:02:07 得分:0<BR><BR>Mark<BR><BR>Top<BR>回复人： lindexter(Dexter) ( ) 信誉：101 2003-5-21 14:33:42 得分:0<BR><BR>好帖，收藏。<BR>以后又有很多东西可以用了。<BR><BR>Top<BR>回复人： readersm68(地主) ( ) 信誉：100 2003-5-26 11:13:05 得分:0<BR><BR>SELECT distinct SUBSTRING(编号, 1, 3)<BR>FROM Table1<BR>ORDER BY 编号<BR><BR>Top<BR>回复人： afeisky(新手,努力学习C) ( ) 信誉：100 2003-6-10 10:38:03 得分:0<BR><BR>good </TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3747#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><TABLE style="TABLE-LAYOUT: fixed; WORD-BREAK: break-all" cellSpacing=1 cellPadding=3 width="98%" bgColor=#cccccc border=0>
<TBODY>
<TR bgColor=#f8f8f8>
<TD><FONT size=4><STRONG>收缩数据库方法<a name='3748'></a></STRONG></FONT><BR>晴天发表评论于2004-10-26 11:20:00 </TD></TR>
<TR bgColor=#ffffff>
<TD height=0>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
<TBODY>
<TR>
<TD><P>收缩数据库方法</P>
<P>backup log NewMizone2004 with no_log<BR>go<BR><BR>backup log NewMizone2004 with truncate_only<BR>go<BR><BR>backup log NewMizone2004 with no_log<BR>go<BR><BR>dbcc shrinkdatabase(NewMizone2004, TRUNCATEONLY)<BR>go</P>
<P>最多能缩到最开始建库时大小。</P></TD></TR></TBODY></TABLE><BR>
<TABLE cellSpacing=0 cellPadding=0 width="100%" align=center border=0>
<TBODY>
<TR>
<TD width="74%">个人主页 | <a href=more.asp?name=晴天&id=109&commentid=3748#comment>引用</a> | <a href='#top'>返回</a></TD>
<TD width="26%">
<DIV align=right>&nbsp;</DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR><BR><div align=right> <font face=webdings color='red'>9</font> <b> <font color='red'>1</font>  <a href='more.asp?name=晴天&id=109&page=2'>2</a> </b> <a href='more.asp?name=晴天&id=109&page=2' title=尾页><font face=webdings>:</font></a> </div><br><a name='comment'></a><table width='90%' border='0' align='center' cellspacing='0' cellpadding='0'> <tr> <td><strong>发表评论：</strong></tr></td></table>
<table width='90%' border='0' align='center' cellspacing='0' cellpadding='0'> <tr> <td><table align='left' width='100%' border='0' cellspacing='0' cellpadding='0'>
<form action='more.asp?name=晴天&id=109&action=addcomment' method='post' name='commentform' onSubmit='return Verifycomment()'>
<tr><td height='25'  align='left'>昵称：<input name='UserName' type='text' id='UserName' size='15' maxlength='20' value=''></td></tr>
<tr><td height='25' align='left'>密码：<input name='Password' type='password' id='Password' size='15' maxlength='20' value=''> (游客无须输入密码)</td></tr>
<tr ><td height='25' align='left'  >主页：<input name='homepage' type='text' id='homepage' size='42' maxlength='50' value='http://'><td></tr><tr ><td height='25' align='left'  >标题：<input name='commenttopic' type='text' id='commenttopic' size='42' maxlength='50' value='回复:[分享]SQl语句学习专题'><td></tr><tr height='200'><td ><INPUT type='hidden' name='edit' id='edit' value=''>
<link rel="STYLESHEET" type="text/css" href="images/edit.css">
<Script Src="images/DhtmlEdit.js"></Script>
<table id="oblog_Container" class="oblog_Body" height=100% width=350 cellpadding=1 cellspacing=0 border=0 >
  <tr> 
    <td  height="10"> <table cellpadding=0 cellspacing=0 >
        <tr class="yToolbar" ID="ExtToolbar0" > 
          <td> <select language="javascript" class="oblog_TBGen" id="FontSize" onchange="FormatText('fontsize',this[this.selectedIndex].value);">
              <option class="heading" selected>字号 
              <option value="1">1 
              <option value="2">2 
              <option value="3">3 
              <option value="4">4 
              <option value="5">5 
              <option value="6">6 
              <option value="7">7</option>
            </select> 
          <td class="oblog_Btn" TITLE="加粗" LANGUAGE="javascript" onclick="FormatText('bold', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/bold.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="斜体" LANGUAGE="javascript" onclick="FormatText('italic', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/italic.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="下划线" LANGUAGE="javascript" onclick="FormatText('underline', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/underline.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="取消格式" LANGUAGE="javascript" onclick="FormatText('RemoveFormat', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/removeformat.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="左对齐" NAME="Justify" LANGUAGE="javascript" onclick="FormatText('justifyleft', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/aleft.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="居中" NAME="Justify" LANGUAGE="javascript" onclick="FormatText('justifycenter', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/center.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="右对齐" NAME="Justify" LANGUAGE="javascript" onclick="FormatText('justifyright', '');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/aright.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="插入表情" LANGUAGE="javascript" onclick="oblog_foremot()" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/smiley.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td id="forecolor" name=forecolor class="oblog_Btn" TITLE="字体颜色" LANGUAGE="javascript" onclick="oblog_foreColor();" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/fgcolor.gif" WIDTH="16" HEIGHT="16" unselectable="on" > </td>
          <td id="backcolor" class="oblog_Btn" TITLE="字体背景颜色" LANGUAGE="javascript" onclick="oblog_backColor();ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn';> 
            <img class="oblog_Ico" src="images/fbcolor.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="插入超级链接" LANGUAGE="javascript" onclick="oblog_forlink();ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/wlink.gif" WIDTH="18" HEIGHT="18" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="去掉超级链接" LANGUAGE="javascript" onclick="FormatText('Unlink');ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn'; > 
            <img class="oblog_Ico" src="images/unlink.gif" WIDTH="16" HEIGHT="16" unselectable="on"> </td>
          <td class="oblog_Btn" TITLE="清理代码" LANGUAGE="javascript" onclick="oblog_CleanCode();ondrag='return false;'" onmouseover=this.className='oblog_BtnMouseOverUp'; onmouseout=this.className='oblog_Btn';> 
            <img class="oblog_Ico" src="images/cleancode.gif" WIDTH="16" HEIGHT="16"></td>
        </tr>
      </table></tr>
  <tr> 
    <td height="100%" id=PostiFrame> <iframe class="oblog_Composition" ID="oblog_Composition" MARGINHEIGHT="5" MARGINWIDTH="5" width="100%" height="100%"></iframe> </td>
     </tr>
  <tr >
    <td height="20"><TABLE CELLPADDING=0 CELLSPACING=0 BORDER=0 width='100%'>
        <TR> 
          <TD><div align="right"><a href="javascript:oblog_Size(-100)"><img src="images/minus.gif" unselectable="on" border='0' height="20"></a> <a href="javascript:oblog_Size(100)"><img src="images/plus.gif" unselectable="on" border='0' height="20"></a></div></TD>
          <TD width='20'></TD>
        </TR>
      </TABLE></td>
  </tr>
</table>
<Script>
var oblog_bIsIE5=document.all;
var canusehtml='1';
var PostType=1;

if (oblog_bIsIE5){
	var IframeID=frames["oblog_Composition"];
}
else{
	var IframeID=document.getElementById("oblog_Composition").contentWindow;
	var oblog_bIsNC=true;
}

if (oblog_bLoad==false)
{
	oblog_InitDocument("Body","GB2312");
}
function submits(){
document.all("edit").value=IframeID.document.body.innerHTML;
}
function initx(){
IframeID.document.body.innerHTML=quote
}
initx();
</Script>
<Script Src="images/editor.js"></Script>
</td></tr>
<tr><td height='30' ><input name='login' type='submit' id='Login' value=' 提交 '> 
</td>
</tr></form></table></td></tr></table>
<BR></TD></TR></TBODY></TABLE><BR><BR><center><A href='index.asp'>BLOG首页</A>&nbsp;|&nbsp;<A href='list.asp'>分类阅读</A> | <A href='listblogger.asp'>博客列表</A>&nbsp;|&nbsp;<A href='http://down.ok4545.com/xz.asp?dimg=%C3%E2%B7%D1%CA%D6%BB%FA%D3%CE%CF%B7' target=_blank>手机游戏</A>&nbsp;|&nbsp;<A href='http://www.ok4545.com/imagelist.asp' target=_blank>彩图下载</A>&nbsp;|&nbsp;<A href='http://www.ok4545.com/readweb/url.htm' target=_blank>网址大全</A>&nbsp;|&nbsp;<A href='http://www.ok4545.com/readweb/' title='网络书签' target=_blank>拇指网摘</A>&nbsp;|&nbsp;<A href='http://www.ok4545.com/club/' target=_blank>拇指论坛</A>&nbsp;|&nbsp;<A href='http://www.ok4545.com/' target=_blank>网站首页</A><br><script language=javascript src=http://www.tanyour.com/showMYad.asp?id=283&i=13></script><br><span style='color: #444444; font-size: 11px; font-family: Tahoma, Arial'><!-- 交友,健康,book,电子书,mp3,MM,美女,图库,拇指,挑战拇指,动网,动网论坛,饮料,营养,破解,注册,共享,asp,bbs,论坛,软件,下载,插件,经济,政治,社会,军事,法律,历史,哲学,宗教,文学,财经,时事,评论,新闻,聊天,论坛,思维,图书下载,社会科学 --><span style='color: #444444; font-size: 11px; font-family: Tahoma, Arial'>
Powered by <a href='http://www.oioj.net' style='color: #444444' target='_blank'><b>oBlog </b> <b style='color:#CC3300'>2.52 </b></a> 
&copy; Copyright 2004. All rights reserved. <br>Page refreshed 4149867 times.</center>
</body>
</html>


<SCRIPT language="javascript">

function del_space(s)
{
	for(i=0;i<s.length;++i)
	{
	 if(s.charAt(i)!=" ")
		break;
	}

	for(j=s.length-1;j>=0;--j)
	{
	 if(s.charAt(j)!=" ")
		break;
	}

	return s.substring(i,++j);
}

function Verifycomment()
{
	//submits(); 
	v = del_space(document.commentform.commenttopic.value);
     if (v.length == 0)
     {
        alert("您忘了填写题目!");
	return false;
     }
	 
	 v = del_space(document.commentform.UserName.value);
     if (v.length == 0)
     {
        alert("您忘了留下名字!");
	return false;
     }
	submits(); 
	if (document.commentform.edit.value == "")
     {
        alert("内容不能为空!");
	return false;
     }
	
	return true;
}

</SCRIPT>
